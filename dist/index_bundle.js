!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.$=t():e.$=t()}(self,(function(){return(()=>{var e={693:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Drums:()=>a,Guitar:()=>i,GuitarNote:()=>N,Metronome:()=>Aa,Midi:()=>r,MidiInputManager:()=>Ai,Note:()=>C,NoteArray:()=>oa,Piano:()=>o,Player:()=>Qa,Recording:()=>pa,StringedFingering:()=>u,Utils:()=>s,preprocessMidiFileData:()=>si,preprocessMusicXmlData:()=>fi,recordAudio:()=>pi,recordMidi:()=>gi});var r={};n.r(r),n.d(r,{MIDI_NOTE_RANGES:()=>x,NOTE_NAMES:()=>S,SHARPS:()=>_,commands:()=>P,getMidiDrumNoteByNr:()=>y,getMidiInstrumentByNr:()=>g,getMidiInstrumentByNrL2:()=>d,getMidiNoteByLabel:()=>m,getMidiNoteByNameAndOctave:()=>p,getMidiNoteByNr:()=>b,getNoteNameFromNoteNr:()=>w,isSharp:()=>v});var a={};n.r(a),n.d(a,{drumPitchReplacementMapMPS850:()=>Ti,generateDrumVariation:()=>xi,getPitch2PositionMap:()=>Ni,simplifyDrumPitches:()=>Ci});var i={};n.r(i),n.d(i,{fingeringFromFretboardPositions:()=>ji,fretboardPositionsFromMidi:()=>Ri,fretboardPosititionsFromMidiChannel:()=>Wi,generateExampleData:()=>$i,getFretboardPositionsFromNoteName:()=>Hi,getFretboardPositionsFromPitch:()=>Ii,getNoteInfoFromFretboardPos:()=>Oi,getPitchFromFretboardPos:()=>Li,getTuningFromPitches:()=>Gi,getTuningPitchRange:()=>qi,guitarNoteFromNote:()=>Di,stringColors:()=>Fi,stringedTunings:()=>ki});var o={};n.r(o),n.d(o,{fingeringFromMidi:()=>zi,pianoPitchRange:()=>Vi});var u={};n.r(u),n.d(u,{getHandPoseForChord:()=>Yi,getOptimalHandPoseSequence:()=>Ji});var s={};n.r(s),n.d(s,{alignNotesToBpm:()=>wo,arrayContainsArray:()=>la,arrayShallowEquals:()=>ua,averageRecordings:()=>po,averageRecordings2:()=>go,bpmToSecondsPerBeat:()=>Za,choose:()=>Zr,clipRecordingsPitchesToGtRange:()=>bo,clipValue:()=>ea,confidenceInterval:()=>uo,deepCloneFlatObjectMap:()=>ei,differenceMap:()=>yo,differenceMapErrorAreas:()=>vo,filterRecordingNoise:()=>fo,findLocalMaxima:()=>na,findNearest:()=>ui,flattenArray:()=>ca,formatDate:()=>Qi,formatSongTitle:()=>Zi,formatTime:()=>Ki,getBoxplotCharacteristics:()=>so,getMatrixMax:()=>ha,getObjectFromLocalStorage:()=>to,groupNotesByPitch:()=>ti,keepOnlyHighestConcurrentNotes:()=>ni,kernelDensityEstimator:()=>lo,kernelEpanechnikov:()=>co,kernelGauss:()=>ho,noteArrayToPitchSequence:()=>ri,noteArrayToString:()=>ai,noteColorFromPitch:()=>oo,pingMidiDevice:()=>So,pitchSequenceToInvervals:()=>oi,printMatrix:()=>fa,randFloat:()=>Qr,recordingsHeatmap:()=>mo,removeDuplicates:()=>sa,reverseString:()=>ii,storeObjectInLocalStorage:()=>eo,swapSoSmallerFirst:()=>ta});const l=new Map,c=new Map,h=new Map,f=new Map;function b(e){return l.get(e)}function m(e){return c.get(e)}function p(e,t){return c.get(`${e}${t}`)}function g(e){return h.get(e)}function d(e,t){const n=`${e}-${t}`;return f.get(n)}function y(e){return T.get(e)}function v(e){return _.has(e)}function w(e){return S[e%12]}const S=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],M=[{pitch:0,name:"C",octave:-1,label:"C-1",frequency:8.176},{pitch:1,name:"C#",octave:-1,label:"C#-1",frequency:8.662},{pitch:2,name:"D",octave:-1,label:"D-1",frequency:9.177},{pitch:3,name:"D#",octave:-1,label:"D#-1",frequency:9.723},{pitch:4,name:"E",octave:-1,label:"E-1",frequency:10.301},{pitch:5,name:"F",octave:-1,label:"F-1",frequency:10.913},{pitch:6,name:"F#",octave:-1,label:"F#-1",frequency:11.562},{pitch:7,name:"G",octave:-1,label:"G-1",frequency:12.25},{pitch:8,name:"G#",octave:-1,label:"G#-1",frequency:12.978},{pitch:9,name:"A",octave:-1,label:"A-1",frequency:13.75},{pitch:10,name:"A#",octave:-1,label:"A#-1",frequency:14.568},{pitch:11,name:"B",octave:-1,label:"B-1",frequency:15.434},{pitch:12,name:"C",octave:0,label:"C0",frequency:16.352},{pitch:13,name:"C#",octave:0,label:"C#0",frequency:17.324},{pitch:14,name:"D",octave:0,label:"D0",frequency:18.354},{pitch:15,name:"D#",octave:0,label:"D#0",frequency:19.445},{pitch:16,name:"E",octave:0,label:"E0",frequency:20.602},{pitch:17,name:"F",octave:0,label:"F0",frequency:21.827},{pitch:18,name:"F#",octave:0,label:"F#0",frequency:23.125},{pitch:19,name:"G",octave:0,label:"G0",frequency:24.5},{pitch:20,name:"G#",octave:0,label:"G#0",frequency:25.957},{pitch:21,name:"A",octave:0,label:"A0",frequency:27.5},{pitch:22,name:"A#",octave:0,label:"A#0",frequency:29.135},{pitch:23,name:"B",octave:0,label:"B0",frequency:30.868},{pitch:24,name:"C",octave:1,label:"C1",frequency:32.703},{pitch:25,name:"C#",octave:1,label:"C#1",frequency:34.648},{pitch:26,name:"D",octave:1,label:"D1",frequency:36.708},{pitch:27,name:"D#",octave:1,label:"D#1",frequency:38.891},{pitch:28,name:"E",octave:1,label:"E1",frequency:41.203},{pitch:29,name:"F",octave:1,label:"F1",frequency:43.654},{pitch:30,name:"F#",octave:1,label:"F#1",frequency:46.249},{pitch:31,name:"G",octave:1,label:"G1",frequency:48.999},{pitch:32,name:"G#",octave:1,label:"G#1",frequency:51.913},{pitch:33,name:"A",octave:1,label:"A1",frequency:55},{pitch:34,name:"A#",octave:1,label:"A#1",frequency:58.27},{pitch:35,name:"B",octave:1,label:"B1",frequency:61.735},{pitch:36,name:"C",octave:2,label:"C2",frequency:65.406},{pitch:37,name:"C#",octave:2,label:"C#2",frequency:69.296},{pitch:38,name:"D",octave:2,label:"D2",frequency:73.416},{pitch:39,name:"D#",octave:2,label:"D#2",frequency:77.782},{pitch:40,name:"E",octave:2,label:"E2",frequency:82.407},{pitch:41,name:"F",octave:2,label:"F2",frequency:87.307},{pitch:42,name:"F#",octave:2,label:"F#2",frequency:92.499},{pitch:43,name:"G",octave:2,label:"G2",frequency:97.999},{pitch:44,name:"G#",octave:2,label:"G#2",frequency:103.826},{pitch:45,name:"A",octave:2,label:"A2",frequency:110},{pitch:46,name:"A#",octave:2,label:"A#2",frequency:116.541},{pitch:47,name:"B",octave:2,label:"B2",frequency:123.471},{pitch:48,name:"C",octave:3,label:"C3",frequency:130.813},{pitch:49,name:"C#",octave:3,label:"C#3",frequency:138.591},{pitch:50,name:"D",octave:3,label:"D3",frequency:146.832},{pitch:51,name:"D#",octave:3,label:"D#3",frequency:155.563},{pitch:52,name:"E",octave:3,label:"E3",frequency:164.814},{pitch:53,name:"F",octave:3,label:"F3",frequency:174.614},{pitch:54,name:"F#",octave:3,label:"F#3",frequency:184.997},{pitch:55,name:"G",octave:3,label:"G3",frequency:195.998},{pitch:56,name:"G#",octave:3,label:"G#3",frequency:207.652},{pitch:57,name:"A",octave:3,label:"A3",frequency:220},{pitch:58,name:"A#",octave:3,label:"A#3",frequency:233.082},{pitch:59,name:"B",octave:3,label:"B3",frequency:246.942},{pitch:60,name:"C",octave:4,label:"C4",frequency:261.626},{pitch:61,name:"C#",octave:4,label:"C#4",frequency:277.183},{pitch:62,name:"D",octave:4,label:"D4",frequency:293.665},{pitch:63,name:"D#",octave:4,label:"D#4",frequency:311.127},{pitch:64,name:"E",octave:4,label:"E4",frequency:329.628},{pitch:65,name:"F",octave:4,label:"F4",frequency:349.228},{pitch:66,name:"F#",octave:4,label:"F#4",frequency:369.994},{pitch:67,name:"G",octave:4,label:"G4",frequency:391.995},{pitch:68,name:"G#",octave:4,label:"G#4",frequency:415.305},{pitch:69,name:"A",octave:4,label:"A4",frequency:440},{pitch:70,name:"A#",octave:4,label:"A#4",frequency:466.164},{pitch:71,name:"B",octave:4,label:"B4",frequency:493.883},{pitch:72,name:"C",octave:5,label:"C5",frequency:523.251},{pitch:73,name:"C#",octave:5,label:"C#5",frequency:554.365},{pitch:74,name:"D",octave:5,label:"D5",frequency:587.33},{pitch:75,name:"D#",octave:5,label:"D#5",frequency:622.254},{pitch:76,name:"E",octave:5,label:"E5",frequency:659.255},{pitch:77,name:"F",octave:5,label:"F5",frequency:698.456},{pitch:78,name:"F#",octave:5,label:"F#5",frequency:739.989},{pitch:79,name:"G",octave:5,label:"G5",frequency:783.991},{pitch:80,name:"G#",octave:5,label:"G#5",frequency:830.609},{pitch:81,name:"A",octave:5,label:"A5",frequency:880},{pitch:82,name:"A#",octave:5,label:"A#5",frequency:932.328},{pitch:83,name:"B",octave:5,label:"B5",frequency:987.767},{pitch:84,name:"C",octave:6,label:"C6",frequency:1046.502},{pitch:85,name:"C#",octave:6,label:"C#6",frequency:1108.731},{pitch:86,name:"D",octave:6,label:"D6",frequency:1174.659},{pitch:87,name:"D#",octave:6,label:"D#6",frequency:1244.508},{pitch:88,name:"E",octave:6,label:"E6",frequency:1318.51},{pitch:89,name:"F",octave:6,label:"F6",frequency:1396.913},{pitch:90,name:"F#",octave:6,label:"F#6",frequency:1479.978},{pitch:91,name:"G",octave:6,label:"G6",frequency:1567.982},{pitch:92,name:"G#",octave:6,label:"G#6",frequency:1661.219},{pitch:93,name:"A",octave:6,label:"A6",frequency:1760},{pitch:94,name:"A#",octave:6,label:"A#6",frequency:1864.655},{pitch:95,name:"B",octave:6,label:"B6",frequency:1975.533},{pitch:96,name:"C",octave:7,label:"C7",frequency:2093.005},{pitch:97,name:"C#",octave:7,label:"C#7",frequency:2217.461},{pitch:98,name:"D",octave:7,label:"D7",frequency:2349.318},{pitch:99,name:"D#",octave:7,label:"D#7",frequency:2489.016},{pitch:100,name:"E",octave:7,label:"E7",frequency:2637.02},{pitch:101,name:"F",octave:7,label:"F7",frequency:2793.826},{pitch:102,name:"F#",octave:7,label:"F#7",frequency:2959.955},{pitch:103,name:"G",octave:7,label:"G7",frequency:3135.963},{pitch:104,name:"G#",octave:7,label:"G#7",frequency:3322.438},{pitch:105,name:"A",octave:7,label:"A7",frequency:3520},{pitch:106,name:"A#",octave:7,label:"A#7",frequency:3729.31},{pitch:107,name:"B",octave:7,label:"B7",frequency:3951.066},{pitch:108,name:"C",octave:8,label:"C8",frequency:4186.009},{pitch:109,name:"C#",octave:8,label:"C#8",frequency:4434.922},{pitch:110,name:"D",octave:8,label:"D8",frequency:4698.636},{pitch:111,name:"D#",octave:8,label:"D#8",frequency:4978.032},{pitch:112,name:"E",octave:8,label:"E8",frequency:5274.041},{pitch:113,name:"F",octave:8,label:"F8",frequency:5587.652},{pitch:114,name:"F#",octave:8,label:"F#8",frequency:5919.911},{pitch:115,name:"G",octave:8,label:"G8",frequency:6271.927},{pitch:116,name:"G#",octave:8,label:"G#8",frequency:6644.875},{pitch:117,name:"A",octave:8,label:"A8",frequency:7040},{pitch:118,name:"A#",octave:8,label:"A#8",frequency:7458.62},{pitch:119,name:"B",octave:8,label:"B8",frequency:7902.133},{pitch:120,name:"C",octave:9,label:"C9",frequency:8372.018},{pitch:121,name:"C#",octave:9,label:"C#9",frequency:8869.844},{pitch:122,name:"D",octave:9,label:"D9",frequency:9397.273},{pitch:123,name:"D#",octave:9,label:"D#9",frequency:9956.063},{pitch:124,name:"E",octave:9,label:"E9",frequency:10548.08},{pitch:125,name:"F",octave:9,label:"F9",frequency:11175.3},{pitch:126,name:"F#",octave:9,label:"F#9",frequency:11839.82},{pitch:127,name:"G",octave:9,label:"G9",frequency:12543.85}],_=new Map([[1,null],[3,null],[6,null],[8,null],[10,null],[13,null],[15,null],[18,null],[20,null],[22,null],[25,null],[27,null],[30,null],[32,null],[34,null],[37,null],[39,null],[42,null],[44,null],[46,null],[49,null],[51,null],[54,null],[56,null],[58,null],[61,null],[63,null],[66,null],[68,null],[70,null],[73,null],[75,null],[78,null],[80,null],[82,null],[85,null],[87,null],[90,null],[92,null],[94,null],[97,null],[99,null],[102,null],[104,null],[106,null],[109,null],[111,null],[114,null],[116,null],[118,null],[121,null],[123,null],[126,null]]),P=new Map([]),E=[{number:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,group:"Piano",label:"Bright Acoustic Piano"},{number:2,group:"Piano",label:"Electric Grand Piano"},{number:3,group:"Piano",label:"Honky-tonk Piano"},{number:4,group:"Piano",label:"Electric Piano 1"},{number:5,group:"Piano",label:"Electric Piano 2"},{number:6,group:"Piano",label:"Harpsichord"},{number:7,group:"Piano",label:"Clavinet"},{number:8,group:"Chromatic Percussion",label:"Celesta"},{number:9,group:"Chromatic Percussion",label:"Glockenspiel"},{number:10,group:"Chromatic Percussion",label:"Music Box"},{number:11,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,group:"Chromatic Percussion",label:"Marimba"},{number:13,group:"Chromatic Percussion",label:"Xylophone"},{number:14,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,group:"Chromatic Percussion",label:"Dulcimer"},{number:16,group:"Organ",label:"Drawbar Organ"},{number:17,group:"Organ",label:"Percussive Organ"},{number:18,group:"Organ",label:"Rock Organ"},{number:19,group:"Organ",label:"Church Organ"},{number:20,group:"Organ",label:"Reed Organ"},{number:21,group:"Organ",label:"Accordion"},{number:22,group:"Organ",label:"Harmonica"},{number:23,group:"Organ",label:"Tango Accordion"},{number:24,group:"Guitar",label:"Acoustic Guitar(nylon)"},{number:25,group:"Guitar",label:"Acoustic Guitar(steel)"},{number:26,group:"Guitar",label:"Electric Guitar(jazz)"},{number:27,group:"Guitar",label:"Electric Guitar(clean)"},{number:28,group:"Guitar",label:"Electric Guitar(muted)"},{number:29,group:"Guitar",label:"Overdriven Guitar"},{number:30,group:"Guitar",label:"Distortion Guitar"},{number:31,group:"Guitar",label:"Guitar harmonics"},{number:32,group:"Bass",label:"Acoustic Bass"},{number:33,group:"Bass",label:"Electric Bass(finger)"},{number:34,group:"Bass",label:"Electric Bass(pick)"},{number:35,group:"Bass",label:"Fretless Bass"},{number:36,group:"Bass",label:"Slap Bass 1"},{number:37,group:"Bass",label:"Slap Bass 2"},{number:38,group:"Bass",label:"Synth Bass 1"},{number:39,group:"Bass",label:"Synth Bass 2"},{number:40,group:"Strings",label:"Violin"},{number:41,group:"Strings",label:"Viola"},{number:42,group:"Strings",label:"Cello"},{number:43,group:"Strings",label:"Contrabass"},{number:44,group:"Strings",label:"Tremolo Strings"},{number:45,group:"Strings",label:"Pizzicato Strings"},{number:46,group:"Strings",label:"Orchestral Harp"},{number:47,group:"Strings",label:"Timpani"},{number:48,group:"Strings (continued)",label:"String Ensemble 1"},{number:49,group:"Strings (continued)",label:"String Ensemble 2"},{number:50,group:"Strings (continued)",label:"Synth Strings 1"},{number:51,group:"Strings (continued)",label:"Synth Strings 2"},{number:52,group:"Strings (continued)",label:"Choir Aahs"},{number:53,group:"Strings (continued)",label:"Voice Oohs"},{number:54,group:"Strings (continued)",label:"Synth Voice"},{number:55,group:"Strings (continued)",label:"Orchestra Hit"},{number:56,group:"Brass",label:"Trumpet"},{number:57,group:"Brass",label:"Trombone"},{number:58,group:"Brass",label:"Tuba"},{number:59,group:"Brass",label:"Muted Trumpet"},{number:60,group:"Brass",label:"French Horn"},{number:61,group:"Brass",label:"Brass Section"},{number:62,group:"Brass",label:"Synth Brass 1"},{number:63,group:"Brass",label:"Synth Brass 2"},{number:64,group:"Reed",label:"Soprano Sax"},{number:65,group:"Reed",label:"Alto Sax"},{number:66,group:"Reed",label:"Tenor Sax"},{number:67,group:"Reed",label:"Baritone Sax"},{number:68,group:"Reed",label:"Oboe"},{number:69,group:"Reed",label:"English Horn"},{number:70,group:"Reed",label:"Bassoon"},{number:71,group:"Reed",label:"Clarinet"},{number:72,group:"Pipe",label:"Piccolo"},{number:73,group:"Pipe",label:"Flute"},{number:74,group:"Pipe",label:"Recorder"},{number:75,group:"Pipe",label:"Pan Flute"},{number:76,group:"Pipe",label:"Blown Bottle"},{number:77,group:"Pipe",label:"Shakuhachi"},{number:78,group:"Pipe",label:"Whistle"},{number:79,group:"Pipe",label:"Ocarina"},{number:80,group:"Synth Lead",label:"Lead 1(square)"},{number:81,group:"Synth Lead",label:"Lead 2(sawtooth)"},{number:82,group:"Synth Lead",label:"Lead 3(calliope)"},{number:83,group:"Synth Lead",label:"Lead 4(chiff)"},{number:84,group:"Synth Lead",label:"Lead 5(charang)"},{number:85,group:"Synth Lead",label:"Lead 6(voice)"},{number:86,group:"Synth Lead",label:"Lead 7(fifths)"},{number:87,group:"Synth Lead",label:"Lead 8(bass + lead)"},{number:88,group:"Synth Pad",label:"Pad 1(new age)"},{number:89,group:"Synth Pad",label:"Pad 2(warm)"},{number:90,group:"Synth Pad",label:"Pad 3(polysynth)"},{number:91,group:"Synth Pad",label:"Pad 4(choir)"},{number:92,group:"Synth Pad",label:"Pad 5(bowed)"},{number:93,group:"Synth Pad",label:"Pad 6(metallic)"},{number:94,group:"Synth Pad",label:"Pad 7(halo)"},{number:95,group:"Synth Pad",label:"Pad 8(sweep)"},{number:96,group:"Synth Effects",label:"FX 1(rain)"},{number:97,group:"Synth Effects",label:"FX 2(soundtrack)"},{number:98,group:"Synth Effects",label:"FX 3(crystal)"},{number:99,group:"Synth Effects",label:"FX 4(atmosphere)"},{number:100,group:"Synth Effects",label:"FX 5(brightness)"},{number:101,group:"Synth Effects",label:"FX 6(goblins)"},{number:102,group:"Synth Effects",label:"FX 7(echoes)"},{number:103,group:"Synth Effects",label:"FX 8(sci-fi)"},{number:104,group:"Ethnic",label:"Sitar"},{number:105,group:"Ethnic",label:"Banjo"},{number:106,group:"Ethnic",label:"Shamisen"},{number:107,group:"Ethnic",label:"Koto"},{number:108,group:"Ethnic",label:"Kalimba"},{number:109,group:"Ethnic",label:"Bag pipe"},{number:110,group:"Ethnic",label:"Fiddle"},{number:111,group:"Ethnic",label:"Shanai"},{number:112,group:"Percussive",label:"Tinkle Bell"},{number:113,group:"Percussive",label:"Agogo"},{number:114,group:"Percussive",label:"Steel Drums"},{number:115,group:"Percussive",label:"Woodblock"},{number:116,group:"Percussive",label:"Taiko Drum"},{number:117,group:"Percussive",label:"Melodic Tom"},{number:118,group:"Percussive",label:"Synth Drum"},{number:119,group:"Sound Effects",label:"Reverse Cymbal"},{number:120,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,group:"Sound Effects",label:"Breath Noise"},{number:122,group:"Sound Effects",label:"Seashore"},{number:123,group:"Sound Effects",label:"Bird Tweet"},{number:124,group:"Sound Effects",label:"Telephone Ring"},{number:125,group:"Sound Effects",label:"Helicopter"},{number:126,group:"Sound Effects",label:"Applause"},{number:127,group:"Sound Effects",label:"Gunshot"}],A=[{number:1,subnumber:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,subnumber:1,group:"Piano",label:"Wide Acoustic Grand"},{number:1,subnumber:2,group:"Piano",label:"Dark Acoustic Grand"},{number:2,subnumber:0,group:"Piano",label:"Bright Acoustic Piano"},{number:2,subnumber:1,group:"Piano",label:"Wide Bright Acoustic"},{number:3,subnumber:0,group:"Piano",label:"Electric Grand Piano"},{number:3,subnumber:1,group:"Piano",label:"Wide Electric Grand"},{number:4,subnumber:0,group:"Piano",label:"Honky-tonk Piano"},{number:4,subnumber:1,group:"Piano",label:"Wide Honky-tonk"},{number:5,subnumber:0,group:"Piano",label:"Rhodes Piano"},{number:5,subnumber:1,group:"Piano",label:"Detuned Electric Piano 1"},{number:5,subnumber:2,group:"Piano",label:"Electric Piano 1 Variation"},{number:5,subnumber:3,group:"Piano",label:"60's Electric Piano"},{number:6,subnumber:0,group:"Piano",label:"Chorused Electric Piano"},{number:6,subnumber:1,group:"Piano",label:"Detuned Electric Piano 2"},{number:6,subnumber:2,group:"Piano",label:"Electric Piano 2 Variation"},{number:6,subnumber:3,group:"Piano",label:"Electric Piano Legend"},{number:6,subnumber:4,group:"Piano",label:"Electric Piano Phase"},{number:7,subnumber:0,group:"Piano",label:"Harpsichord"},{number:7,subnumber:1,group:"Piano",label:"Coupled Harpsichord"},{number:7,subnumber:2,group:"Piano",label:"Wide Harpsichord"},{number:7,subnumber:3,group:"Piano",label:"Open Harpsichord"},{number:8,subnumber:0,group:"Piano",label:"Clavinet"},{number:8,subnumber:1,group:"Piano",label:"Pulse Clavinet"},{number:9,subnumber:0,group:"Chromatic Percussion",label:"Celesta"},{number:10,subnumber:0,group:"Chromatic Percussion",label:"Glockenspiel"},{number:11,subnumber:0,group:"Chromatic Percussion",label:"Music Box"},{number:12,subnumber:0,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,subnumber:1,group:"Chromatic Percussion",label:"Wet Vibraphone"},{number:13,subnumber:0,group:"Chromatic Percussion",label:"Marimba"},{number:13,subnumber:1,group:"Chromatic Percussion",label:"Wide Marimba"},{number:14,subnumber:0,group:"Chromatic Percussion",label:"Xylophone"},{number:15,subnumber:0,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,subnumber:1,group:"Chromatic Percussion",label:"Church Bells"},{number:15,subnumber:2,group:"Chromatic Percussion",label:"Carillon"},{number:16,subnumber:0,group:"Chromatic Percussion",label:"Dulcimer / Santur"},{number:17,subnumber:0,group:"Organ",label:"Hammond Organ"},{number:17,subnumber:1,group:"Organ",label:"Detuned Organ 1"},{number:17,subnumber:2,group:"Organ",label:"60's Organ 1"},{number:17,subnumber:3,group:"Organ",label:"Organ 4"},{number:18,subnumber:0,group:"Organ",label:"Percussive Organ"},{number:18,subnumber:1,group:"Organ",label:"Detuned Organ 2"},{number:18,subnumber:2,group:"Organ",label:"Organ 5"},{number:19,subnumber:0,group:"Organ",label:"Rock Organ"},{number:20,subnumber:0,group:"Organ",label:"Church Organ 1"},{number:20,subnumber:1,group:"Organ",label:"Church Organ 2"},{number:20,subnumber:2,group:"Organ",label:"Church Organ 3"},{number:21,subnumber:0,group:"Organ",label:"Reed Organ"},{number:21,subnumber:1,group:"Organ",label:"Puff Organ"},{number:22,subnumber:0,group:"Organ",label:"French Accordion"},{number:22,subnumber:1,group:"Organ",label:"Italian Accordion"},{number:23,subnumber:0,group:"Organ",label:"Harmonica"},{number:24,subnumber:0,group:"Organ",label:"Bandoneon"},{number:25,subnumber:0,group:"Guitar",label:"Nylon-String Guitar"},{number:25,subnumber:1,group:"Guitar",label:"Ukelele"},{number:25,subnumber:2,group:"Guitar",label:"Open Nylon Guitar"},{number:25,subnumber:3,group:"Guitar",label:"Nylon Guitar 2"},{number:26,subnumber:0,group:"Guitar",label:"Steel-String Guitar"},{number:26,subnumber:1,group:"Guitar",label:"12-String Guitar"},{number:26,subnumber:2,group:"Guitar",label:"Mandolin"},{number:26,subnumber:3,group:"Guitar",label:"Steel + Body"},{number:27,subnumber:0,group:"Guitar",label:"Jazz Guitar"},{number:27,subnumber:1,group:"Guitar",label:"Hawaiian Guitar"},{number:28,subnumber:0,group:"Guitar",label:"Clean Electric Guitar"},{number:28,subnumber:1,group:"Guitar",label:"Chorus Guitar"},{number:28,subnumber:2,group:"Guitar",label:"Mid Tone Guitar"},{number:29,subnumber:0,group:"Guitar",label:"Muted Electric Guitar"},{number:29,subnumber:1,group:"Guitar",label:"Funk Guitar"},{number:29,subnumber:2,group:"Guitar",label:"Funk Guitar 2"},{number:29,subnumber:3,group:"Guitar",label:"Jazz Man"},{number:30,subnumber:0,group:"Guitar",label:"Overdriven Guitar"},{number:30,subnumber:1,group:"Guitar",label:"Guitar Pinch"},{number:31,subnumber:0,group:"Guitar",label:"Distortion Guitar"},{number:31,subnumber:1,group:"Guitar",label:"Feedback Guitar"},{number:31,subnumber:2,group:"Guitar",label:"Distortion Rtm Guitar"},{number:32,subnumber:0,group:"Guitar",label:"Guitar Harmonics"},{number:32,subnumber:1,group:"Guitar",label:"Guitar Feedback"},{number:33,subnumber:0,group:"Bass",label:"Acoustic Bass"},{number:34,subnumber:0,group:"Bass",label:"Fingered Bass"},{number:34,subnumber:1,group:"Bass",label:"Finger Slap"},{number:35,subnumber:0,group:"Bass",label:"Picked Bass"},{number:36,subnumber:0,group:"Bass",label:"Fretless Bass"},{number:37,subnumber:0,group:"Bass",label:"Slap Bass 1"},{number:38,subnumber:0,group:"Bass",label:"Slap Bass 2"},{number:39,subnumber:0,group:"Bass",label:"Synth Bass 1"},{number:39,subnumber:1,group:"Bass",label:"Synth Bass 101"},{number:39,subnumber:2,group:"Bass",label:"Synth Bass 3"},{number:39,subnumber:3,group:"Bass",label:"Clavi Bass"},{number:39,subnumber:4,group:"Bass",label:"Hammer"},{number:40,subnumber:0,group:"Bass",label:"Synth Bass 2"},{number:40,subnumber:1,group:"Bass",label:"Synth Bass 4"},{number:40,subnumber:2,group:"Bass",label:"Rubber Bass"},{number:40,subnumber:3,group:"Bass",label:"Attack Pulse"},{number:41,subnumber:0,group:"Strings",label:"Violin"},{number:41,subnumber:1,group:"Strings",label:"Slow Violin"},{number:42,subnumber:0,group:"Strings",label:"Viola"},{number:43,subnumber:0,group:"Strings",label:"Cello"},{number:44,subnumber:0,group:"Strings",label:"Contrabass"},{number:45,subnumber:0,group:"Strings",label:"Tremolo Strings"},{number:46,subnumber:0,group:"Strings",label:"Pizzicato Strings"},{number:47,subnumber:0,group:"Strings",label:"Harp"},{number:47,subnumber:1,group:"Strings",label:"Yang Qin"},{number:48,subnumber:0,group:"Strings",label:"Timpani"},{number:49,subnumber:0,group:"Orchestral Ensemble",label:"String Ensemble"},{number:49,subnumber:1,group:"Orchestral Ensemble",label:"Orchestra Strings"},{number:49,subnumber:2,group:"Orchestral Ensemble",label:"60's Strings"},{number:50,subnumber:0,group:"Orchestral Ensemble",label:"Slow String Ensemble"},{number:51,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 1"},{number:51,subnumber:1,group:"Orchestral Ensemble",label:"Synth Strings 3"},{number:52,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 2"},{number:53,subnumber:0,group:"Orchestral Ensemble",label:"Choir Aahs"},{number:53,subnumber:1,group:"Orchestral Ensemble",label:"Choir Aahs 2"},{number:54,subnumber:0,group:"Orchestral Ensemble",label:"Voice Oohs"},{number:54,subnumber:1,group:"Orchestral Ensemble",label:"Humming"},{number:55,subnumber:0,group:"Orchestral Ensemble",label:"Synth Voice"},{number:55,subnumber:1,group:"Orchestral Ensemble",label:"Analog Voice"},{number:56,subnumber:0,group:"Orchestral Ensemble",label:"Orchestra Hit"},{number:56,subnumber:1,group:"Orchestral Ensemble",label:"Bass Hit"},{number:56,subnumber:2,group:"Orchestral Ensemble",label:"6th Hit"},{number:56,subnumber:3,group:"Orchestral Ensemble",label:"Euro Hit"},{number:57,subnumber:0,group:"Brass",label:"Trumpet"},{number:57,subnumber:1,group:"Brass",label:"Dark Trumpet"},{number:58,subnumber:0,group:"Brass",label:"Trombone"},{number:58,subnumber:1,group:"Brass",label:"Trombone 2"},{number:58,subnumber:2,group:"Brass",label:"Bright Trombone"},{number:59,subnumber:0,group:"Brass",label:"Tuba"},{number:60,subnumber:0,group:"Brass",label:"Muted Trumpet"},{number:60,subnumber:1,group:"Brass",label:"Muted Trumpet 2"},{number:61,subnumber:0,group:"Brass",label:"French Horn"},{number:61,subnumber:1,group:"Brass",label:"French Horn 2"},{number:62,subnumber:0,group:"Brass",label:"Brass Section"},{number:62,subnumber:1,group:"Brass",label:"Brass Section"},{number:63,subnumber:0,group:"Brass",label:"Synth Brass 1"},{number:63,subnumber:1,group:"Brass",label:"Synth Brass 3"},{number:63,subnumber:2,group:"Brass",label:"Analog Brass 1"},{number:63,subnumber:3,group:"Brass",label:"Jump Brass"},{number:64,subnumber:0,group:"Brass",label:"Synth Brass 2"},{number:64,subnumber:1,group:"Brass",label:"Synth Brass 4"},{number:64,subnumber:2,group:"Brass",label:"Analog Brass 2"},{number:65,subnumber:0,group:"Reed",label:"Soprano Sax"},{number:66,subnumber:0,group:"Reed",label:"Alto Sax"},{number:67,subnumber:0,group:"Reed",label:"Tenor Sax"},{number:68,subnumber:0,group:"Reed",label:"Baritone Sax"},{number:69,subnumber:0,group:"Reed",label:"Oboe"},{number:70,subnumber:0,group:"Reed",label:"English Horn"},{number:71,subnumber:0,group:"Reed",label:"Bassoon"},{number:72,subnumber:0,group:"Reed",label:"Clarinet"},{number:73,subnumber:0,group:"Wind",label:"Piccolo"},{number:74,subnumber:0,group:"Wind",label:"Flute"},{number:75,subnumber:0,group:"Wind",label:"Recorder"},{number:76,subnumber:0,group:"Wind",label:"Pan Flute"},{number:77,subnumber:0,group:"Wind",label:"Blown Bottle"},{number:78,subnumber:0,group:"Wind",label:"Shakuhachi"},{number:79,subnumber:0,group:"Wind",label:"Whistle"},{number:80,subnumber:0,group:"Wind",label:"Ocarina"},{number:81,subnumber:0,group:"Lead",label:"Square Lead"},{number:81,subnumber:1,group:"Lead",label:"Square Wave"},{number:81,subnumber:2,group:"Lead",label:"Sine Wave"},{number:82,subnumber:0,group:"Lead",label:"Saw Lead"},{number:82,subnumber:1,group:"Lead",label:"Saw Wave"},{number:82,subnumber:2,group:"Lead",label:"Doctor Solo"},{number:82,subnumber:3,group:"Lead",label:"Natural Lead"},{number:82,subnumber:4,group:"Lead",label:"Sequenced Saw"},{number:83,subnumber:0,group:"Lead",label:"Synth Calliope"},{number:84,subnumber:0,group:"Lead",label:"Chiffer Lead"},{number:85,subnumber:0,group:"Lead",label:"Charang"},{number:85,subnumber:1,group:"Lead",label:"Wire Lead"},{number:86,subnumber:0,group:"Lead",label:"Solo Synth Vox"},{number:87,subnumber:0,group:"Lead",label:"5th Saw Wave"},{number:88,subnumber:0,group:"Lead",label:"Bass & Lead"},{number:88,subnumber:1,group:"Lead",label:"Delayed Lead"},{number:89,subnumber:0,group:"Synth Pad",label:"Fantasia Pad"},{number:90,subnumber:0,group:"Synth Pad",label:"Warm Pad"},{number:90,subnumber:1,group:"Synth Pad",label:"Sine Pad"},{number:91,subnumber:0,group:"Synth Pad",label:"Polysynth Pad"},{number:92,subnumber:0,group:"Synth Pad",label:"Space Voice Pad"},{number:92,subnumber:1,group:"Synth Pad",label:"Itopia"},{number:93,subnumber:0,group:"Synth Pad",label:"Bowed Glass Pad"},{number:94,subnumber:0,group:"Synth Pad",label:"Metal Pad"},{number:95,subnumber:0,group:"Synth Pad",label:"Halo Pad"},{number:96,subnumber:0,group:"Synth Pad",label:"Sweep Pad"},{number:97,subnumber:0,group:"Synth Effects",label:"Ice Rain"},{number:98,subnumber:0,group:"Synth Effects",label:"Soundtrack"},{number:99,subnumber:0,group:"Synth Effects",label:"Crystal"},{number:99,subnumber:1,group:"Synth Effects",label:"Synth Mallet"},{number:100,subnumber:0,group:"Synth Effects",label:"Atmosphere"},{number:101,subnumber:0,group:"Synth Effects",label:"Brightness"},{number:102,subnumber:0,group:"Synth Effects",label:"Goblin"},{number:103,subnumber:0,group:"Synth Effects",label:"Echo Drops"},{number:103,subnumber:1,group:"Synth Effects",label:"Echo Bell"},{number:103,subnumber:2,group:"Synth Effects",label:"Echo Pan"},{number:104,subnumber:0,group:"Synth Effects",label:"Star Theme"},{number:105,subnumber:0,group:"Ethnic",label:"Sitar"},{number:105,subnumber:1,group:"Ethnic",label:"Sitar 2"},{number:106,subnumber:0,group:"Ethnic",label:"Banjo"},{number:107,subnumber:0,group:"Ethnic",label:"Shamisen"},{number:108,subnumber:0,group:"Ethnic",label:"Koto"},{number:108,subnumber:1,group:"Ethnic",label:"Taisho Koto"},{number:109,subnumber:0,group:"Ethnic",label:"Kalimba"},{number:110,subnumber:0,group:"Ethnic",label:"Bagpipe"},{number:111,subnumber:0,group:"Ethnic",label:"Fiddle"},{number:112,subnumber:0,group:"Ethnic",label:"Shanai"},{number:113,subnumber:0,group:"Percussive",label:"Tinkle Bell"},{number:114,subnumber:0,group:"Percussive",label:"Agogo"},{number:115,subnumber:0,group:"Percussive",label:"Steel Drums"},{number:116,subnumber:0,group:"Percussive",label:"Woodblock"},{number:116,subnumber:1,group:"Percussive",label:"Castanets"},{number:117,subnumber:0,group:"Percussive",label:"Taiko Drum"},{number:117,subnumber:1,group:"Percussive",label:"Concert Bass Drum"},{number:118,subnumber:0,group:"Percussive",label:"Melodic Tom 1"},{number:118,subnumber:1,group:"Percussive",label:"Melodic Tom 2"},{number:119,subnumber:0,group:"Percussive",label:"Synth Drum"},{number:119,subnumber:1,group:"Percussive",label:"808 Tom"},{number:119,subnumber:2,group:"Percussive",label:"Electric Percussion"},{number:120,subnumber:0,group:"Percussive",label:"Reverse Cymbal"},{number:121,subnumber:0,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,subnumber:1,group:"Sound Effects",label:"Guitar Cut Noise"},{number:121,subnumber:2,group:"Sound Effects",label:"String Slap"},{number:122,subnumber:0,group:"Sound Effects",label:"Breath Noise"},{number:122,subnumber:1,group:"Sound Effects",label:"Flute Key Click"},{number:123,subnumber:0,group:"Sound Effects",label:"Seashore"},{number:123,subnumber:1,group:"Sound Effects",label:"Rain"},{number:123,subnumber:2,group:"Sound Effects",label:"Thunder"},{number:123,subnumber:3,group:"Sound Effects",label:"Wind"},{number:123,subnumber:4,group:"Sound Effects",label:"Stream"},{number:123,subnumber:5,group:"Sound Effects",label:"Bubble"},{number:124,subnumber:0,group:"Sound Effects",label:"Bird Tweet"},{number:124,subnumber:1,group:"Sound Effects",label:"Dog"},{number:124,subnumber:2,group:"Sound Effects",label:"Horse Gallop"},{number:124,subnumber:3,group:"Sound Effects",label:"Bird 2"},{number:125,subnumber:0,group:"Sound Effects",label:"Telephone 1"},{number:125,subnumber:1,group:"Sound Effects",label:"Telephone 2"},{number:125,subnumber:2,group:"Sound Effects",label:"Door Creaking"},{number:125,subnumber:3,group:"Sound Effects",label:"Door Closing"},{number:125,subnumber:4,group:"Sound Effects",label:"Scratch"},{number:125,subnumber:5,group:"Sound Effects",label:"Wind Chimes"},{number:126,subnumber:0,group:"Sound Effects",label:"Helicopter"},{number:126,subnumber:1,group:"Sound Effects",label:"Car Engine"},{number:126,subnumber:2,group:"Sound Effects",label:"Car Stop"},{number:126,subnumber:3,group:"Sound Effects",label:"Car Pass"},{number:126,subnumber:4,group:"Sound Effects",label:"Car Crash"},{number:126,subnumber:5,group:"Sound Effects",label:"Siren"},{number:126,subnumber:6,group:"Sound Effects",label:"Train"},{number:126,subnumber:7,group:"Sound Effects",label:"Jetplane"},{number:126,subnumber:8,group:"Sound Effects",label:"Starship"},{number:126,subnumber:9,group:"Sound Effects",label:"Burst Noise"},{number:127,subnumber:0,group:"Sound Effects",label:"Applause"},{number:127,subnumber:1,group:"Sound Effects",label:"Laughing"},{number:127,subnumber:2,group:"Sound Effects",label:"Screaming"},{number:127,subnumber:3,group:"Sound Effects",label:"Punch"},{number:127,subnumber:4,group:"Sound Effects",label:"Heart Beat"},{number:127,subnumber:5,group:"Sound Effects",label:"Footsteps"},{number:128,subnumber:0,group:"Sound Effects",label:"Gun Shot"},{number:128,subnumber:1,group:"Sound Effects",label:"Machine Gun"},{number:128,subnumber:2,group:"Sound Effects",label:"Lasergun"},{number:128,subnumber:3,group:"Sound Effects",label:"Explosion"}],T=new Map([[27,"High Q(GM2)"],[28,"Slap(GM2)"],[29,"Scratch Push(GM2)"],[30,"Scratch Pull(GM2)"],[31,"Sticks(GM2)"],[32,"Square Click(GM2)"],[33,"Metronome Click(GM2)"],[34,"Metronome Bell(GM2)"],[35,"Bass Drum 2"],[36,"Bass Drum 1"],[37,"Side Stick"],[38,"Snare Drum 1"],[39,"Hand Clap"],[40,"Snare Drum 2"],[41,"Low Tom 2"],[42,"Closed Hi-hat"],[43,"Low Tom 1"],[44,"Pedal Hi-hat"],[45,"Mid Tom 2"],[46,"Open Hi-hat"],[47,"Mid Tom 1"],[48,"High Tom 2"],[49,"Crash Cymbal 1"],[50,"High Tom 1"],[51,"Ride Cymbal 1"],[52,"Chinese Cymbal"],[53,"Ride Bell"],[54,"Tambourine"],[55,"Splash Cymbal"],[56,"Cowbell"],[57,"Crash Cymbal 2"],[58,"Vibra Slap"],[59,"Ride Cymbal 2"],[60,"High Bongo"],[61,"Low Bongo"],[62,"Mute High Conga"],[63,"Open High Conga"],[64,"Low Conga"],[65,"High Timbale"],[66,"Low Timbale"],[67,"High Agogo"],[68,"Low Agogo"],[69,"Cabasa"],[70,"Maracas"],[71,"Short Whistle"],[72,"Long Whistle"],[73,"Short Guiro"],[74,"Long Guiro"],[75,"Claves"],[76,"High Wood Block"],[77,"Low Wood Block"],[78,"Mute Cuica"],[79,"Open Cuica"],[80,"Mute Triangle"],[81,"Open Triangle"],[82,"Shaker(GM2)"],[83,"Jingle Bell(GM2)"],[84,"Belltree(GM2)"],[85,"Castanets(GM2)"],[86,"Mute Surdo(GM2)"],[87,"Open Surdo(GM2)"]]),x=[{instrNr:40,nrL2:-1,subNrL2:-1,label:"Violin",min:55,max:103},{instrNr:41,nrL2:-1,subNrL2:-1,label:"Viola",min:48,max:91},{instrNr:42,nrL2:-1,subNrL2:-1,label:"Cello",min:36,max:76},{instrNr:-1,nrL2:-1,subNrL2:-1,label:"Double Bass",min:28,max:67},{instrNr:-1,nrL2:-1,subNrL2:-1,label:"Bass Guitar",min:28,max:67},{instrNr:-1,nrL2:-1,subNrL2:-1,label:"Acoustic Guitar",min:40,max:88},{instrNr:58,nrL2:59,subNrL2:0,label:"Tuba",min:28,max:58},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Bass Trombone",min:34,max:67},{instrNr:0,nrL2:-1,subNrL2:-1,label:"French Horn",min:34,max:77},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Trombone",min:40,max:72},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Trumpet",min:55,max:82},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Piccolo",min:74,max:102},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Flute",min:60,max:96},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Oboe",min:58,max:91},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Alto Flute",min:55,max:91},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Cor Anglais (English Horn)",min:52,max:81},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Clarinet",min:50,max:94},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Bass Clarinet",min:38,max:77},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Bassoon",min:34,max:75},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Contrabassoon",min:22,max:53},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Soprano Recorder",min:72,max:98},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Alto Recorder",min:65,max:91},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Tenor Recorder",min:60,max:86},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Bass Recorder",min:53,max:79},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Baritone Sax",min:36,max:69},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Tenor Sax",min:44,max:76},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Alto Sax",min:49,max:81},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Soprano Sax",min:56,max:88},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Glockenspiel",min:79,max:108},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Xylophone",min:65,max:108},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Vibraphone",min:53,max:89},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Marimba",min:45,max:96},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Bass Marimba",min:33,max:81},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Celeste",min:60,max:108},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Tubular Bells",min:60,max:77},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Timpani",min:40,max:55},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Harpsichord",min:29,max:89},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Harp",min:24,max:103}];for(let e of M)l.set(e.pitch,e),c.set(e.label,e);for(let e of E)h.set(e.number,e);for(let e of A){const t=`${e.number}-${e.subnumber}`;f.set(t,e)}class C{constructor(e=0,t=0,n=127,r=0,a=null){this.pitch=e,this.start=t,this.velocity=n,this.channel=r,this.end=a}static from(e){const{pitch:t=0,start:n=0,velocity:r=127,channel:a=0,end:i=null}=e;return new C(t,n,r,a,i)}clone(){return new C(this.pitch,this.start,this.velocity,this.channel,this.end)}getDuration(){return null===this.end?0:this.end-this.start}getName(){return b(this.pitch).label}getLetter(){return b(this.pitch).name}getOctave(){return b(this.pitch).octave}shiftTime(e){const t=this.clone();return t.start+=e,t.end=null===t.end?null:t.end+e,t}scaleTime(e){const t=this.clone();return t.start*=e,t.end=null===t.end?null:t.end*e,t}overlapsInTime(e){return this.start>=e.start&&this.start<=e.end||this.end>=e.start&&this.end<=e.end}equals(e){return e instanceof C&&this.pitch===e.pitch&&this.start===e.start&&this.velocity===e.velocity&&this.channel===e.channel&&this.end===e.end}}class N extends C{constructor(e=0,t=0,n=127,r=0,a=null,i=null,o=null){super(e,t,n,r,a),this.string=i,this.fret=o}static from(e){const{pitch:t=0,start:n=0,velocity:r=127,channel:a=0,end:i=null,string:o=null,fret:u=null}=e;return new N(t,n,r,a,i,o,u)}static fromNote(e,t,n){return new N(e.pitch,e.start,e.velocity,e.channel,e.end,t,n)}toNote(){return new C(this.pitch,this.start,this.velocity,this.channel,this.end)}clone(){return new N(this.pitch,this.start,this.velocity,this.channel,this.end,this.string,this.fret)}equals(e){return e instanceof N&&this.pitch===e.pitch&&this.start===e.start&&this.velocity===e.velocity&&this.channel===e.channel&&this.end===e.end&&this.string===e.string&&this.fret===e.fret}}function B(e,t){let n,r;if(void 0===t)for(const t of e)null!=t&&(void 0===n?t>=t&&(n=r=t):(n>t&&(n=t),r<t&&(r=t)));else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)))}return[n,r]}function k(e){return e}function D(e,...t){return function(e,t,n,r){return function e(a,i){if(i>=r.length)return n(a);const o=new Map,u=r[i++];let s=-1;for(const e of a){const t=u(e,++s,a),n=o.get(t);n?n.push(e):o.set(t,[e])}for(const[t,n]of o)o.set(t,e(n,i));return t(o)}(e,0)}(e,k,k,t)}function G(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function q(e,t){let n=0,r=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++n,r+=t);else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(i=+i)>=i&&(++n,r+=i)}if(n)return r/n}function F(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let a of e)null!=(a=t(a,++r,e))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}function L(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function O(e,t,n=0,r=e.length-1,a=L){for(;r>n;){if(r-n>600){const i=r-n+1,o=t-n+1,u=Math.log(i),s=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*s*(i-s)/i)*(o-i/2<0?-1:1);O(e,t,Math.max(n,Math.floor(t-o*s/i+l)),Math.min(r,Math.floor(t+(i-o)*s/i+l)),a)}const i=e[t];let o=n,u=r;for(I(e,n,t),a(e[r],i)>0&&I(e,n,r);o<u;){for(I(e,o,u),++o,--u;a(e[o],i)<0;)++o;for(;a(e[u],i)>0;)--u}0===a(e[n],i)?I(e,n,u):(++u,I(e,u,r)),u<=t&&(n=u+1),t<=u&&(r=u-1)}return e}function I(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function H(e,t,n){if(r=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n))).length){if((t=+t)<=0||r<2)return F(e);if(t>=1)return G(e);var r,a=(r-1)*t,i=Math.floor(a),o=G(O(e,i).subarray(0,i+1));return o+(F(e.subarray(i+1))-o)*(a-i)}}function $(){}function R(e){return null==e?$:function(){return this.querySelector(e)}}function W(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function j(){return[]}function V(e){return null==e?j:function(){return this.querySelectorAll(e)}}function z(e){return function(){return this.matches(e)}}function X(e){return function(t){return t.matches(e)}}var U=Array.prototype.find;function Y(){return this.firstElementChild}var J=Array.prototype.filter;function K(){return this.children}function Q(e){return new Array(e.length)}function Z(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function ee(e){return function(){return e}}function te(e,t,n,r,a,i){for(var o,u=0,s=t.length,l=i.length;u<l;++u)(o=t[u])?(o.__data__=i[u],r[u]=o):n[u]=new Z(e,i[u]);for(;u<s;++u)(o=t[u])&&(a[u]=o)}function ne(e,t,n,r,a,i,o){var u,s,l,c=new Map,h=t.length,f=i.length,b=new Array(h);for(u=0;u<h;++u)(s=t[u])&&(b[u]=l=o.call(s,s.__data__,u,t)+"",c.has(l)?a[u]=s:c.set(l,s));for(u=0;u<f;++u)l=o.call(e,i[u],u,i)+"",(s=c.get(l))?(r[u]=s,s.__data__=i[u],c.delete(l)):n[u]=new Z(e,i[u]);for(u=0;u<h;++u)(s=t[u])&&c.get(b[u])===s&&(a[u]=s)}function re(e){return e.__data__}function ae(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}Z.prototype={constructor:Z,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var ie="http://www.w3.org/1999/xhtml";const oe={svg:"http://www.w3.org/2000/svg",xhtml:ie,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ue(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),oe.hasOwnProperty(t)?{space:oe[t],local:e}:e}function se(e){return function(){this.removeAttribute(e)}}function le(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ce(e,t){return function(){this.setAttribute(e,t)}}function he(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function fe(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function be(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function me(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function pe(e){return function(){this.style.removeProperty(e)}}function ge(e,t,n){return function(){this.style.setProperty(e,t,n)}}function de(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ye(e,t){return e.style.getPropertyValue(t)||me(e).getComputedStyle(e,null).getPropertyValue(t)}function ve(e){return function(){delete this[e]}}function we(e,t){return function(){this[e]=t}}function Se(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Me(e){return e.trim().split(/^|\s+/)}function _e(e){return e.classList||new Pe(e)}function Pe(e){this._node=e,this._names=Me(e.getAttribute("class")||"")}function Ee(e,t){for(var n=_e(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function Ae(e,t){for(var n=_e(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function Te(e){return function(){Ee(this,e)}}function xe(e){return function(){Ae(this,e)}}function Ce(e,t){return function(){(t.apply(this,arguments)?Ee:Ae)(this,e)}}function Ne(){this.textContent=""}function Be(e){return function(){this.textContent=e}}function ke(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function De(){this.innerHTML=""}function Ge(e){return function(){this.innerHTML=e}}function qe(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function Fe(){this.nextSibling&&this.parentNode.appendChild(this)}function Le(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Oe(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ie&&t.documentElement.namespaceURI===ie?t.createElement(e):t.createElementNS(n,e)}}function Ie(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function He(e){var t=ue(e);return(t.local?Ie:Oe)(t)}function $e(){return null}function Re(){var e=this.parentNode;e&&e.removeChild(this)}function We(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function je(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ve(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function ze(e){return function(){var t=this.__on;if(t){for(var n,r=0,a=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++a]=n:this.removeEventListener(n.type,n.listener,n.options);++a?t.length=a:delete this.__on}}}function Xe(e,t,n){return function(){var r,a=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(a)for(var o=0,u=a.length;o<u;++o)if((r=a[o]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=t);this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},a?a.push(r):this.__on=[r]}}function Ue(e,t,n){var r=me(e),a=r.CustomEvent;"function"==typeof a?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function Ye(e,t){return function(){return Ue(this,e,t)}}function Je(e,t){return function(){return Ue(this,e,t.apply(this,arguments))}}Pe.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Ke=[null];function Qe(e,t){this._groups=e,this._parents=t}function Ze(){return new Qe([[document.documentElement]],Ke)}Qe.prototype=Ze.prototype={constructor:Qe,select:function(e){"function"!=typeof e&&(e=R(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o,u=t[a],s=u.length,l=r[a]=new Array(s),c=0;c<s;++c)(i=u[c])&&(o=e.call(i,i.__data__,c,u))&&("__data__"in i&&(o.__data__=i.__data__),l[c]=o);return new Qe(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);return null==t?[]:W(t)}}(e):V(e);for(var t=this._groups,n=t.length,r=[],a=[],i=0;i<n;++i)for(var o,u=t[i],s=u.length,l=0;l<s;++l)(o=u[l])&&(r.push(e.call(o,o.__data__,l,u)),a.push(o));return new Qe(r,a)},selectChild:function(e){return this.select(null==e?Y:function(e){return function(){return U.call(this.children,e)}}("function"==typeof e?e:X(e)))},selectChildren:function(e){return this.selectAll(null==e?K:function(e){return function(){return J.call(this.children,e)}}("function"==typeof e?e:X(e)))},filter:function(e){"function"!=typeof e&&(e=z(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],u=o.length,s=r[a]=[],l=0;l<u;++l)(i=o[l])&&e.call(i,i.__data__,l,o)&&s.push(i);return new Qe(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,re);var n=t?ne:te,r=this._parents,a=this._groups;"function"!=typeof e&&(e=ee(e));for(var i=a.length,o=new Array(i),u=new Array(i),s=new Array(i),l=0;l<i;++l){var c=r[l],h=a[l],f=h.length,b=W(e.call(c,c&&c.__data__,l,r)),m=b.length,p=u[l]=new Array(m),g=o[l]=new Array(m),d=s[l]=new Array(f);n(c,h,p,g,d,b,t);for(var y,v,w=0,S=0;w<m;++w)if(y=p[w]){for(w>=S&&(S=w+1);!(v=g[S])&&++S<m;);y._next=v||null}}return(o=new Qe(o,r))._enter=u,o._exit=s,o},enter:function(){return new Qe(this._enter||this._groups.map(Q),this._parents)},exit:function(){return new Qe(this._exit||this._groups.map(Q),this._parents)},join:function(e,t,n){var r=this.enter(),a=this,i=this.exit();return r="function"==typeof e?e(r):r.append(e+""),null!=t&&(a=t(a)),null==n?i.remove():n(i),r&&a?r.merge(a).order():a},merge:function(e){if(!(e instanceof Qe))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),u=0;u<i;++u)for(var s,l=t[u],c=n[u],h=l.length,f=o[u]=new Array(h),b=0;b<h;++b)(s=l[b]||c[b])&&(f[b]=s);for(;u<r;++u)o[u]=t[u];return new Qe(o,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,a=e[t],i=a.length-1,o=a[i];--i>=0;)(r=a[i])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=ae);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o,u=n[i],s=u.length,l=a[i]=new Array(s),c=0;c<s;++c)(o=u[c])&&(l[c]=o);l.sort(t)}return new Qe(a,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a,i=t[n],o=0,u=i.length;o<u;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this},attr:function(e,t){var n=ue(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?le:se:"function"==typeof t?n.local?be:fe:n.local?he:ce)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?pe:"function"==typeof t?de:ge)(e,t,null==n?"":n)):ye(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?ve:"function"==typeof t?Se:we)(e,t)):this.node()[e]},classed:function(e,t){var n=Me(e+"");if(arguments.length<2){for(var r=_e(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"==typeof t?Ce:t?Te:xe)(n,t))},text:function(e){return arguments.length?this.each(null==e?Ne:("function"==typeof e?ke:Be)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?De:("function"==typeof e?qe:Ge)(e)):this.node().innerHTML},raise:function(){return this.each(Fe)},lower:function(){return this.each(Le)},append:function(e){var t="function"==typeof e?e:He(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:He(e),r=null==t?$e:"function"==typeof t?t:R(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Re)},clone:function(e){return this.select(e?je:We)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,a,i=Ve(e+""),o=i.length;if(!(arguments.length<2)){for(u=t?Xe:ze,r=0;r<o;++r)this.each(u(i[r],t,n));return this}var u=this.node().__on;if(u)for(var s,l=0,c=u.length;l<c;++l)for(r=0,s=u[l];r<o;++r)if((a=i[r]).type===s.type&&a.name===s.name)return s.value},dispatch:function(e,t){return this.each(("function"==typeof t?Je:Ye)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,a=e[t],i=0,o=a.length;i<o;++i)(r=a[i])&&(yield r)}};const et=Ze;var tt={value:()=>{}};function nt(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new rt(r)}function rt(e){this._=e}function at(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function it(e,t){for(var n,r=0,a=e.length;r<a;++r)if((n=e[r]).name===t)return n.value}function ot(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=tt,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}rt.prototype=nt.prototype={constructor:rt,on:function(e,t){var n,r=this._,a=at(e+"",r),i=-1,o=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++i<o;)if(n=(e=a[i]).type)r[n]=ot(r[n],e.name,t);else if(null==t)for(n in r)r[n]=ot(r[n],e.name,null);return this}for(;++i<o;)if((n=(e=a[i]).type)&&(n=it(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new rt(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,a)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,i=r.length;a<i;++a)r[a].value.apply(t,n)}};const ut=nt;var st,lt,ct=0,ht=0,ft=0,bt=0,mt=0,pt=0,gt="object"==typeof performance&&performance.now?performance:Date,dt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function yt(){return mt||(dt(vt),mt=gt.now()+pt)}function vt(){mt=0}function wt(){this._call=this._time=this._next=null}function St(e,t,n){var r=new wt;return r.restart(e,t,n),r}function Mt(){mt=(bt=gt.now())+pt,ct=ht=0;try{!function(){yt(),++ct;for(var e,t=st;t;)(e=mt-t._time)>=0&&t._call.call(null,e),t=t._next;--ct}()}finally{ct=0,function(){for(var e,t,n=st,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:st=t);lt=e,Pt(r)}(),mt=0}}function _t(){var e=gt.now(),t=e-bt;t>1e3&&(pt-=t,bt=e)}function Pt(e){ct||(ht&&(ht=clearTimeout(ht)),e-mt>24?(e<1/0&&(ht=setTimeout(Mt,e-gt.now()-pt)),ft&&(ft=clearInterval(ft))):(ft||(bt=gt.now(),ft=setInterval(_t,1e3)),ct=1,dt(Mt)))}function Et(e,t,n){var r=new wt;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}wt.prototype=St.prototype={constructor:wt,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?yt():+n)+(null==t?0:+t),this._next||lt===this||(lt?lt._next=this:st=this,lt=this),this._call=e,this._time=n,Pt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Pt())}};var At=ut("start","end","cancel","interrupt"),Tt=[];function xt(e,t,n,r,a,i){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function(e,t,n){var r,a=e.__transition;function i(s){var l,c,h,f;if(1!==n.state)return u();for(l in a)if((f=a[l]).name===n.name){if(3===f.state)return Et(i);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete a[l]):+l<t&&(f.state=6,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete a[l])}if(Et((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(s))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),l=0,c=-1;l<h;++l)(f=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(r[++c]=f);r.length=c+1}}function o(t){for(var a=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(u),n.state=5,1),i=-1,o=r.length;++i<o;)r[i].call(e,a);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){for(var r in n.state=6,n.timer.stop(),delete a[t],a)return;delete e.__transition}a[t]=n,n.timer=St((function(e){n.state=1,n.timer.restart(i,n.delay,n.time),n.delay<=e&&i(e-n.delay)}),0,n.time)}(e,n,{name:t,index:r,group:a,on:At,tween:Tt,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function Ct(e,t){var n=Bt(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Nt(e,t){var n=Bt(e,t);if(n.state>3)throw new Error("too late; already running");return n}function Bt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function kt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Dt,Gt=180/Math.PI,qt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ft(e,t,n,r,a,i){var o,u,s;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(s=e*n+t*r)&&(n-=e*s,r-=t*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),e*r<t*n&&(e=-e,t=-t,s=-s,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*Gt,skewX:Math.atan(s)*Gt,scaleX:o,scaleY:u}}function Lt(e,t,n,r){function a(e){return e.length?e.pop()+" ":""}return function(i,o){var u=[],s=[];return i=e(i),o=e(o),function(e,r,a,i,o,u){if(e!==a||r!==i){var s=o.push("translate(",null,t,null,n);u.push({i:s-4,x:kt(e,a)},{i:s-2,x:kt(r,i)})}else(a||i)&&o.push("translate("+a+t+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,u,s),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(a(n)+"rotate(",null,r)-2,x:kt(e,t)})):t&&n.push(a(n)+"rotate("+t+r)}(i.rotate,o.rotate,u,s),function(e,t,n,i){e!==t?i.push({i:n.push(a(n)+"skewX(",null,r)-2,x:kt(e,t)}):t&&n.push(a(n)+"skewX("+t+r)}(i.skewX,o.skewX,u,s),function(e,t,n,r,i,o){if(e!==n||t!==r){var u=i.push(a(i)+"scale(",null,",",null,")");o.push({i:u-4,x:kt(e,n)},{i:u-2,x:kt(t,r)})}else 1===n&&1===r||i.push(a(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,u,s),i=o=null,function(e){for(var t,n=-1,r=s.length;++n<r;)u[(t=s[n]).i]=t.x(e);return u.join("")}}}var Ot=Lt((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?qt:Ft(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),It=Lt((function(e){return null==e?qt:(Dt||(Dt=document.createElementNS("http://www.w3.org/2000/svg","g")),Dt.setAttribute("transform",e),(e=Dt.transform.baseVal.consolidate())?Ft((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):qt)}),", ",")",")");function Ht(e,t){var n,r;return function(){var a=Nt(this,e),i=a.tween;if(i!==n)for(var o=0,u=(r=n=i).length;o<u;++o)if(r[o].name===t){(r=r.slice()).splice(o,1);break}a.tween=r}}function $t(e,t,n){var r,a;if("function"!=typeof n)throw new Error;return function(){var i=Nt(this,e),o=i.tween;if(o!==r){a=(r=o).slice();for(var u={name:t,value:n},s=0,l=a.length;s<l;++s)if(a[s].name===t){a[s]=u;break}s===l&&a.push(u)}i.tween=a}}function Rt(e,t,n){var r=e._id;return e.each((function(){var e=Nt(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return Bt(e,r).value[t]}}function Wt(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function jt(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Vt(){}var zt=.7,Xt=1/zt,Ut="\\s*([+-]?\\d+)\\s*",Yt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Jt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Kt=/^#([0-9a-f]{3,8})$/,Qt=new RegExp("^rgb\\("+[Ut,Ut,Ut]+"\\)$"),Zt=new RegExp("^rgb\\("+[Jt,Jt,Jt]+"\\)$"),en=new RegExp("^rgba\\("+[Ut,Ut,Ut,Yt]+"\\)$"),tn=new RegExp("^rgba\\("+[Jt,Jt,Jt,Yt]+"\\)$"),nn=new RegExp("^hsl\\("+[Yt,Jt,Jt]+"\\)$"),rn=new RegExp("^hsla\\("+[Yt,Jt,Jt,Yt]+"\\)$"),an={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function on(){return this.rgb().formatHex()}function un(){return this.rgb().formatRgb()}function sn(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Kt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?ln(t):3===n?new bn(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?cn(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?cn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Qt.exec(e))?new bn(t[1],t[2],t[3],1):(t=Zt.exec(e))?new bn(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=en.exec(e))?cn(t[1],t[2],t[3],t[4]):(t=tn.exec(e))?cn(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=nn.exec(e))?dn(t[1],t[2]/100,t[3]/100,1):(t=rn.exec(e))?dn(t[1],t[2]/100,t[3]/100,t[4]):an.hasOwnProperty(e)?ln(an[e]):"transparent"===e?new bn(NaN,NaN,NaN,0):null}function ln(e){return new bn(e>>16&255,e>>8&255,255&e,1)}function cn(e,t,n,r){return r<=0&&(e=t=n=NaN),new bn(e,t,n,r)}function hn(e){return e instanceof Vt||(e=sn(e)),e?new bn((e=e.rgb()).r,e.g,e.b,e.opacity):new bn}function fn(e,t,n,r){return 1===arguments.length?hn(e):new bn(e,t,n,null==r?1:r)}function bn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function mn(){return"#"+gn(this.r)+gn(this.g)+gn(this.b)}function pn(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function gn(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function dn(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new wn(e,t,n,r)}function yn(e){if(e instanceof wn)return new wn(e.h,e.s,e.l,e.opacity);if(e instanceof Vt||(e=sn(e)),!e)return new wn;if(e instanceof wn)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,u=i-a,s=(i+a)/2;return u?(o=t===i?(n-r)/u+6*(n<r):n===i?(r-t)/u+2:(t-n)/u+4,u/=s<.5?i+a:2-i-a,o*=60):u=s>0&&s<1?0:o,new wn(o,u,s,e.opacity)}function vn(e,t,n,r){return 1===arguments.length?yn(e):new wn(e,t,n,null==r?1:r)}function wn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Sn(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Mn(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}Wt(Vt,sn,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:on,formatHex:on,formatHsl:function(){return yn(this).formatHsl()},formatRgb:un,toString:un}),Wt(bn,fn,jt(Vt,{brighter:function(e){return e=null==e?Xt:Math.pow(Xt,e),new bn(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?zt:Math.pow(zt,e),new bn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:mn,formatHex:mn,formatRgb:pn,toString:pn})),Wt(wn,vn,jt(Vt,{brighter:function(e){return e=null==e?Xt:Math.pow(Xt,e),new wn(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?zt:Math.pow(zt,e),new wn(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new bn(Sn(e>=240?e-240:e+120,a,r),Sn(e,a,r),Sn(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const _n=e=>()=>e;function Pn(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):_n(isNaN(e)?t:e)}const En=function e(t){var n=function(e){return 1==(e=+e)?Pn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):_n(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=fn(e)).r,(t=fn(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=Pn(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function An(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),u=new Array(a);for(n=0;n<a;++n)r=fn(t[n]),i[n]=r.r||0,o[n]=r.g||0,u[n]=r.b||0;return i=e(i),o=e(o),u=e(u),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=u(e),r+""}}}An((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,u=r<t-1?e[r+2]:2*i-a;return Mn((n-r/t)*t,o,a,i,u)}})),An((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],u=e[(r+2)%t];return Mn((n-r/t)*t,a,i,o,u)}}));var Tn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xn=new RegExp(Tn.source,"g");function Cn(e,t){var n,r,a,i=Tn.lastIndex=xn.lastIndex=0,o=-1,u=[],s=[];for(e+="",t+="";(n=Tn.exec(e))&&(r=xn.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),u[o]?u[o]+=a:u[++o]=a),(n=n[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:kt(n,r)})),i=xn.lastIndex;return i<t.length&&(a=t.slice(i),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,r=0;r<t;++r)u[(n=s[r]).i]=n.x(e);return u.join("")})}function Nn(e,t){var n;return("number"==typeof t?kt:t instanceof sn?En:(n=sn(t))?(t=n,En):Cn)(e,t)}function Bn(e){return function(){this.removeAttribute(e)}}function kn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Dn(e,t,n){var r,a,i=n+"";return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function Gn(e,t,n){var r,a,i=n+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function qn(e,t,n){var r,a,i;return function(){var o,u,s=n(this);if(null!=s)return(o=this.getAttribute(e))===(u=s+"")?null:o===r&&u===a?i:(a=u,i=t(r=o,s));this.removeAttribute(e)}}function Fn(e,t,n){var r,a,i;return function(){var o,u,s=n(this);if(null!=s)return(o=this.getAttributeNS(e.space,e.local))===(u=s+"")?null:o===r&&u===a?i:(a=u,i=t(r=o,s));this.removeAttributeNS(e.space,e.local)}}function Ln(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function On(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function In(e,t){var n,r;function a(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&On(e,a)),n}return a._value=t,a}function Hn(e,t){var n,r;function a(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&Ln(e,a)),n}return a._value=t,a}function $n(e,t){return function(){Ct(this,e).delay=+t.apply(this,arguments)}}function Rn(e,t){return t=+t,function(){Ct(this,e).delay=t}}function Wn(e,t){return function(){Nt(this,e).duration=+t.apply(this,arguments)}}function jn(e,t){return t=+t,function(){Nt(this,e).duration=t}}function Vn(e,t){if("function"!=typeof t)throw new Error;return function(){Nt(this,e).ease=t}}function zn(e,t,n){var r,a,i=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?Ct:Nt;return function(){var o=i(this,e),u=o.on;u!==r&&(a=(r=u).copy()).on(t,n),o.on=a}}var Xn=et.prototype.constructor;function Un(e){return function(){this.style.removeProperty(e)}}function Yn(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Jn(e,t,n){var r,a;function i(){var i=t.apply(this,arguments);return i!==a&&(r=(a=i)&&Yn(e,i,n)),r}return i._value=t,i}function Kn(e){return function(t){this.textContent=e.call(this,t)}}function Qn(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&Kn(r)),t}return r._value=e,r}var Zn=0;function er(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function tr(){return++Zn}var nr=et.prototype;er.prototype=function(e){return et().transition(e)}.prototype={constructor:er,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=R(e));for(var r=this._groups,a=r.length,i=new Array(a),o=0;o<a;++o)for(var u,s,l=r[o],c=l.length,h=i[o]=new Array(c),f=0;f<c;++f)(u=l[f])&&(s=e.call(u,u.__data__,f,l))&&("__data__"in u&&(s.__data__=u.__data__),h[f]=s,xt(h[f],t,n,f,h,Bt(u,n)));return new er(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=V(e));for(var r=this._groups,a=r.length,i=[],o=[],u=0;u<a;++u)for(var s,l=r[u],c=l.length,h=0;h<c;++h)if(s=l[h]){for(var f,b=e.call(s,s.__data__,h,l),m=Bt(s,n),p=0,g=b.length;p<g;++p)(f=b[p])&&xt(f,t,n,p,b,m);i.push(b),o.push(s)}return new er(i,o,t,n)},filter:function(e){"function"!=typeof e&&(e=z(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],u=o.length,s=r[a]=[],l=0;l<u;++l)(i=o[l])&&e.call(i,i.__data__,l,o)&&s.push(i);return new er(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),u=0;u<i;++u)for(var s,l=t[u],c=n[u],h=l.length,f=o[u]=new Array(h),b=0;b<h;++b)(s=l[b]||c[b])&&(f[b]=s);for(;u<r;++u)o[u]=t[u];return new er(o,this._parents,this._name,this._id)},selection:function(){return new Xn(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=tr(),r=this._groups,a=r.length,i=0;i<a;++i)for(var o,u=r[i],s=u.length,l=0;l<s;++l)if(o=u[l]){var c=Bt(o,t);xt(o,e,n,l,u,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new er(r,this._parents,e,n)},call:nr.call,nodes:nr.nodes,node:nr.node,size:nr.size,empty:nr.empty,each:nr.each,on:function(e,t){var n=this._id;return arguments.length<2?Bt(this.node(),n).on.on(e):this.each(zn(n,e,t))},attr:function(e,t){var n=ue(e),r="transform"===n?It:Nn;return this.attrTween(e,"function"==typeof t?(n.local?Fn:qn)(n,r,Rt(this,"attr."+e,t)):null==t?(n.local?kn:Bn)(n):(n.local?Gn:Dn)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=ue(e);return this.tween(n,(r.local?In:Hn)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?Ot:Nn;return null==t?this.styleTween(e,function(e,t){var n,r,a;return function(){var i=ye(this,e),o=(this.style.removeProperty(e),ye(this,e));return i===o?null:i===n&&o===r?a:a=t(n=i,r=o)}}(e,r)).on("end.style."+e,Un(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,a,i;return function(){var o=ye(this,e),u=n(this),s=u+"";return null==u&&(this.style.removeProperty(e),s=u=ye(this,e)),o===s?null:o===r&&s===a?i:(a=s,i=t(r=o,u))}}(e,r,Rt(this,"style."+e,t))).each(function(e,t){var n,r,a,i,o="style."+t,u="end."+o;return function(){var s=Nt(this,e),l=s.on,c=null==s.value[o]?i||(i=Un(t)):void 0;l===n&&a===c||(r=(n=l).copy()).on(u,a=c),s.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,a,i=n+"";return function(){var o=ye(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,Jn(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Rt(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,Qn(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,a=Bt(this.node(),n).tween,i=0,o=a.length;i<o;++i)if((r=a[i]).name===e)return r.value;return null}return this.each((null==t?Ht:$t)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?$n:Rn)(t,e)):Bt(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Wn:jn)(t,e)):Bt(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(Vn(t,e)):Bt(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;Nt(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,a=n.size();return new Promise((function(i,o){var u={value:o},s={value:function(){0==--a&&i()}};n.each((function(){var n=Nt(this,r),a=n.on;a!==e&&((t=(e=a).copy())._.cancel.push(u),t._.interrupt.push(u),t._.end.push(s)),n.on=t})),0===a&&i()}))},[Symbol.iterator]:nr[Symbol.iterator]};var rr={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function ar(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}et.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,r,a,i=e.__transition,o=!0;if(i){for(a in t=null==t?null:t+"",i)(n=i[a]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[a]):o=!1;o&&delete e.__transition}}(this,e)}))},et.prototype.transition=function(e){var t,n;e instanceof er?(t=e._id,e=e._name):(t=tr(),(n=rr).time=yt(),e=null==e?null:e+"");for(var r=this._groups,a=r.length,i=0;i<a;++i)for(var o,u=r[i],s=u.length,l=0;l<s;++l)(o=u[l])&&xt(o,e,t,l,u,n||ar(o,t));return new er(r,this._parents,e,t)};const{abs:ir,max:or,min:ur}=Math;function sr(e){return{type:e}}["w","e"].map(sr),["n","s"].map(sr),["n","w","e","s","nw","ne","sw","se"].map(sr);const lr=Math.random,cr=function e(t){function n(e,n){return arguments.length<2&&(n=e,e=0),e=Math.floor(e),n=Math.floor(n)-e,function(){return Math.floor(t()*n+e)}}return n.source=e,n}(lr),hr=function e(t){function n(e,n){var r,a;return e=null==e?0:+e,n=null==n?1:+n,function(){var i;if(null!=r)i=r,r=null;else do{r=2*t()-1,i=2*t()-1,a=r*r+i*i}while(!a||a>1);return e+n*i*Math.sqrt(-2*Math.log(a)/a)}}return n.source=e,n}(lr);var fr=Math.sqrt(50),br=Math.sqrt(10),mr=Math.sqrt(2);function pr(e,t,n){var r=(t-e)/Math.max(0,n),a=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,a);return a>=0?(i>=fr?10:i>=br?5:i>=mr?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(i>=fr?10:i>=br?5:i>=mr?2:1)}function gr(e){let t=e,n=e;function r(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){const i=r+a>>>1;n(e[i],t)<0?r=i+1:a=i}return r}return 1===e.length&&(t=(t,n)=>e(t)-n,n=function(e){return(t,n)=>L(e(t),n)}(e)),{left:r,center:function(e,n,a,i){null==a&&(a=0),null==i&&(i=e.length);const o=r(e,n,a,i-1);return o>a&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){const i=r+a>>>1;n(e[i],t)>0?a=i:r=i+1}return r}}}const dr=gr(L),yr=dr.right,vr=(dr.left,gr((function(e){return null===e?NaN:+e})).center,yr);function wr(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=Pr(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}function Sr(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Mr(e,t){var n,r={},a={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Pr(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}function _r(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function Pr(e,t){var n,r,a=typeof t;return null==t||"boolean"===a?_n(t):("number"===a?kt:"string"===a?(n=sn(t))?(t=n,En):Cn:t instanceof sn?En:t instanceof Date?Sr:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?wr:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Mr:kt:_r))(e,t)}function Er(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Ar(e){return+e}var Tr=[0,1];function xr(e){return e}function Cr(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function Nr(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=Cr(a,r),i=n(o,i)):(r=Cr(r,a),i=n(i,o)),function(e){return i(r(e))}}function Br(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=Cr(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=vr(e,t,1,r)-1;return i[n](a[n](t))}}function kr(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Dr(){return function(){var e,t,n,r,a,i,o=Tr,u=Tr,s=Pr,l=xr;function c(){var e,t,n,s=Math.min(o.length,u.length);return l!==xr&&(e=o[0],t=o[s-1],e>t&&(n=e,e=t,t=n),l=function(n){return Math.max(e,Math.min(t,n))}),r=s>2?Br:Nr,a=i=null,h}function h(t){return isNaN(t=+t)?n:(a||(a=r(o.map(e),u,s)))(e(l(t)))}return h.invert=function(n){return l(t((i||(i=r(u,o.map(e),kt)))(n)))},h.domain=function(e){return arguments.length?(o=Array.from(e,Ar),c()):o.slice()},h.range=function(e){return arguments.length?(u=Array.from(e),c()):u.slice()},h.rangeRound=function(e){return u=Array.from(e),s=Er,c()},h.clamp=function(e){return arguments.length?(l=!!e||xr,c()):l!==xr},h.interpolate=function(e){return arguments.length?(s=e,c()):s},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,c()}}()(xr,xr)}function Gr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var qr,Fr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Lr(e){if(!(t=Fr.exec(e)))throw new Error("invalid format: "+e);var t;return new Or({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Or(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Ir(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Hr(e){return(e=Ir(Math.abs(e)))?e[1]:NaN}function $r(e,t){var n=Ir(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}Lr.prototype=Or.prototype,Or.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Rr={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>$r(100*e,t),r:$r,s:function(e,t){var n=Ir(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(qr=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Ir(e,Math.max(0,t+i-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Wr(e){return e}var jr,Vr,zr,Xr=Array.prototype.map,Ur=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Yr(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){var r,a,i,o,u=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),0===(o=pr(e,t,n))||!isFinite(o))return[];if(o>0)for(e=Math.ceil(e/o),t=Math.floor(t/o),i=new Array(a=Math.ceil(t-e+1));++u<a;)i[u]=(e+u)*o;else for(o=-o,e=Math.ceil(e*o),t=Math.floor(t*o),i=new Array(a=Math.ceil(t-e+1));++u<a;)i[u]=(e+u)/o;return r&&i.reverse(),i}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return function(e,t,n,r){var a,i=function(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=fr?a*=10:i>=br?a*=5:i>=mr&&(a*=2),t<e?-a:a}(e,t,n);switch((r=Lr(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Hr(t)/3)))-Hr(Math.abs(e)))}(i,o))||(r.precision=a),zr(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Hr(t)-Hr(e))+1}(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=function(e){return Math.max(0,-Hr(Math.abs(e)))}(i))||(r.precision=a-2*("%"===r.type))}return Vr(r)}(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,u=i.length-1,s=i[o],l=i[u],c=10;for(l<s&&(a=s,s=l,l=a,a=o,o=u,u=a);c-- >0;){if((a=pr(s,l,n))===r)return i[o]=s,i[u]=l,t(i);if(a>0)s=Math.floor(s/a)*a,l=Math.ceil(l/a)*a;else{if(!(a<0))break;s=Math.ceil(s*a)/a,l=Math.floor(l*a)/a}r=a}return e},e}function Jr(){var e=Dr();return e.copy=function(){return kr(e,Jr())},Gr.apply(e,arguments),Yr(e)}function Kr(e,t,n){this.k=e,this.x=t,this.y=n}function Qr(e,t){return Math.random()*(t-e)+e}function Zr(e){return e[cr(0,e.length)()]}function ea(e,t,n){return Math.max(t,Math.min(n,e))}function ta(e,t){return e<=t?[e,t]:[t,e]}function na(e,t=!1){if(e.length<=1)return[];if(2===e.length)return e[0]>e[1]?[0]:e[1]>e[0]?[1]:[];const n=[];e[0]>e[1]&&n.push(0);let r=e[0],a=e[1];for(let t=1;t<e.length-1;t++){let i=e[t+1];a>r&&a>i&&n.push(t),r=a,a=i}const i=e.length-1;return e[i]>e[i-1]&&n.push(e.length-1),n}function ra(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function aa(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}jr=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Wr:(t=Xr.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,u=t[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(e.substring(a-=u,a+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",u=void 0===e.numerals?Wr:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Xr.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"−":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Lr(e)).fill,n=e.align,h=e.sign,f=e.symbol,b=e.zero,m=e.width,p=e.comma,g=e.precision,d=e.trim,y=e.type;"n"===y?(p=!0,y="g"):Rr[y]||(void 0===g&&(g=12),d=!0,y="g"),(b||"0"===t&&"="===n)&&(b=!0,t="0",n="=");var v="$"===f?a:"#"===f&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",w="$"===f?i:/[%p]/.test(y)?s:"",S=Rr[y],M=/[defgprs%]/.test(y);function _(e){var a,i,s,f=v,_=w;if("c"===y)_=S(e)+_,e="";else{var P=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:S(Math.abs(e),g),d&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),P&&0==+e&&"+"!==h&&(P=!1),f=(P?"("===h?h:l:"-"===h||"("===h?"":h)+f,_=("s"===y?Ur[8+qr/3]:"")+_+(P&&"("===h?")":""),M)for(a=-1,i=e.length;++a<i;)if(48>(s=e.charCodeAt(a))||s>57){_=(46===s?o+e.slice(a+1):e.slice(a))+_,e=e.slice(0,a);break}}p&&!b&&(e=r(e,1/0));var E=f.length+e.length+_.length,A=E<m?new Array(m-E+1).join(t):"";switch(p&&b&&(e=r(A+e,A.length?m-_.length:1/0),A=""),n){case"<":e=f+e+_+A;break;case"=":e=f+A+e+_;break;case"^":e=A.slice(0,E=A.length>>1)+f+e+_+A.slice(E);break;default:e=A+f+e+_}return u(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return e+""},_}return{format:h,formatPrefix:function(e,t){var n=h(((e=Lr(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Hr(t)/3))),a=Math.pow(10,-r),i=Ur[8+r/3];return function(e){return n(a*e)+i}}}}({thousands:",",grouping:[3],currency:["$",""]}),Vr=jr.format,zr=jr.formatPrefix,Kr.prototype={constructor:Kr,scale:function(e){return 1===e?this:new Kr(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Kr(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Kr(1,0,0),Kr.prototype;var ia=new WeakMap;class oa{constructor(e=[]){ia.set(this,{writable:!0,value:void 0}),aa(this,ia,e.map((e=>void 0!==e.string&&void 0!==e.fret?N.from(e):C.from(e))))}getNotes(){return ra(this,ia)}addNotes(e,t=!0){return aa(this,ia,ra(this,ia).concat(e)),t&&this.sortByTime(),this}concat(e){return aa(this,ia,ra(this,ia).concat(ra(e,ia))),this}append(e,t=0){const n=this.getDuration(),r=e.clone();return r.shiftTime(n+t),aa(this,ia,ra(this,ia).concat(ra(r,ia))),this.sortByTime(),this}repeat(e){const t=this.clone(),n=this.clone(),r=this.getDuration();if(e<2)return t;for(let a=1;a<e;a++)n.shiftTime(r),t.concat(n);return t}length(){return ra(this,ia).length}getStartTime(){return F(ra(this,ia),(e=>e.start))}getDuration(){let e=0;for(let t of ra(this,ia)){const n=null===t.end?t.start:t.end;n>e&&(e=n)}return e}scaleTime(e){return aa(this,ia,ra(this,ia).map((t=>t.scaleTime(e)))),this}shiftTime(e){return aa(this,ia,ra(this,ia).map((t=>t.shiftTime(e)))),this}shiftToStartAt(e){this.sortByTime();const t=ra(this,ia)[0].start-e;return ra(this,ia).forEach((e=>{e.start-=t,null!==e.end&&(e.end-=t)})),this}forEach(e){return ra(this,ia).forEach(e),this}sort(e){return aa(this,ia,ra(this,ia).sort(e)),this}sortByTime(){return aa(this,ia,ra(this,ia).sort(((e,t)=>e.start-t.start))),this}map(e){return aa(this,ia,ra(this,ia).map(e)),this}slice(e,t){return aa(this,ia,ra(this,ia).slice(e,t)),this}sliceTime(e,t,n="contained"){const r=e,a=t;return"start"===n&&aa(this,ia,ra(this,ia).filter((e=>e.start>=r&&e.start<a))),"end"===n&&aa(this,ia,ra(this,ia).filter((e=>e.end>=r&&e.end<a))),"contained"===n&&aa(this,ia,ra(this,ia).filter((e=>null===e.end?e=>e.start>=r&&e.start<a:e=>e.start>=r&&e.end<a))),this}filter(e){return aa(this,ia,ra(this,ia).filter(e)),this}filterPitches(e){return aa(this,ia,ra(this,ia).filter((t=>e.includes(t.pitch)))),this}transpose(e){for(let t of ra(this,ia))t.pitch=ea(t.pitch+e,0,127);return this}reverse(){const e=this.getDuration();for(let t of ra(this,ia))t.start=e-t.end,t.end=e-t.start;return this.sortByTime(),this}equals(e){if(!(e instanceof oa))return!1;const t=e.getNotes();if(ra(this,ia).length!==t.length)return!1;for(let e=0;e<t.length;e++)if(!ra(this,ia)[e].equals(t[e]))return!1;return!0}clone(){return new oa(ra(this,ia))}}function ua(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function sa(e){return Array.from(new Set(e))}function la(e,t){if(e.length<t.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0}function ca(e){return[].concat(...e)}function ha(e){let t=-1/0;for(let n of e){const e=Math.max(...n);e>t&&(t=e)}return t}function fa(e,t=", ",n="\n",r){r&&(e=e.map((e=>e.map((e=>r(e)))))),console.log(e.map((e=>e.join(t))).join(n))}function ba(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}var ma=new WeakMap;class pa extends oa{constructor(e,t,n,r=1,a=0,i=null){super(n),ma.set(this,{writable:!0,value:void 0}),this.name=e,this.date=t,this.dateString=t.toISOString().substring(0,19).replace("T"," "),this.speed=+r,this.selectedTrack=+a,this.timeSelection=i,this.sortByTime()}clone(){return new pa(this.name,this.date,this.getNotes().map((e=>e.clone())),this.speed,this.selectedTrack,null===this.timeSelection?null:[...this.timeSelection])}equals(e){if(!(e instanceof pa))return!1;if(this.name!==e.name)return!1;if(this.date.getTime()!==e.date.getTime())return!1;if(this.speed!==e.speed)return!1;if(this.selectedTrack!==e.selectedTrack)return!1;if(this.timeSelection!==e.timeSelection)return null!==this.timeSelection&&null!==e.timeSelection&&ua(this.timeSelection,e.timeSelection);const t=e.getNotes();if(ba(this,ma).length!==t.length)return!1;for(let e=0;e<t.length;e++)if(!ba(this,ma)[e].equals(t[e]))return!1;return!0}toSimpleObject(){return{name:this.name,date:this.date,notes:this.getNotes(),speed:this.speed,selectedTrack:this.selectedTrack,timeSelection:this.timeSelection}}static from(e){let{name:t,date:n,notes:r}=e;const a=[t,n,r],i=["name","date","notes"];for(let e=0;e<a.length;e++)if(null==a[e])return console.error(`Cannot create Recording with undefined ${i[e]}`),null;return"string"==typeof n&&(n=new Date(Date.parse(n))),new pa(t,n,r,e.speed,e.selectedTrack,e.timeSelection)}}function ga(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}function da(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}var ya=new WeakMap,va=new WeakMap,wa=new WeakMap,Sa=new WeakMap,Ma=new WeakMap,_a=new WeakMap,Pa=new WeakMap,Ea=new WeakMap;class Aa{constructor(){ya.set(this,{writable:!0,value:!1}),va.set(this,{writable:!0,value:null}),wa.set(this,{writable:!0,value:null}),Sa.set(this,{writable:!0,value:4}),Ma.set(this,{writable:!0,value:4}),_a.set(this,{writable:!0,value:null}),Pa.set(this,{writable:!0,value:null}),Ea.set(this,{writable:!0,value:new AudioContext}),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_scheduler",(()=>{const e=da(this,Sa),t=60/da(this,wa);let n=da(this,_a)+da(this,Pa)*t;for(;n<da(this,Ea).currentTime+.1;){n+=t;const r=da(this,Pa)%e==0?440:220;this._playSound(n,r,.1),ga(this,Pa,+da(this,Pa)+1)}ga(this,va,setTimeout(this._scheduler,50))}))}get bpm(){return da(this,wa)}get beatCount(){return da(this,Pa)}start(e,t="4/4"){if(!e||isNaN(+e))return void console.error(`[Metronome] Invalid bpm ${e}`);const n=t.split("/");2!==n.length||isNaN(+n[0]||isNaN(+n[1]))?(console.error(`[Metronome] Invalid beatType ${t}, using 4/4 instead`),ga(this,Sa,4),ga(this,Ma,4)):(ga(this,Sa,+n[0]),ga(this,Ma,+n[1])),console.log(`Metronome @ ${e}bpm, ${da(this,Sa)}/${da(this,Ma)}`),"suspended"===da(this,Ea).state&&da(this,Ea).resume(),ga(this,wa,e),ga(this,ya,!0),ga(this,Pa,0),ga(this,_a,da(this,Ea).currentTime),this._scheduler()}stop(){console.log("Metronome stopped"),clearTimeout(da(this,va)),ga(this,ya,!1)}toggle(e,t="4/4"){da(this,ya)?this.stop():(void 0===e&&(e=da(this,wa)),this.start(e,t))}peep(){"suspended"===da(this,Ea).state&&da(this,Ea).resume();const e=da(this,Ea).createOscillator();e.connect(da(this,Ea).destination),e.frequency.value=440,e.start(da(this,Ea).currentTime),e.stop(da(this,Ea).currentTime+.1)}_playSound(e,t,n){const r=da(this,Ea).createOscillator();r.connect(da(this,Ea).destination),r.frequency.value=t,r.start(e),r.stop(e+n)}}var Ta=n(346),xa=n.n(Ta);function Ca(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Na(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function Ba(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}var ka=new WeakMap,Da=new WeakMap,Ga=new WeakMap,qa=new WeakMap,Fa=new WeakMap,La=new WeakMap,Oa=new WeakMap,Ia=new WeakMap,Ha=new WeakMap,$a=new WeakMap,Ra=new WeakMap,Wa=new WeakMap,ja=new WeakMap,Va=new WeakMap,za=new WeakMap,Xa=new WeakMap,Ua=new WeakMap,Ya=new WeakMap,Ja=new WeakMap,Ka=new WeakMap;class Qa{constructor(e){ka.set(this,{writable:!0,value:null}),Da.set(this,{writable:!0,value:null}),Ga.set(this,{writable:!0,value:null}),qa.set(this,{writable:!0,value:null}),Fa.set(this,{writable:!0,value:1}),La.set(this,{writable:!0,value:null}),Oa.set(this,{writable:!0,value:!1}),Ca(this,"currentPlayTime",null),Ia.set(this,{writable:!0,value:null}),Ha.set(this,{writable:!0,value:new AudioContext}),$a.set(this,{writable:!0,value:null}),Ra.set(this,{writable:!0,value:null}),Wa.set(this,{writable:!0,value:0}),ja.set(this,{writable:!0,value:-1}),Va.set(this,{writable:!0,value:[]}),za.set(this,{writable:!0,value:[]}),Xa.set(this,{writable:!0,value:null}),Ua.set(this,{writable:!0,value:!1}),Ya.set(this,{writable:!0,value:!1}),Ja.set(this,{writable:!0,value:null}),Ka.set(this,{writable:!0,value:new Map([["acoustic_grand_piano",{name:"acoustic_grand_piano",desciption:"Acoustic grand piano"}],["acoustic_guitar_nylon",{name:"acoustic_guitar_nylon",desciption:"Acoustic guitar nylon"}],["acoustic_guitar_steel",{name:"acoustic_guitar_steel",desciption:"Acoustic guitar steel"}],["distortion_guitar",{name:"distortion_guitar",desciption:"Distortion guitar"}],["electric_bass_finger",{name:"electric_bass_finger",desciption:"Electric bass finger"}],["electric_bass_pick",{name:"electric_bass_pick",desciption:"Electric bass pick"}],["electric_guitar_clean",{name:"electric_guitar_clean",desciption:"Electric guitar clean"}],["electric_guitar_muted",{name:"electric_guitar_muted",desciption:"Electric guitar muted"}],["overdriven_guitar",{name:"overdriven_guitar",desciption:"Overdriven guitar"}],["percussion",{name:"percussion",desciption:"Percussion",font:"FluidR3_GM"}]])}),Ca(this,"onTimeChange",(e=>(Ba(this,Da,e),this))),Ca(this,"onStop",(e=>(Ba(this,Ga,e),this))),Ca(this,"getAvailableInstruments",(()=>Array.from(Na(this,Ka).values()))),Ca(this,"setVolume",(e=>(Ba(this,Fa,e),this))),Ca(this,"setLogging",(e=>(Ba(this,Oa,e),this))),Ca(this,"isPlaying",(()=>Na(this,Ua))),Ca(this,"isPaused",(()=>Na(this,Ya))),Ca(this,"playNotes",((e,t="piano",n=0,r=-1,a=1)=>{Na(this,Ua)&&!Na(this,Ya)&&this.stop(),e&&0!==e.length?Na(this,Ka).has(t)?(Ba(this,Va,e.slice()),e=new oa(e).sortByTime(),Ba(this,Xa,e.getDuration()),n>0&&(e=e.filter((e=>e.start>=n)).shiftTime(-n),console.log(`[Player] Will start at ${n.toFixed(2)} seconds with ${e.length()} notes left`)),1!==a&&a>0&&(e=e.scaleTime(1/a),Ba(this,Xa,Na(this,Xa)/a)),e=e.getNotes(),console.log(`[Player] Playing ${e.length} notes with '${t}', speed ${a}, and volume ${Na(this,Fa)}`),"suspended"===Na(this,Ha).state&&Na(this,Ha).resume(),Ba(this,qa,t),Ba(this,Wa,n),Ba(this,ja,r),Ba(this,La,a),Ba(this,za,e.slice()),t===Na(this,Ja)?this._start():this.preloadInstrument(t).then(this._start)):console.error(`[Player] Sound ${t} is not supported!`):console.warn("[PLAYER] Was called with no data")})),Ca(this,"_start",(()=>{console.log("[Player] Starting"),Ba(this,Ua,!0),Ba(this,Ya,!1),Ba(this,Ra,Na(this,Ha).currentTime),this._scheduler()})),Ca(this,"_updateTime",(e=>{const t=(e-Na(this,Ra))*Na(this,La)+Na(this,Wa);this.currentPlayTime=t,Na(this,Da)&&Na(this,Da).call(this,t)})),Ca(this,"_playNote",((e,t)=>{const n=e.getDuration();Na(this,Oa)&&console.log(`[Player] Playing ${e.getName()} for ${n}s`);try{Na(this,Ia).play(e.pitch,t,{duration:n})}catch(t){console.error("[Player] Error for note",e,t)}})),Ca(this,"_scheduler",(()=>{const e=Na(this,Ha).currentTime;for(this._updateTime(e);Na(this,za).length>0;){const t=Na(this,Ra)+Na(this,za)[0].start;if(t>e+.1)break;const n=Na(this,za).shift();this._playNote(n,t)}const t=e-Na(this,Ra)+Na(this,Wa),n=(Na(this,ja)-Na(this,Wa))/Na(this,La)+Na(this,Wa);-1!==Na(this,ja)&&t>=n||t>=Na(this,Xa)?this.stop():Ba(this,$a,setTimeout(this._scheduler,33))})),Ca(this,"stop",((e=!0)=>{if(Na(this,Ua))return console.log("[Player] Stopping player"),clearTimeout(Na(this,$a)),this.currentPlayTime=null,Ba(this,Ua,!1),Ba(this,Ya,!1),Ba(this,Va,[]),Ba(this,za,[]),Na(this,Da)&&Na(this,Da).call(this,null),e&&Na(this,Ga)&&Na(this,Ga).call(this),this})),Ca(this,"pause",(()=>(console.log("[Player] Pausing player"),clearTimeout(Na(this,$a)),Ba(this,Ya,!0),this))),Ca(this,"resume",(()=>{if(console.log("[Player] Resuming player"),Na(this,za)&&0!==Na(this,za).length)return this.playNotes(Na(this,Va),Na(this,qa),this.currentPlayTime,Na(this,ja),Na(this,La)),this;console.warn("[Player] Cannot resume player since it has not been started!")})),Ca(this,"pauseOrResume",(()=>{if(Na(this,Ua))return Na(this,Ya)?this.resume():this.pause(),this;console.warn("[Player] Cannot pause / resume when player is not playing!")})),Ba(this,ka,e)}async preloadInstrument(e){Na(this,Ka).has(e)||console.warn(`[Player] Invalid sound ${e}`),console.log(`[Player] Loading soundfont ${e}`);const t={soundfont:Na(this,Ka).get(e).font||"FluidR3_GM",gain:Na(this,Fa)},n=await xa().instrument(Na(this,Ha),e,t);Ba(this,Ja,e),Ba(this,Ia,n),console.log(`[Player] Finished loading soundfont ${e}`)}}function Za(e){return 1/(e/60)}function ei(e){const t=new Map;return e.forEach(((e,n)=>{t.set(n,{...e})})),t}function ti(e){return D(ca(e),(e=>e.pitch))}function ni(e){Array.from(D(e,(e=>e.start))).sort(((e,t)=>e.start-t.start))}function ri(e){return e.sort(((e,t)=>e.start===t.start?e.pitch-t.pitch:e.start-t.start)).map((e=>e.pitch))}function ai(e){const t=ri(e);return String.fromCharCode(...t)}function ii(e){return e.split("").reverse().join("")}function oi(e){const t=new Array(e.length-1);for(let n=1;n<e.length;n++)t.push(e[n]-e[n-1]);return t}function ui(e,t){let n=null,r=1/0;const a=t.start;for(let t of e){const e=Math.abs(t.start-a);e<r&&(r=e,n=t)}return n}function si(e,t=!0){if(null==e)return void console.warn("[MidiParser] MIDI data is null");if(!e.track)return void console.error("[MidiParser] MIDI data has no track");console.groupCollapsed("[MidiParser] Preprocessing MIDI file data");let n=[];const r=[],{tempoChanges:a,beatTypeChanges:i}=function(e){const t=[],n=[];let r=0;for(let a of e)for(let e of a.event){if(r+=e.deltaTime,255===e.type&&81===e.metaType){const n=e.data/1e3,a=Math.round(1/(n/6e4));t.push({tick:r,tempo:a})}if(255===e.type&&88===e.metaType){const t=e.data,a=t[0],i=Math.pow(2,t[1]);n.push({tick:r,beats:a,beatType:i})}}return 0===t.length&&t.push({tempo:120,time:0}),0===n.length&&n.push({beats:4,beatType:4,time:0}),{tempoChanges:t,beatTypeChanges:n}}(e.track);for(let t=0;t<e.track.length;t++){const o=e.track[t],u=li(o,e.timeDivision,a,i);if(null!==u){n.push(u);let e=ci(o.event);r.push(e||`Track ${t}`)}}0===e.formatType&&t&&n.length>0&&(n=function(e){e.length>1&&console.warn("Splitting a format 0 file with more than 1 track will result in all but the first beeing lost!"),console.log("Splitting format 0 file into tracks based on channel");const t=D(e[0].noteObjs,(e=>e.channel)),n=[];return t.forEach(((t,r)=>{n[r]={...e[0],noteObjs:t}})),n}(n));const o={parts:n,partNames:r,instruments:null,totalTime:G(n,(e=>e.totalTime)),bpm:n[0].bpm,beats:n[0].beats,beatType:n[0].beatType};return console.log(`Got ${n.length} MIDI tracks`,o),console.groupEnd(),o}function li(e,t,n,r){const a=[];let i,o=n.length>0?n[0].tempo:120,u=0,s=hi(o,t),l=0,c=0;for(let h of e.event){let e;u+=h.deltaTime;for(let e of r)void 0===e.time&&e.tick<=u&&(e.time=(e.tick-l)*s/1e3+c);n.length>0&&u>n[n.length-1].tick&&(e=n[n.length-1]);for(let t=1;t<n.length;t++)if(n[t].tick>u){e=n[t-1];break}if(e&&e.tempo!==o){const n=e.tick;c=(n-l)*s/1e3+c,l=n,e.time=c,o=e.tempo,s=hi(o,t)}i=(u-l)*s/1e3+c;const f=h.type;if(8!==f&&9!==f)continue;const[b,m]=h.data,p=h.channel;if(i=+i.toFixed(10),8===h.type||0===m){if(0===a.length)continue;let e=a.length-1;for(;a[e].pitch!==b||a[e].channel!==p||-1!==a[e].end;)if(e--,e<0){console.warn("Did not find note-on event for note-off event!");break}e>=0&&(a[e].end=i)}else a.push(new C(b,i,m,p,-1))}for(let e of a)-1===e.end&&(e.end=i);const h=function(e,t,n){const r=[];let a=120,i=4,o=Za(a),u=0,s=0,l=0,c=0;for(;u<n;){let n;for(const t of e)t.time<=u&&(n=t.tempo);n&&n!==a&&(l=u,c=0,a=n,o=Za(a));for(const e of t)e.time<=u&&(i=e.beats);s++,c+=o,u=l+c,s>=i&&(s=0,r.push(u))}return r}(n,r,i);if(a.length>0){var f,b,m;const e={noteObjs:a,totalTime:i,tempoChanges:n,beatTypeChanges:r,measureLinePositions:h,bpm:(null===(f=n[0])||void 0===f?void 0:f.tempo)||120,beats:(null===(b=r[0])||void 0===b?void 0:b.beats)||4,beatType:(null===(m=r[0])||void 0===m?void 0:m.beatType)||4};return console.log(`Got part with ${a.length} notes,\n`,e),e}return null}function ci(e){for(let t of e)if(255===t.type&&3===t.metaType)return t.data;return null}function hi(e,t){return 1/e*6e4/t}function fi(e){console.groupCollapsed("[MusicXmlParser] Parsing MusicXML"),console.log(e);const t=e.getElementsByTagName("part-name"),n=e.getElementsByTagName("score-instrument"),r=[],a=[];for(let e of t)r.push(e.innerHTML);for(let e of n)a.push(e.children[0].innerHTML);const i=e.getElementsByTagName("part");let o=[];for(let e=0;e<i.length;e++){const t=i[e].children;o.push(bi(t))}return console.groupEnd(),{parts:o,partNames:r,instruments:a,totalTime:G(o,(e=>e.totalTime)),bpm:o[0].bpm,beats:o[0].beats,beatType:o[0].beatType}}function bi(e){var t;e=function(e){let t=[],n=[];for(let r=0;r<e.length;r++){const a=e[r],i=a.getElementsByTagName("repeat");if(2===i.length){const e=i[1].getAttribute("times")||2,r=new Array(+e).fill(a);0===n.length?t=t.concat(r):n=n.concat(r)}else if(1===i.length){const e=i[0].getAttribute("direction");if("forward"===e)n.push(a);else if("backward"===e){const e=i[0].getAttribute("times")||2;if(n.length>0){n.push(a);for(let r=0;r<e;r++)t=t.concat(n);n=[]}else t=t.concat(t)}}else 0===n.length?t.push(a):n.push(a)}return t}(e);let n,r=0,a=120,i=4,o=4;const u=[],s=[],l=[],c=[];for(let t of e){try{const e=t.getElementsByTagName("sound");for(let t of e){const e=t.getAttribute("tempo");null!==e&&(a=+e,u.push({time:r,tempo:a}));break}}catch(e){}try{n=+t.getElementsByTagName("divisions")[0].innerHTML}catch(e){}try{i=+t.getElementsByTagName("beats")[0].innerHTML,o=+t.getElementsByTagName("beat-type")[0].innerHTML,s.push({time:r,beats:i,beatType:o})}catch(e){}const e=1/(a/60),h=t.getElementsByTagName("note");let f=0;for(let t of h)try{const a=+t.getElementsByTagName("duration")[0].innerHTML/n*e;if(0!==t.getElementsByTagName("rest").length){r+=a;continue}const i=p(t.getElementsByTagName("step")[0].innerHTML,+t.getElementsByTagName("octave")[0].innerHTML).pitch;t.getElementsByTagName("chord").length>0&&(r-=f);const o=t.getElementsByTagName("tie")[0];if(o&&"stop"===o.getAttribute("type")){let e=r+a;for(let t=l.length-1;t>0;t--){const n=l[t];if(n.pitch===i){n.end=e;break}}}else{let e=null,n=null;try{n=+t.getElementsByTagName("fret")[0].innerHTML,e=+t.getElementsByTagName("string")[0].innerHTML}catch(e){}null!==e&&null!==n?l.push(new N(i,r,127,e,r+a,e,n)):l.push(new C(i,r,127,e,r+a))}f=a,r+=a}catch(e){console.warn("[MusicXmlParser] Cannot parse MusicXML note"),console.warn(e),console.log(t)}c.push(r)}0===u.length&&u.push({tempo:120,time:0}),0===s.length&&s.push({beats:4,beatType:4,time:0});const h={noteObjs:l,totalTime:r,measureLinePositions:c,tempoChanges:u,beatTypeChanges:s,bpm:(null===(t=u[0])||void 0===t?void 0:t.tempo)||120,beats:s[0].beats,beatType:s[0].beatType,tuning:mi(e)};return console.log("[MusicXmlParser] Parsed part: ",h),h}function mi(e){for(let t of e)try{let e=[];const n=t.getElementsByTagName("staff-tuning");for(let t of n){let n=t.getElementsByTagName("tuning-step")[0].innerHTML,r=+t.getElementsByTagName("tuning-octave")[0].innerHTML;e.push(p(n,r).pitch)}return e}catch(e){}return[]}const pi=()=>new Promise((async e=>{let t;try{t=await navigator.mediaDevices.getUserMedia({audio:!0})}catch(e){return void console.warn("[AudioInput] Cannot access audio",e)}const n=new MediaRecorder(t,{audioBitsPerSecond:256e3});let r=[];n.addEventListener("dataavailable",(e=>{r.push(e.data)})),e({start:()=>{n?"recording"!==n.state&&(console.log(`[AudioInput] Recording @ ${n.audioBitsPerSecond} b/s`),r=[],n.start()):console.warn("[AudioInput] Cannot record audio, no microphone?")},stop:()=>new Promise((e=>{n&&(console.log("[AudioInput] Stopping audio recording"),n.addEventListener("stop",(()=>{const t={type:n.mimeType},a=new Blob(r,t);e(a)})),n.stop())}))})})),gi=()=>new Promise((async e=>{let t;try{t=await navigator.requestMIDIAccess()}catch(e){return void console.warn("[MidiInput] Cannot access MIDI",e)}let n=[];const r=e=>n.push(e);e({start:()=>{if(t){for(let e of t.inputs.values())e.onmidimessage=r;console.log("[MidiInput] Starting recording"),n=[]}else console.warn("[MidiInput] Cannot record MIDI")},stop:()=>{if(t)return console.log("[MidiInput] Stopping recording"),function(e){const t=new Map,n=[];for(let r of e){const e=r.target.name,a=r.timeStamp,i=r.data[0],o=i%16,u=i-o,s=r.data[1],l=r.data.length>2?r.data[2]:0;switch(u){case 128:yi(n,t,e,a,s,o);break;case 144:l>0?di(t,e,a,s,o,l):yi(n,t,e,a,s,o)}}return t.size>0&&console.warn(`[MidiInput] Got ${t.size} unfinished notes`),n.sort(((e,t)=>e.start-t.start)),n}(n)}})}));function di(e,t,n,r,a,i){const o=new C(r,n/1e3,i,a),u=`${t}-${a}-${r}`;e.set(u,o)}function yi(e,t,n,r,a,i){const o=`${n}-${i}-${a}`;if(!t.has(o))return void console.warn(`[MidiInput] Missing note-on for note-off with key ${o}`);const u=t.get(o);u.end=r/1e3,e.push(u),t.delete(o)}function vi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wi(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function Si(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}var Mi=new WeakMap,_i=new WeakMap,Pi=new WeakMap,Ei=new WeakMap;class Ai{constructor(e,t,n=(()=>{}),r=(()=>{})){Mi.set(this,{writable:!0,value:void 0}),_i.set(this,{writable:!0,value:void 0}),Pi.set(this,{writable:!0,value:void 0}),Ei.set(this,{writable:!0,value:void 0}),vi(this,"_onMIDISuccess",(e=>{console.groupCollapsed(`[MidiInput] ${e.inputs.size} input devices`);for(let t of e.inputs.values())console.log(` - ${t.name}`),t.onmidimessage=this._handleMIDIMessage;console.groupEnd()})),vi(this,"_handleMIDIMessage",(e=>{const t=e.target.name,n=e.data[0],r=n%16,a=n-r,i=e.timeStamp,o=e.data[1],u=e.data.length>2?e.data[2]:0;switch(a){case 128:this._noteOff(t,i,o,r);break;case 144:u>0?this._noteOn(t,i,o,r,u):this._noteOff(t,i,o,r)}})),Si(this,Mi,e),Si(this,_i,t),Si(this,Pi,n),Si(this,Ei,r),navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(this._onMIDISuccess,this._onMIDIFailure):(console.error("[MidiInput] WebMIDI is not supported in this browser."),alert("You browser does not support WebMIDI"))}_onMIDIFailure(e){console.error("[MidiInput] Cannot access MIDI devices.",e)}_noteOn(e,t,n,r,a){const i=new C(n,t/1e3,a,r);wi(this,Pi).call(this,i);let o=wi(this,Mi).call(this);o=o.concat([i]),wi(this,_i).call(this,o)}_noteOff(e,t,n,r){const a=wi(this,Mi).call(this);0===a.length&&setTimeout((()=>this._noteOff(t,n)),10);let i=a.length-1;for(;a[i].pitch!==n||a[i].channel!==r;)if(i--,i<0){console.warn("[MidiInput] Did not find note-on event for note-off event!");break}i>=0&&(a[i].end=t/1e3,wi(this,_i).call(this,a),wi(this,Ei).call(this,n))}}const Ti=new Map([[49,{repPitch:49,zone:1,order:10,line:-1,shape:"o",label:"CC1",name:"Crash Cymbal 1"}],[55,{repPitch:49,zone:2,order:11,line:-1,shape:"o",label:"CC1",name:"Crash Cymbal 1"}],[52,{repPitch:57,zone:1,order:20,line:0,shape:"o",label:"CC2",name:"Crash Cymbal 2"}],[57,{repPitch:57,zone:2,order:21,line:0,shape:"o",label:"CC2",name:"Crash Cymbal 2"}],[22,{repPitch:46,zone:1,order:30,line:0,shape:"<>",label:"HHS",name:"Hi-Hat"}],[26,{repPitch:46,zone:2,order:31,line:0,shape:"<>",label:"HHS",name:"Hi-Hat"}],[42,{repPitch:46,zone:3,order:32,line:0,shape:"<>",label:"HHS",name:"Hi-Hat"}],[46,{repPitch:46,zone:4,order:33,line:0,shape:"<>",label:"HHS",name:"Hi-Hat"}],[44,{repPitch:44,zone:1,order:40,line:9,shape:"o",label:"HHP",name:"Hi-Hat Pedal"}],[51,{repPitch:51,zone:1,order:50,line:1,shape:"x",label:"Rd",name:"Ride Cymbal"}],[53,{repPitch:51,zone:2,order:51,line:1,shape:"x",label:"Rd",name:"Ride Cymbal"}],[59,{repPitch:51,zone:3,order:52,line:1,shape:"x",label:"Rd",name:"Ride Cymbal"}],[38,{repPitch:38,zone:1,order:60,line:4,shape:"o",label:"SN",name:"Snare"}],[40,{repPitch:38,zone:2,order:61,line:4,shape:"o",label:"SN",name:"Snare"}],[48,{repPitch:48,zone:1,order:90,line:2,shape:"o",label:"T1",name:"Tom 1"}],[50,{repPitch:48,zone:2,order:91,line:2,shape:"o",label:"T1",name:"Tom 1"}],[45,{repPitch:45,zone:1,order:100,line:3,shape:"o",label:"T2",name:"Tom 2"}],[47,{repPitch:45,zone:2,order:101,line:3,shape:"o",label:"T2",name:"Tom 2"}],[43,{repPitch:43,zone:1,order:70,line:5,shape:"o",label:"ST1",name:"Stand Tom 1"}],[58,{repPitch:43,zone:2,order:71,line:5,shape:"o",label:"ST1",name:"Stand Tom 1"}],[39,{repPitch:41,zone:1,order:80,line:6,shape:"o",label:"ST2",name:"Stand Tom 2"}],[41,{repPitch:41,zone:2,order:81,line:6,shape:"o",label:"ST2",name:"Stand Tom 2"}],[35,{repPitch:36,zone:1,order:110,line:8,shape:"o",label:"BD",name:"Bass Drum"}],[36,{repPitch:36,zone:2,order:111,line:8,shape:"o",label:"BD",name:"Bass Drum"}],[58,{repPitch:36,zone:3,order:112,line:8,shape:"o",label:"BD",name:"Bass Drum"}]]);function xi(e,t=1,n=.1,r=.1){const a=new Set;for(let t of e)a.add(t.pitch);const i=Array.from(a),o=cr(15,128),u=hr(0,t),s=[];for(let t of e)try{if(Qr(0,1)<n){const e=t.start+Qr(0,1),n=e+Qr(0,1),r=o(),a=Zr(i);s.push(new C(a,e,r,0,n))}if(Qr(0,1)<r);else{const e=t.start+u(),n=t.end+u(),r=C.from(t);r.start=Math.min(e,n),r.end=Math.max(e,n),s.push(r)}}catch(e){console.warn(e)}return s.sort(((e,t)=>e.start-t.start)),s}function Ci(e,t){if(!t)return console.error("Data.simplifyDrumPitches: No replacement map given!"),e;const n=new Set,r=e.map((e=>{const r=e.pitch;let a=r;t.has(r)?a=t.get(r).repPitch:n.add(r);const i=C.from(e);return i.pitch=a,i}));return n.size>0&&(console.warn("Cannot replace all pitches, replacementMap misses entry for these pitches:"),console.log(Array.from(n))),r}function Ni(e){const t=new Map,n=Array.from(D(Array.from(e),(e=>e[1].repPitch)));return n.sort(((e,t)=>e[1][0][1].order-t[1][0][1].order)),n.forEach(((e,n)=>t.set(e[0],n))),t}class Bi{constructor(e,t){this.name=e,this.notes=t,this.short=t.join(" "),this.pitches=t.map((e=>m(e).pitch)),this.stringCount=t.length}}const ki=new Map([["Guitar",new Map([[6,[new Bi("E stand.",["E2","A2","D3","G3","B3","E4"]),new Bi("Drop D",["D2","A2","D3","G3","B3","E4"]),new Bi("Drop C",["C2","G2","C3","F3","A3","D4"]),new Bi("1/2 down",["D#2","G#2","C#3","F#3","A#3","D#4"]),new Bi("1 down",["D2","G2","C3","F3","A3","D4"]),new Bi("2 down",["C2","F2","A#2","D#3","G3","C4"]),new Bi("DADGAG",["D2","A2","D3","G3","A3","D4"])]],[7,[new Bi("B stand.",["B1","E2","A2","D3","G3","B3","E4"]),new Bi("Drop A",["A1","E2","A2","D3","G3","B3","E4"]),new Bi("1/2 down",["A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new Bi("1 down",["A1","D2","G2","C3","F3","A3","D4"]),new Bi("2 down",["G1","C2","F2","A#2","D#3","G3","C4"])]],[8,[new Bi("F# stand.",["F#1","B1","E2","A2","D3","G3","B3","E4"]),new Bi("Drop E",["E1","B1","E2","A2","D3","G3","B3","E4"]),new Bi("1/2 down",["F1","A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new Bi("1 down",["E1","A1","D2","G2","C3","F3","A3","D4"]),new Bi("2 down",["D1","G1","C2","F2","A#2","D#3","G3","C4"])]]])],["Bass",new Map([[4,[new Bi("E stand.",["E1","A1","D2","G2"]),new Bi("Drop D",["D1","A1","D2","G2"]),new Bi("1/2 down",["D#1","G#1","C#2","F#2"]),new Bi("1 down",["D1","G1","C2","F2"]),new Bi("2 down",["C1","F1","A#1","D#2"])]],[5,[new Bi("B stand.",["B0","E1","A1","D2","G2"]),new Bi("Drop A",["A0","D1","A1","D2","G2"]),new Bi("1/2 down",["A#0","D#1","G#1","C#2","F#2"]),new Bi("1 down",["A0","D1","G1","C2","F2"]),new Bi("2 down",["G0","C1","F1","A#1","D#2"])]],[6,[new Bi("F# stand.",["F#0","B0","E1","A1","D2","G2"]),new Bi("Drop E",["E0","A0","D1","A1","D2","G2"]),new Bi("1/2 down",["F0","A#0","D#1","G#1","C#2","F#2"]),new Bi("1 down",["E1","A0","D1","G1","C2","F2"]),new Bi("2 down",["D0","G0","C1","F1","A#1","D#2"])]]])],["Ukulele",new Map([[4,[new Bi("Hawaii",["G4","C4","E4","A4"]),new Bi("Low G",["G3","C4","E4","A4"]),new Bi("D-tuning",["A4","D4","F#4","B4"]),new Bi("Canadian",["A3","D4","F#4","B4"]),new Bi("Bariton",["D3","G3","B3","E4"])]]])]]);function Di(e,t){const n=e.channel,r=e.pitch-t.pitches[n];return N.fromNote(e,n,r)}function Gi(e){console.log("getting tuning for pitches",e);const t=e.length;return ki.forEach(((n,r)=>{if(n.has(t)){const r=n.get(t);for(let t of r)if(console.log(t.pitches),ua(t.pitches,e))return console.log("found",t),t}})),null}function qi(e,t=24){const n=B(e.pitches);return[n[0],n[1]+t]}const Fi=["#888","#d122e9","#31eb1c","#f37c14","#10edfc","#ffeb09","#ff210d","silver","gold"];function Li(e,t,n){const r=n.stringCount-e+1;return n.pitches[r-1]+t}function Oi(e,t,n){return b(Li(e,t,n))}function Ii(e,t,n){const r=[],a=t.stringCount;for(let i=0;i<a;i++){const o=t.pitches[i];e<o||e>o+n||r.push({string:a-i,fret:e-o})}return r}function Hi(e,t,n){const r=[],a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].indexOf(e),i=t.stringCount;for(let e=0;e<i;e++){let o=a-t.pitches[e]%12;for(o<0&&(o+=12);o<=n;)r.push({string:i-e,fret:o}),o+=12}return r}function $i(e=0,t=50){let n=e;return new Array(t).fill(0).map(((e,t)=>{const r=n+Qr(0,1);n=r+Qr(0,1);const a=cr(1,7),i=cr(0,25),o=Li(a,i),u=cr(15,127);return new N(o,r,u,a,n,a,i)}))}function Ri(e,t,n=24){if(!e||0===e.length)return[];if(!t||!t.pitches)return console.warn("Invalid tuning parameter!"),[];const[r,a]=qi(t,n),i=[],o=[];for(let t of e)t.pitch<r||t.pitch>a?o.push(t.pitch):i.push(t);const u=[];for(let e of i){const n=Ii(e.pitch,t,24);let r=n[0];for(let e of n)e.fret<r.fret&&(r=e);const{string:a,fret:i}=r;u.push(N.fromNote(e,a,i))}if(o.length>0){const[t,n]=B(e,(e=>e.pitch));let i="";t<r&&(i+=`Transpose by ${r-t} semitones`),a<n&&(i+=`Transpose by ${a-n} semitones`),console.warn(`Cannot find a fretboard position for ${o.length} pitches, try another tuning instead:\n`,o,`\nCurrent tuning's pitch range is ${r} - ${a}`,`\ndata pitch range is ${t} - ${n}\n`,i)}return u}function Wi(e){const t=ki.get("guitar").get(6)[0].pitches;return e.map((e=>{const n=e.channel,r=e.pitch-t[n];return N.fromNote(e,n,r)}))}function ji(e){}const Vi=new Map([[72,{minPitch:24,maxPitch:95}],[88,{minPitch:21,maxPitch:108}],[128,{minPitch:0,maxPitch:127}]]);function zi(e){}class Xi{constructor(e,t){this.string=e,this.fret=t}moveBy(e,t){this.string+=e,this.fret+=t}isValid(e,t){return this.string<=e&&this.fret<=t}equals(e){return this.string===e.string&&this.fret===e.fret}toString(){return`(${this.string}, ${this.fret})`}clone(){return new Xi(this.string,this.fret)}difference(e){return{string:e.string-this.string,fret:e.fret-this.fret}}}class Ui{constructor(e=new Array(10).fill(null)){10!==e.length&&(console.error("fingerPositions must have length 10!"),e=new Array(10).fill(null)),this.fingerPositions=e}moveFingerTo(e,t){this.fingerPositions[e]=t}liftFinger(e){this.fingerPositions[e]=null}moveFingerBy(e,t,n){const r=this.fingerPositions[e];r&&r.moveBy(t,n)}moveHandBy(e,t){for(const n of this.fingerPositions)null!==n&&n.moveBy(e,t)}isValid(e,t){for(const n of this.fingerPositions)if(null!==n&&!n.isValid(e,t))return!1;return!0}euqals(e){const t=this.fingerPositions,n=e.fingerPositions;for(let e=0;e<10;e++)if(t[e]!==n[e]){if(null===t[e]||null===n[e])return!1;if(!t[e].equals(n[e]))return!1}return!0}toString(){let e="HandPose ";const t=["T",1,2,3,4,"RT",6,7,8,9];for(let n=0;n<10;n++){const r=this.fingerPositions[n];null!==r&&(e=`${e} ${t[n]} ${r.toString()}`)}}clone(){return new Ui(this.fingerPositions.map((e=>e.clone())))}difference(e){const t=[],n=this.fingerPositions,r=e.fingerPositions;for(let e=0;e<10;e++)null===n[e]?t[e]=r[e]:null===r[e]?t[e]=null:t[e]=n[e].difference(r[e]);return t}costOfMovement(e){if(this.equals(e))return 0;const t=this.difference(e),n=this.fingerPositions,r=e.fingerPositions;if(t.every((e=>null===e)))return 1;let a=!0;for(let e=0;e<10;e++)if(null!==r[e]&&!n[e].equals(r[e])){a=!1;break}if(a)return 2;if(t.every((e=>null!==e&&0===e.string))){const e=t[0].fret;if(t.every((t=>t.fret===e)))return 1+.1*Math.abs(e)}a=!0;for(let e=0;e<10;e++)if(null!==n[e]&&!n[e].equals(r[e])){a=!1;break}return a?2:(console.log("unknown pose change cost",this,e,t),5)}}function Yi(e){e.sort(((e,t)=>e.string!==t.string?t.string-e.string:e.fret-t.fret)),console.log(e.map((e=>e.toString())));const t=new Array(10).fill(null);return 0===e.length?new Ui:1===notes.length||1===notes.length?(t[1]=new Xi(string,fret),new Ui(t)):void 0}function Ji(e,t,n){}function Ki(e,t=!0){if(null==e)return t?"--:--.---":"--:--";const n=Math.floor(e);let r=Math.floor(n/60).toString(),a=(n%60).toString();if(r=r.length<2?`0${r}`:r,a=a.length<2?`0${a}`:a,!t)return`${r}:${a}`;let i=Math.floor(1e3*(e-n)).toString();return i.length<2?i=`00${i}`:i.length<3&&(i=`0${i}`),`${r}:${a}.${i}`}function Qi(e,t=!1,n=!0){let r=e.toISOString().split(":").join("-");return n||(r=r.slice(0,r.indexOf("."))),t&&(r=r.replace("T"," ")),r}function Zi(e,t=30){return e?(-1!==e.lastIndexOf(".")&&(e=e.slice(0,e.lastIndexOf("."))),e.length>t&&(e=`${e.slice(0,t-3)}...`),e):"[No Song]"}function eo(e,t){const n=JSON.stringify(t);localStorage.setItem(e,n)}function to(e){const t=localStorage.getItem(e);if(null===t)return null;try{return JSON.parse(t)}catch(e){return null}}const no=["#ff0000","#ff4e00","#db7b00","#ffcc00","#e4ed00","#81d700","#00ffb4","#00ffea","#00baff","#3c00ff","#a800ff","#ff00fd"].map((e=>{const t=vn(e);return t.s=.5,t.toString()})),ro=["#6699FF","#66FFFF","#000000","#647878","#993366","#FF0000","#FFCC99","#FFFF01","#FF9900","#009900","#66FF99","#0000CC"],ao=En("black","steelblue"),io=new Array(12).fill(0).map(((e,t)=>ao(t/11)));function oo(e,t="default"){switch(t){case"accessible":return ro[e%12];case"gradient":return io[e%12];default:return no[e%12]}}function uo(e){const t=e.length,n=q(e),r=function(e,t){const n=function(e,t){let n,r=0,a=0,i=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-a,a+=n/++r,i+=n*(t-a));else{let o=-1;for(let u of e)null!=(u=t(u,++o,e))&&(u=+u)>=u&&(n=u-a,a+=n/++r,i+=n*(u-a))}if(r>1)return i/(r-1)}(e,void 0);return n?Math.sqrt(n):n}(e)/Math.sqrt(t)*1.96;return{mean:n,low:n-r,high:n+r}}function so(e){e.sort(((e,t)=>e-t));const t=e[0],n=e[e.length-1],r=H(e,.25),a=H(e,.5),i=H(e,.75),o=i-r;return{q1:r,q2:a,q3:i,r0:Math.max(t,r-1.5*o),r1:Math.min(n,i+1.5*o)}}function lo(e,t){return n=>t.map((t=>[t,q(n,(n=>e(t-n)))]))}function co(e){return t=>Math.abs(t/=e)<=1?.75*(1-t*t)/e:0}function ho(e){return t=>Math.abs(t/e)<=1?1/Math.sqrt(2*Math.PI)*Math.pow(Math.E,-.5*t*t):0}function fo(e,t=127,n=0){const r=e.clone().filter((e=>!(e.velocity<t||e.getDuration()<n)));return console.log(`Filtered recording, ${r.length()} of ${e.length()} notes left`),r}function bo(e,t){const n=new Map;for(let e=0;e<t.length;e++){const r=B(t[e],(e=>e.pitch));n.set(e,r)}return e.map((e=>{const t=e.selectedTrack,[r,a]=n.get(t);return e.clone().filter((e=>e.pitch>=r&&e.pitch<=a))}))}function mo(e,t,n=10,r="pitch"){let a;"pitch"===r?a=D(e,(e=>e.pitch)):"channel"===r?a=D(e,(e=>e.channel)):console.warn(`Invalid attribute parameter '${r}'`);const i=new Map;for(const[e,r]of a.entries()){const a=G(r,(e=>e.end)),o=Math.ceil(1e3*a/n),u=new Array(o).fill(0);for(let e of r){const t=Math.round(1e3*e.start/n),r=Math.round(1e3*e.end/n);for(let e=t;e<=r;e++)u[e]+=1}for(let e=0;e<u.length;e++)u[e]/=t;i.set(e,u)}return i}function po(e,t,n=.8){const r=[];for(const[a,i]of e.entries()){for(let e=0;e<i.length;e++)i[e]=i[e]>n;let e=null;for(let n=0;n<i.length;n++)if(!e&&i[n]&&(e=new C(a,n*t/1e3,127,0)),e&&(!i[n]||n===i.length-1)){const a=n*t/1e3;e.end=a,r.push(e),e=null}}return r.sort(((e,t)=>e.start-t.start)),r}function go(e,t=.01,n,r){const a=D(e,(e=>e.pitch)),i=[];for(const[e,o]of a.entries()){const a=o.map((e=>e.start)),u=o.map((e=>e.end)),s=G(u),l=Math.ceil(n*s),c=Jr().domain([0,s]).range([0,s]),h=lo(co(t),c.ticks(l)),f=h(a),b=h(u),m=na(f.map((e=>e[1]))),p=na(b.map((e=>e[1]))),g=m.filter((e=>f[e][1]>r)).map((e=>f[e][0])),d=p.filter((e=>b[e][1]>r)).map((e=>b[e][0]));for(;g.length>0;){const t=g.shift();for(;d.length>0&&d[0]<t;)d.shift();const n=d.shift();for(;g.length>0&&g[0]<n;)g.shift();i.push(new C(e,t,127,0,n))}}return i.sort(((e,t)=>e.start-t.start)),i}function yo(e,t,n){const r=mo(t,1,n),a=mo(e,1,n),i=Array.from(new Set(Array.from(r.keys()).concat(Array.from(a.keys())))),o=new Map;for(const e of i){let t;if(r.has(e))if(a.has(e)){const n=r.get(e),i=a.get(e),o=Math.max(n.length,i.length);t=new Array(o).fill(0);for(let e=0;e<t.length;e++){const r=i[e]||0,a=n[e]||0;0===r&&0===a&&(t[e]=0),0!==r&&0===a&&(t[e]=1),0===r&&0!==a&&(t[e]=2),0!==r&&0!==a&&(t[e]=3)}}else t=r.get(e).map((e=>0!==e?2:0));else t=a.get(e).map((e=>0!==e?1:0));o.set(e,t)}return o}function vo(e){let t=0,n=0,r=0;for(const a of e.values())for(const e of a)1===e?t++:2===e?n++:3===e&&r++;const a=G(Array.from(e),(e=>e[1].length)),i=e.size*a;return{missing:t/i,additional:n/i,correct:r/i}}function wo(e,t,n=16){const r=Za(t)/n;return e.map((e=>{const t=e.clone();return t.start=Math.round(t.start/r)*r,t.end=Math.round(t.end/r)*r,t}))}function So(e,t=1){if(navigator.requestMIDIAccess){let n,r=0,a=0;navigator.requestMIDIAccess().then((i=>{const o=()=>{const t=new Date-n;a+=t;const i=a/r;console.log(`Received MIDI from ${e} after ${t} ms (avg: ${i})`)};for(let t of i.inputs.values())e===t.name&&(t.onmidimessage=o);let u=null;for(let t of i.outputs.values())e===t.name&&(u=t);u||console.error(`Cannot ping output device ${e} because it is not there`);const s=()=>{r<t&&(r++,console.log(`Ping ${r}/${t} Sending MIDI ping to ${e}`),n=new Date,u.send([144,69,127]),setTimeout(s,1e3))};setTimeout(s,1e3)}),(()=>console.error("Cannot get MIDI access")))}else console.error("MIDI: WebMIDI is not supported in this browser.")}},346:(e,t,n)=>{"use strict";var r=n(194),a=n(782);function i(e){return/\.js(\?.*)?$/i.test(e)}function o(e,t,n){return"https://gleitz.github.io/midi-js-soundfonts/"+(t="FluidR3_GM"===t?t:"MusyngKite")+"/"+e+"-"+(n="ogg"===n?n:"mp3")+".js"}var u=n(975);u.instrument=function e(t,n,u){if(1===arguments.length)return function(n,r){return e(t,n,r)};var s=u||{},l=s.isSoundfontURL||i,c=s.nameToUrl||o,h=l(n)?n:c(n,s.soundfont,s.format);return r(t,h,{only:s.only||s.notes}).then((function(e){var r=a(t,e,s).connect(s.destination?s.destination:t.destination);return r.url=h,r.name=n,r}))},u.nameToUrl=o,e.exports&&(e.exports=u),"undefined"!=typeof window&&(window.Soundfont=u)},975:(e,t,n)=>{"use strict";var r=n(289);function a(e,t){if(console.warn("new Soundfont() is deprected"),console.log("Please use Soundfont.instrument() instead of new Soundfont().instrument()"),!(this instanceof a))return new a(e);this.nameToUrl=t||a.nameToUrl,this.ctx=e,this.instruments={},this.promises=[]}function i(e,t){return t=t||{},function(n,a,i,o){console.warn("The oscillator player is deprecated."),console.log("Starting with version 0.9.0 you will have to wait until the soundfont is loaded to play sounds.");var u=n>0&&n<129?+n:r.midi(n),s=u?r.midiToFreq(u,440):null;if(s){i=i||.2;var l=(o=o||{}).destination||t.destination||e.destination,c=o.vcoType||t.vcoType||"sine",h=o.gain||t.gain||.4,f=e.createOscillator();f.type=c,f.frequency.value=s;var b=e.createGain();return b.gain.value=h,f.connect(b),b.connect(l),f.start(a),i>0&&f.stop(a+i),f}}}a.prototype.onready=function(e){console.warn("deprecated API"),console.log("Please use Promise.all(Soundfont.instrument(), Soundfont.instrument()).then() instead of new Soundfont().onready()"),Promise.all(this.promises).then(e)},a.prototype.instrument=function(e,t){console.warn("new Soundfont().instrument() is deprecated."),console.log("Please use Soundfont.instrument() instead.");var n=this.ctx;if((e=e||"default")in this.instruments)return this.instruments[e];var r={name:e,play:i(n,t)};if(this.instruments[e]=r,"default"!==e){var o=a.instrument(n,e,t).then((function(e){return r.play=e.play,r}));this.promises.push(o),r.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),o.then(e)}}else r.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),e()};return r},a.loadBuffers=function(e,t,n){return console.warn("Soundfont.loadBuffers is deprecate."),console.log("Use Soundfont.instrument(..) and get buffers properties from the result."),a.instrument(e,t,n).then((function(e){return e.buffers}))},a.noteToMidi=r.midi,e.exports=a},653:e=>{e.exports=function(e){var a=e.createGain(),i=a._voltage=function(e){var t=e.createBufferSource(),r=e.createBuffer(1,2,e.sampleRate);return r.getChannelData(0).set(n),t.buffer=r,t.loop=!0,t}(e),o=r(i),u=r(i),s=r(i);return a._startAmount=r(u),a._endAmount=r(s),a._multiplier=r(o),a._multiplier.connect(a),a._startAmount.connect(a),a._endAmount.connect(a),a.value=o.gain,a.startValue=u.gain,a.endValue=s.gain,a.startValue.value=0,a.endValue.value=0,Object.defineProperties(a,t),a};var t={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(e){var t=this._multiplier.gain,n=this._startAmount.gain,r=this._endAmount.gain;this._voltage.start(e),this._decayFrom=this._decayFrom=e+this.attack,this._startedAt=e;var i=this.sustain;t.cancelScheduledValues(e),n.cancelScheduledValues(e),r.cancelScheduledValues(e),r.setValueAtTime(0,e),this.attack?(t.setValueAtTime(0,e),t.linearRampToValueAtTime(1,e+this.attack),n.setValueAtTime(1,e),n.linearRampToValueAtTime(0,e+this.attack)):(t.setValueAtTime(1,e),n.setValueAtTime(0,e)),this.decay&&t.setTargetAtTime(i,this._decayFrom,a(this.decay))}},stop:{value:function(e,t){t&&(e-=this.release);var n=e+this.release;if(this.release){var r=this._multiplier.gain,i=this._startAmount.gain,o=this._endAmount.gain;r.cancelScheduledValues(e),i.cancelScheduledValues(e),o.cancelScheduledValues(e);var u=a(this.release);if(this.attack&&e<this._decayFrom){var s=function(e,t,n,r,a){var i=0+(a-n)/(r-n)*1;return i<=0&&(i=0),i>=1&&(i=1),i}(0,0,this._startedAt,this._decayFrom,e);r.linearRampToValueAtTime(s,e),i.linearRampToValueAtTime(1-s,e),i.setTargetAtTime(0,e,u)}o.setTargetAtTime(1,e,u),r.setTargetAtTime(0,e,u)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(e){this._voltage.onended=e}}},n=new Float32Array([1,1]);function r(e){var t=e.context.createGain();return e.connect(t),t}function a(e){return Math.log(e+1)/Math.log(100)}},364:e=>{"use strict";e.exports={decode:function(e,t){for(var n,r,a,i=e.replace(/[^A-Za-z0-9\+\/]/g,""),o=i.length,u=t?Math.ceil((3*o+1>>2)/t)*t:3*o+1>>2,s=new Uint8Array(u),l=0,c=0,h=0;h<o;h++)if(r=3&h,l|=((a=i.charCodeAt(h))>64&&a<91?a-65:a>96&&a<123?a-71:a>47&&a<58?a+4:43===a?62:47===a?63:0)<<18-6*r,3===r||o-h==1){for(n=0;n<3&&c<u;n++,c++)s[c]=l>>>(16>>>n&24)&255;l=0}return s}}},234:e=>{"use strict";e.exports=function(e,t){return new Promise((function(n,r){var a=new XMLHttpRequest;t&&(a.responseType=t),a.open("GET",e),a.onload=function(){200===a.status?n(a.response):r(Error(a.statusText))},a.onerror=function(){r(Error("Network Error"))},a.send()}))}},194:(e,t,n)=>{"use strict";var r=n(364),a=n(234);function i(e){return function(t){return"string"==typeof t&&e.test(t)}}function o(e,t){return"string"==typeof e?e+t:"function"==typeof e?e(t):t}function u(e,t,n,r){var a,i=t instanceof ArrayBuffer?s:l(t)?c:(a=t)&&"function"==typeof a.then?h:f(t)?b:function(e){return e&&"object"==typeof e}(t)?m:p(t)?g:d(t)?y:v(t)?w:null;return i?i(e,t,n||{}):r?Promise.resolve(r):Promise.reject("Source not valid ("+t+")")}function s(e,t,n){return new Promise((function(n,r){e.decodeAudioData(t,(function(e){n(e)}),(function(){r("Can't decode audio data ("+t.slice(0,30)+"...)")}))}))}u.fetch=a;var l=i(/\.(mp3|wav|ogg)(\?.*)?$/i);function c(e,t,n){var r=o(n.from,t);return u(e,u.fetch(r,"arraybuffer"),n)}function h(e,t,n){return t.then((function(t){return u(e,t,n)}))}var f=Array.isArray;function b(e,t,n){return Promise.all(t.map((function(t){return u(e,t,n,t)})))}function m(e,t,n){var r={},a=Object.keys(t).map((function(a){if(n.only&&-1===n.only.indexOf(a))return null;var i=t[a];return u(e,i,n,i).then((function(e){r[a]=e}))}));return Promise.all(a).then((function(){return r}))}var p=i(/\.json(\?.*)?$/i);function g(e,t,n){var r=o(n.from,t);return u(e,u.fetch(r,"text").then(JSON.parse),n)}var d=i(/^data:audio/);function y(e,t,n){var a=t.indexOf(",");return u(e,r.decode(t.slice(a+1)).buffer,n)}var v=i(/\.js(\?.*)?$/i);function w(e,t,n){var r=o(n.from,t);return u(e,u.fetch(r,"text").then(S),n)}function S(e){var t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");t=e.indexOf("=",t)+2;var n=e.lastIndexOf(",");return JSON.parse(e.slice(t,n)+"}")}e.exports&&(e.exports=u),"undefined"!=typeof window&&(window.loadAudio=u)},803:e=>{e.exports=function e(t,n,r){function a(o,u){if(!n[o]){if(!t[o]){if(i)return i(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){return a(t[o][1][e]||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var i=void 0,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return new function(e){if(this._event=e,this._data=e.data,this.receivedTime=e.receivedTime,this._data&&this._data.length<2)console.warn("Illegal MIDI message of length",this._data.length);else switch(this._messageCode=240&e.data[0],this.channel=15&e.data[0],this._messageCode){case 128:this.messageType="noteoff",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 144:this.messageType="noteon",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 160:this.messageType="keypressure",this.key=127&e.data[1],this.pressure=127&e.data[2];break;case 176:this.messageType="controlchange",this.controllerNumber=127&e.data[1],this.controllerValue=127&e.data[2],120===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allsoundoff":121===this.controllerNumber?this.channelModeMessage="resetallcontrollers":122===this.controllerNumber?0===this.controllerValue?this.channelModeMessage="localcontroloff":this.channelModeMessage="localcontrolon":123===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allnotesoff":124===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeoff":125===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeon":126===this.controllerNumber?this.channelModeMessage="monomodeon":127===this.controllerNumber&&(this.channelModeMessage="polymodeon");break;case 192:this.messageType="programchange",this.program=e.data[1];break;case 208:this.messageType="channelpressure",this.pressure=127&e.data[1];break;case 224:this.messageType="pitchbendchange";var t=127&e.data[2],n=127&e.data[1];this.pitchBend=(t<<8)+n}}(e)},t.exports=n.default},{}]},{},[1])(1)},289:(e,t,n)=>{"use strict";function r(e,t){return Array(t+1).join(e)}function a(e){return"number"==typeof e}function i(e,t){return Math.pow(2,(e-69)/12)*(t||440)}n.r(t),n.d(t,{regex:()=>u,parse:()=>l,build:()=>c,midi:()=>h,freq:()=>f,letter:()=>b,acc:()=>m,pc:()=>p,step:()=>g,alt:()=>d,chroma:()=>y,oct:()=>v});var o=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;function u(){return o}var s=[0,2,4,5,7,9,11];function l(e,t,n){if("string"!=typeof e)return null;var r=o.exec(e);if(!r||!t&&r[4])return null;var a={letter:r[1].toUpperCase(),acc:r[2].replace(/x/g,"##")};a.pc=a.letter+a.acc,a.step=(a.letter.charCodeAt(0)+3)%7,a.alt="b"===a.acc[0]?-a.acc.length:a.acc.length;var u=s[a.step]+a.alt;return a.chroma=u<0?12+u:u%12,r[3]&&(a.oct=+r[3],a.midi=u+12*(a.oct+1),a.freq=i(a.midi,n)),t&&(a.tonicOf=r[4]),a}function c(e,t,n){return null==e?null:e.step?c(e.step,e.alt,e.oct):e<0||e>6?null:"CDEFGAB".charAt(e)+(a(i=t)?i<0?r("b",-i):r("#",i):"")+function(e){return a(e)?""+e:""}(n);var i}function h(e){if((a(e)||"string"==typeof e)&&e>=0&&e<128)return+e;var t=l(e);return t&&void 0!==t.midi?t.midi:null}function f(e,t){var n=h(e);return null===n?null:i(n,t)}function b(e){return(l(e)||{}).letter}function m(e){return(l(e)||{}).acc}function p(e){return(l(e)||{}).pc}function g(e){return(l(e)||{}).step}function d(e){return(l(e)||{}).alt}function y(e){return(l(e)||{}).chroma}function v(e){return(l(e)||{}).oct}},952:e=>{function t(e,t){return function(n,r,a,i){e(n,r,a,i),t(n,r,a,i)}}e.exports=function(e){return e.on=function(n,r){if(1===arguments.length&&"function"==typeof n)return e.on("event",n);var a="on"+n,i=e[a];return e[a]=i?t(i,r):r,e},e}},782:(e,t,n)=>{"use strict";var r=n(722),a=n(952),i=n(28),o=n(490),u=n(751);function s(e,t,n){return u(o(i(a(r(e,t,n)))))}e.exports&&(e.exports=s),"undefined"!=typeof window&&(window.SamplePlayer=s)},751:(e,t,n)=>{var r=n(803);e.exports=function(e){return e.listenToMidi=function(t,n){var a={},i=n||{},o=i.gain||function(e){return e/127};return t.onmidimessage=function(t){var n=t.messageType?t:r(t);if("noteon"===n.messageType&&0===n.velocity&&(n.messageType="noteoff"),!i.channel||n.channel===i.channel)switch(n.messageType){case"noteon":a[n.key]=e.play(n.key,0,{gain:o(n.velocity)});break;case"noteoff":a[n.key]&&(a[n.key].stop(),delete a[n.key])}},e},e}},28:(e,t,n)=>{"use strict";var r=n(161),a=function(e){return function(e){return null!==e&&e!==[]&&e>=0&&e<129}(e)?+e:r.midi(e)};e.exports=function(e){if(e.buffers){var t=e.opts.map,n="function"==typeof t?t:a,r=function(e){return e?n(e)||e:null};e.buffers=function(e,t){return Object.keys(e).reduce((function(n,r){return n[t(r)]=e[r],n}),{})}(e.buffers,r);var i=e.start;e.start=function(e,t,n){var a=r(e),o=a%1;return o&&(a=Math.floor(a),n=Object.assign(n||{},{cents:Math.floor(100*o)})),i(a,t,n)}}return e}},722:(e,t,n)=>{"use strict";var r=n(653),a={},i={gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0};function o(e){return"number"==typeof e}var u=["attack","decay","sustain","release"];e.exports=function(e,t,n){var s=!1,l=0,c={},h=e.createGain();h.gain.value=1;var f=Object.assign({},i,n),b={context:e,out:h,opts:f};return t instanceof AudioBuffer?b.buffer=t:b.buffers=t,b.start=function(t,n,r){if(b.buffer&&null!==t)return b.start(null,t,n);var i=t?b.buffers[t]:b.buffer;if(i){if(s){var o=r||a;n=Math.max(e.currentTime,n||0),b.emit("start",n,t,o);var u=m(t,i,o);return u.id=function(t,n){return n.id=l++,c[n.id]=n,n.source.onended=function(){var t=e.currentTime;n.source.disconnect(),n.env.disconnect(),n.disconnect(),b.emit("ended",t,n.id,n)},n.id}(0,u),u.env.start(n),u.source.start(n),b.emit("started",n,u.id,u),o.duration&&u.stop(n+o.duration),u}console.warn("SamplePlayer not connected to any node.")}else console.warn("Buffer "+t+" not found.")},b.play=function(e,t,n){return b.start(e,t,n)},b.stop=function(e,t){var n;return(t=t||Object.keys(c)).map((function(t){return(n=c[t])?(n.stop(e),n.id):null}))},b.connect=function(e){return s=!0,h.connect(e),b},b.emit=function(e,t,n,r){b.onevent&&b.onevent(e,t,n,r);var a=b["on"+e];a&&a(t,n,r)},b;function m(t,n,a){var i,s=e.createGain();return s.gain.value=0,s.connect(h),s.env=function(e,t,n){var a=r(e),i=t.adsr||n.adsr;return u.forEach((function(e,r){a[e]=i?i[r]:t[e]||n[e]})),a.value.value=o(t.gain)?t.gain:o(n.gain)?n.gain:1,a}(e,a,f),s.env.connect(s.gain),s.source=e.createBufferSource(),s.source.buffer=n,s.source.connect(s),s.source.loop=a.loop||f.loop,s.source.playbackRate.value=(i=a.cents||f.cents)?Math.pow(2,i/1200):1,s.source.loopStart=a.loopStart||f.loopStart,s.source.loopEnd=a.loopEnd||f.loopEnd,s.stop=function(n){var r=n||e.currentTime;b.emit("stop",r,t);var a=s.env.stop(r);s.source.stop(a)},s}}},490:e=>{"use strict";var t=Array.isArray,n={};e.exports=function(e){return e.schedule=function(r,a){var i,o,u,s,l=e.context.currentTime,c=r<l?l:r;return e.emit("schedule",c,a),a.map((function(r){return r?(t(r)?(i=r[0],o=r[1]):(i=r.time,o=r),function(e){return e&&"object"==typeof e}(o)?(u=o.name||o.key||o.note||o.midi||null,s=o):(u=o,s=n),e.start(u,c+(i||0),s)):null}))},e}},161:e=>{"use strict";var t=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/,n=[0,2,4,5,7,9,11];function r(e,r,i){if("string"!=typeof e)return null;var o=t.exec(e);if(!o||!r&&o[4])return null;var u={letter:o[1].toUpperCase(),acc:o[2].replace(/x/g,"##")};return u.pc=u.letter+u.acc,u.step=(u.letter.charCodeAt(0)+3)%7,u.alt="b"===u.acc[0]?-u.acc.length:u.acc.length,u.chroma=n[u.step]+u.alt,o[3]&&(u.oct=+o[3],u.midi=u.chroma+12*(u.oct+1),u.freq=a(u.midi,i)),r&&(u.tonicOf=o[4]),u}function a(e,t){return Math.pow(2,(e-69)/12)*(t||440)}var i={parse:r,regex:function(){return t},midiToFreq:a};["letter","acc","pc","step","alt","chroma","oct","midi","freq"].forEach((function(e){i[e]=function(t){var n=r(t);return n&&void 0!==n[e]?n[e]:null}})),e.exports=i}},t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}return n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(693)})()}));
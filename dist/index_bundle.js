!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.$=t():e.$=t()}(self,(function(){return(()=>{var e={90:()=>{},101:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Alignment:()=>h,Canvas:()=>i,Chords:()=>f,Drums:()=>a,Guitar:()=>o,GuitarNote:()=>$,Matching:()=>c,Metronome:()=>$i,Midi:()=>r,MidiInputManager:()=>Ya,Note:()=>j,NoteArray:()=>Mi,Piano:()=>s,Player:()=>fa,Recording:()=>Ci,Similarity:()=>m,StringBased:()=>v,StringedFingering:()=>u,Svg:()=>Ia,Utils:()=>l,preprocessMidiFileData:()=>Pa,preprocessMusicXmlData:()=>xa,recordAudio:()=>Oa,recordMidi:()=>Fa});var r={};n.r(r),n.d(r,{MIDI_COMMANDS:()=>G,MIDI_NOTE_RANGES:()=>F,NOTE_NAMES:()=>B,SHARPS:()=>q,getMidiDrumNoteByNr:()=>N,getMidiInstrumentByNr:()=>T,getMidiInstrumentByNrL2:()=>E,getMidiNoteByLabel:()=>x,getMidiNoteByNameAndOctave:()=>_,getMidiNoteByNr:()=>A,getNoteNameFromNoteNr:()=>k,isSharp:()=>C});var i={};n.r(i),n.d(i,{drawCircle:()=>Na,drawDiamond:()=>Ba,drawFilledCircle:()=>Ca,drawNoteTrapezoid:()=>qa,drawNoteTrapezoidUpwards:()=>Ga,drawRoundedRect:()=>La,drawTriangle:()=>ka,drawX:()=>Da,setupCanvas:()=>Ea});var a={};n.r(a),n.d(a,{drumPitchReplacementMapMPS850:()=>Ja,generateDrumVariation:()=>Ka,getPitch2PositionMap:()=>Za,simplifyDrumPitches:()=>Qa});var o={};n.r(o),n.d(o,{fretboardPositionsFromMidi:()=>ho,generateExampleData:()=>co,getFretboardPositionsFromNoteName:()=>lo,getFretboardPositionsFromPitch:()=>uo,getNoteInfoFromFretboardPos:()=>so,getPitchFromFretboardPos:()=>oo,getTuningFromPitches:()=>ro,getTuningPitchRange:()=>io,guitarNoteFromNote:()=>no,stringColors:()=>ao,stringedTunings:()=>to});var s={};n.r(s),n.d(s,{pianoPitchRange:()=>mo});var u={};n.r(u),n.d(u,{getHandPoseForChord:()=>bo,getOptimalHandPoseSequence:()=>go});var l={};n.r(l),n.d(l,{alignNotesToBpm:()=>jo,arrayContainsArray:()=>Ai,arrayHasSameElements:()=>wi,arrayShallowEquals:()=>Pi,averageRecordings:()=>Lo,averageRecordings2:()=>Io,bpmToSecondsPerBeat:()=>pa,choose:()=>fi,clipRecordingsPitchesToGtRange:()=>qo,clipValue:()=>pi,confidenceInterval:()=>Eo,deepCloneFlatObjectMap:()=>ba,differenceMap:()=>Oo,differenceMapErrorAreas:()=>Fo,filterRecordingNoise:()=>Do,findLocalMaxima:()=>di,flattenArray:()=>xi,formatDate:()=>vo,formatMatrix:()=>Ti,formatSongTitle:()=>Mo,formatTime:()=>yo,getBoxplotCharacteristics:()=>No,getMatrixMax:()=>_i,getObjectFromLocalStorage:()=>wo,groupNotesByPitch:()=>da,kernelDensityEstimator:()=>Co,kernelEpanechnikov:()=>ko,kernelGauss:()=>Bo,noteArrayToPitchSequence:()=>ga,noteArrayToString:()=>ya,noteColorFromPitch:()=>To,pingMidiDevice:()=>$o,pitchSequenceToInvervals:()=>Ma,randFloat:()=>mi,recordingsHeatmap:()=>Go,removeDuplicates:()=>Si,reverseString:()=>va,storeObjectInLocalStorage:()=>Po,swapSoSmallerFirst:()=>bi});var c={};n.r(c),n.d(c,{findNearest:()=>Uo,getMatchingError:()=>Wo,getMatchingSection:()=>zo,getMatchingSliceError:()=>Xo,getMultiMatchingErrorPerNote:()=>Vo,matchGtAndMultipleRecordings:()=>Ho,matchGtAndRecordingNotes:()=>Ro});var h={};n.r(h),n.d(h,{alignNoteArrays:()=>Yo,alignNoteArrays2:()=>Jo,alignNoteArrays3:()=>Ko,alignmentBenchmark:()=>Zo,testAlignment:()=>Qo});var m={};n.r(m),n.d(m,{discretizeTime:()=>rs,getSimilarParts:()=>ts,getSimilarPartsViaMatching:()=>us,getTrackSimilarity:()=>ns});var f={};n.r(f),n.d(f,{detectChordsByExactStart:()=>xu,detectChordsByOverlap:()=>Au,getChordName:()=>Eu,getChordType:()=>Tu,testGetChordType:()=>Nu});var p={};n.r(p),n.d(p,{levenshtein:()=>Cu,normalizedLevenshtein:()=>ku});var b={};n.r(b),n.d(b,{lcs:()=>Bu,lcsLength:()=>Du,normalizedLcsLength:()=>qu});var d={};n.r(d),n.d(d,{differenceSimilarity:()=>Ou,gotoh:()=>Gu,matchMissmatchSimilarity:()=>Iu,normalizedGotoh:()=>Lu});var g={};n.r(g),n.d(g,{default:()=>Fu});var y={};n.r(y),n.d(y,{default:()=>$u});var v={};n.r(v),n.d(v,{Gotoh:()=>d,Levenshtein:()=>p,LongestCommonSubsequence:()=>b,NeedlemanWunsch:()=>Hu,SuffixTree:()=>g,SuffixTreeForArrays:()=>y});const M=new Map,P=new Map,w=new Map,S=new Map;function A(e){return M.get(e)}function x(e){return P.get(e)}function _(e,t){return P.get(`${e}${t}`)}function T(e){return w.get(e)}function E(e,t){const n=`${e}-${t}`;return S.get(n)}function N(e){return O.get(e)}function C(e){return q.has(e)}function k(e){return B[e%12]}const B=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],D=[{pitch:0,name:"C",octave:-1,label:"C-1",frequency:8.176},{pitch:1,name:"C#",octave:-1,label:"C#-1",frequency:8.662},{pitch:2,name:"D",octave:-1,label:"D-1",frequency:9.177},{pitch:3,name:"D#",octave:-1,label:"D#-1",frequency:9.723},{pitch:4,name:"E",octave:-1,label:"E-1",frequency:10.301},{pitch:5,name:"F",octave:-1,label:"F-1",frequency:10.913},{pitch:6,name:"F#",octave:-1,label:"F#-1",frequency:11.562},{pitch:7,name:"G",octave:-1,label:"G-1",frequency:12.25},{pitch:8,name:"G#",octave:-1,label:"G#-1",frequency:12.978},{pitch:9,name:"A",octave:-1,label:"A-1",frequency:13.75},{pitch:10,name:"A#",octave:-1,label:"A#-1",frequency:14.568},{pitch:11,name:"B",octave:-1,label:"B-1",frequency:15.434},{pitch:12,name:"C",octave:0,label:"C0",frequency:16.352},{pitch:13,name:"C#",octave:0,label:"C#0",frequency:17.324},{pitch:14,name:"D",octave:0,label:"D0",frequency:18.354},{pitch:15,name:"D#",octave:0,label:"D#0",frequency:19.445},{pitch:16,name:"E",octave:0,label:"E0",frequency:20.602},{pitch:17,name:"F",octave:0,label:"F0",frequency:21.827},{pitch:18,name:"F#",octave:0,label:"F#0",frequency:23.125},{pitch:19,name:"G",octave:0,label:"G0",frequency:24.5},{pitch:20,name:"G#",octave:0,label:"G#0",frequency:25.957},{pitch:21,name:"A",octave:0,label:"A0",frequency:27.5},{pitch:22,name:"A#",octave:0,label:"A#0",frequency:29.135},{pitch:23,name:"B",octave:0,label:"B0",frequency:30.868},{pitch:24,name:"C",octave:1,label:"C1",frequency:32.703},{pitch:25,name:"C#",octave:1,label:"C#1",frequency:34.648},{pitch:26,name:"D",octave:1,label:"D1",frequency:36.708},{pitch:27,name:"D#",octave:1,label:"D#1",frequency:38.891},{pitch:28,name:"E",octave:1,label:"E1",frequency:41.203},{pitch:29,name:"F",octave:1,label:"F1",frequency:43.654},{pitch:30,name:"F#",octave:1,label:"F#1",frequency:46.249},{pitch:31,name:"G",octave:1,label:"G1",frequency:48.999},{pitch:32,name:"G#",octave:1,label:"G#1",frequency:51.913},{pitch:33,name:"A",octave:1,label:"A1",frequency:55},{pitch:34,name:"A#",octave:1,label:"A#1",frequency:58.27},{pitch:35,name:"B",octave:1,label:"B1",frequency:61.735},{pitch:36,name:"C",octave:2,label:"C2",frequency:65.406},{pitch:37,name:"C#",octave:2,label:"C#2",frequency:69.296},{pitch:38,name:"D",octave:2,label:"D2",frequency:73.416},{pitch:39,name:"D#",octave:2,label:"D#2",frequency:77.782},{pitch:40,name:"E",octave:2,label:"E2",frequency:82.407},{pitch:41,name:"F",octave:2,label:"F2",frequency:87.307},{pitch:42,name:"F#",octave:2,label:"F#2",frequency:92.499},{pitch:43,name:"G",octave:2,label:"G2",frequency:97.999},{pitch:44,name:"G#",octave:2,label:"G#2",frequency:103.826},{pitch:45,name:"A",octave:2,label:"A2",frequency:110},{pitch:46,name:"A#",octave:2,label:"A#2",frequency:116.541},{pitch:47,name:"B",octave:2,label:"B2",frequency:123.471},{pitch:48,name:"C",octave:3,label:"C3",frequency:130.813},{pitch:49,name:"C#",octave:3,label:"C#3",frequency:138.591},{pitch:50,name:"D",octave:3,label:"D3",frequency:146.832},{pitch:51,name:"D#",octave:3,label:"D#3",frequency:155.563},{pitch:52,name:"E",octave:3,label:"E3",frequency:164.814},{pitch:53,name:"F",octave:3,label:"F3",frequency:174.614},{pitch:54,name:"F#",octave:3,label:"F#3",frequency:184.997},{pitch:55,name:"G",octave:3,label:"G3",frequency:195.998},{pitch:56,name:"G#",octave:3,label:"G#3",frequency:207.652},{pitch:57,name:"A",octave:3,label:"A3",frequency:220},{pitch:58,name:"A#",octave:3,label:"A#3",frequency:233.082},{pitch:59,name:"B",octave:3,label:"B3",frequency:246.942},{pitch:60,name:"C",octave:4,label:"C4",frequency:261.626},{pitch:61,name:"C#",octave:4,label:"C#4",frequency:277.183},{pitch:62,name:"D",octave:4,label:"D4",frequency:293.665},{pitch:63,name:"D#",octave:4,label:"D#4",frequency:311.127},{pitch:64,name:"E",octave:4,label:"E4",frequency:329.628},{pitch:65,name:"F",octave:4,label:"F4",frequency:349.228},{pitch:66,name:"F#",octave:4,label:"F#4",frequency:369.994},{pitch:67,name:"G",octave:4,label:"G4",frequency:391.995},{pitch:68,name:"G#",octave:4,label:"G#4",frequency:415.305},{pitch:69,name:"A",octave:4,label:"A4",frequency:440},{pitch:70,name:"A#",octave:4,label:"A#4",frequency:466.164},{pitch:71,name:"B",octave:4,label:"B4",frequency:493.883},{pitch:72,name:"C",octave:5,label:"C5",frequency:523.251},{pitch:73,name:"C#",octave:5,label:"C#5",frequency:554.365},{pitch:74,name:"D",octave:5,label:"D5",frequency:587.33},{pitch:75,name:"D#",octave:5,label:"D#5",frequency:622.254},{pitch:76,name:"E",octave:5,label:"E5",frequency:659.255},{pitch:77,name:"F",octave:5,label:"F5",frequency:698.456},{pitch:78,name:"F#",octave:5,label:"F#5",frequency:739.989},{pitch:79,name:"G",octave:5,label:"G5",frequency:783.991},{pitch:80,name:"G#",octave:5,label:"G#5",frequency:830.609},{pitch:81,name:"A",octave:5,label:"A5",frequency:880},{pitch:82,name:"A#",octave:5,label:"A#5",frequency:932.328},{pitch:83,name:"B",octave:5,label:"B5",frequency:987.767},{pitch:84,name:"C",octave:6,label:"C6",frequency:1046.502},{pitch:85,name:"C#",octave:6,label:"C#6",frequency:1108.731},{pitch:86,name:"D",octave:6,label:"D6",frequency:1174.659},{pitch:87,name:"D#",octave:6,label:"D#6",frequency:1244.508},{pitch:88,name:"E",octave:6,label:"E6",frequency:1318.51},{pitch:89,name:"F",octave:6,label:"F6",frequency:1396.913},{pitch:90,name:"F#",octave:6,label:"F#6",frequency:1479.978},{pitch:91,name:"G",octave:6,label:"G6",frequency:1567.982},{pitch:92,name:"G#",octave:6,label:"G#6",frequency:1661.219},{pitch:93,name:"A",octave:6,label:"A6",frequency:1760},{pitch:94,name:"A#",octave:6,label:"A#6",frequency:1864.655},{pitch:95,name:"B",octave:6,label:"B6",frequency:1975.533},{pitch:96,name:"C",octave:7,label:"C7",frequency:2093.005},{pitch:97,name:"C#",octave:7,label:"C#7",frequency:2217.461},{pitch:98,name:"D",octave:7,label:"D7",frequency:2349.318},{pitch:99,name:"D#",octave:7,label:"D#7",frequency:2489.016},{pitch:100,name:"E",octave:7,label:"E7",frequency:2637.02},{pitch:101,name:"F",octave:7,label:"F7",frequency:2793.826},{pitch:102,name:"F#",octave:7,label:"F#7",frequency:2959.955},{pitch:103,name:"G",octave:7,label:"G7",frequency:3135.963},{pitch:104,name:"G#",octave:7,label:"G#7",frequency:3322.438},{pitch:105,name:"A",octave:7,label:"A7",frequency:3520},{pitch:106,name:"A#",octave:7,label:"A#7",frequency:3729.31},{pitch:107,name:"B",octave:7,label:"B7",frequency:3951.066},{pitch:108,name:"C",octave:8,label:"C8",frequency:4186.009},{pitch:109,name:"C#",octave:8,label:"C#8",frequency:4434.922},{pitch:110,name:"D",octave:8,label:"D8",frequency:4698.636},{pitch:111,name:"D#",octave:8,label:"D#8",frequency:4978.032},{pitch:112,name:"E",octave:8,label:"E8",frequency:5274.041},{pitch:113,name:"F",octave:8,label:"F8",frequency:5587.652},{pitch:114,name:"F#",octave:8,label:"F#8",frequency:5919.911},{pitch:115,name:"G",octave:8,label:"G8",frequency:6271.927},{pitch:116,name:"G#",octave:8,label:"G#8",frequency:6644.875},{pitch:117,name:"A",octave:8,label:"A8",frequency:7040},{pitch:118,name:"A#",octave:8,label:"A#8",frequency:7458.62},{pitch:119,name:"B",octave:8,label:"B8",frequency:7902.133},{pitch:120,name:"C",octave:9,label:"C9",frequency:8372.018},{pitch:121,name:"C#",octave:9,label:"C#9",frequency:8869.844},{pitch:122,name:"D",octave:9,label:"D9",frequency:9397.273},{pitch:123,name:"D#",octave:9,label:"D#9",frequency:9956.063},{pitch:124,name:"E",octave:9,label:"E9",frequency:10548.08},{pitch:125,name:"F",octave:9,label:"F9",frequency:11175.3},{pitch:126,name:"F#",octave:9,label:"F#9",frequency:11839.82},{pitch:127,name:"G",octave:9,label:"G9",frequency:12543.85}],q=new Map([[1,null],[3,null],[6,null],[8,null],[10,null],[13,null],[15,null],[18,null],[20,null],[22,null],[25,null],[27,null],[30,null],[32,null],[34,null],[37,null],[39,null],[42,null],[44,null],[46,null],[49,null],[51,null],[54,null],[56,null],[58,null],[61,null],[63,null],[66,null],[68,null],[70,null],[73,null],[75,null],[78,null],[80,null],[82,null],[85,null],[87,null],[90,null],[92,null],[94,null],[97,null],[99,null],[102,null],[104,null],[106,null],[109,null],[111,null],[114,null],[116,null],[118,null],[121,null],[123,null],[126,null]]),G=new Map([[128,{name:"noteOff",description:"Note-off",params:["key","velocity"]}],[144,{name:"noteOn",description:"Note-on",params:["key","velocity"]}],[160,{name:"aftertouch",description:"Aftertouch",params:["key","touch"]}],[176,{name:"continuousController",description:"Continuous controller",params:["controller #","controller value"]}],[192,{name:"patchChange",description:"Patch change",params:["instrument number","instrument number"]}],[208,{name:"channelPressure",description:"Channel Pressure",params:["pressure"]}],[224,{name:"pitchBend",description:"Pitch bend",params:["lsb (7 bits)","msb (7 bits)"]}],[240,{name:"sysExStart",description:"start of system exclusive message"}],[241,{name:"timeCodeQuarter",description:"MIDI Time Code Quarter Frame (Sys Common)"}],[242,{name:"posPointer",description:"Song Position Pointer (Sys Common)"}],[243,{name:"songSelect",description:"Song Select (Sys Common)"}],[244,{name:"unknown1",description:"???"}],[245,{name:"unknown2",description:"???"}],[246,{name:"tuneRequest",description:"Tune Request (Sys Common)"}],[247,{name:"syExEnd",description:"end of system exclusive message 0"}],[248,{name:"timingClock",description:"Timing Clock (Sys Realtime)"}],[250,{name:"start",description:"Start (Sys Realtime)"}],[251,{name:"continue",description:"Continue (Sys Realtime)"}],[252,{name:"stop",description:"Stop (Sys Realtime)"}],[253,{name:"unknwon3",description:"???"}],[254,{name:"activeSensing",description:"Active Sensing (Sys Realtime)"}],[255,{name:"systemReset",description:"System Reset (Sys Realtime)"}]]),L=[{number:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,group:"Piano",label:"Bright Acoustic Piano"},{number:2,group:"Piano",label:"Electric Grand Piano"},{number:3,group:"Piano",label:"Honky-tonk Piano"},{number:4,group:"Piano",label:"Electric Piano 1"},{number:5,group:"Piano",label:"Electric Piano 2"},{number:6,group:"Piano",label:"Harpsichord"},{number:7,group:"Piano",label:"Clavinet"},{number:8,group:"Chromatic Percussion",label:"Celesta"},{number:9,group:"Chromatic Percussion",label:"Glockenspiel"},{number:10,group:"Chromatic Percussion",label:"Music Box"},{number:11,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,group:"Chromatic Percussion",label:"Marimba"},{number:13,group:"Chromatic Percussion",label:"Xylophone"},{number:14,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,group:"Chromatic Percussion",label:"Dulcimer"},{number:16,group:"Organ",label:"Drawbar Organ"},{number:17,group:"Organ",label:"Percussive Organ"},{number:18,group:"Organ",label:"Rock Organ"},{number:19,group:"Organ",label:"Church Organ"},{number:20,group:"Organ",label:"Reed Organ"},{number:21,group:"Organ",label:"Accordion"},{number:22,group:"Organ",label:"Harmonica"},{number:23,group:"Organ",label:"Tango Accordion"},{number:24,group:"Guitar",label:"Acoustic Guitar(nylon)"},{number:25,group:"Guitar",label:"Acoustic Guitar(steel)"},{number:26,group:"Guitar",label:"Electric Guitar(jazz)"},{number:27,group:"Guitar",label:"Electric Guitar(clean)"},{number:28,group:"Guitar",label:"Electric Guitar(muted)"},{number:29,group:"Guitar",label:"Overdriven Guitar"},{number:30,group:"Guitar",label:"Distortion Guitar"},{number:31,group:"Guitar",label:"Guitar harmonics"},{number:32,group:"Bass",label:"Acoustic Bass"},{number:33,group:"Bass",label:"Electric Bass(finger)"},{number:34,group:"Bass",label:"Electric Bass(pick)"},{number:35,group:"Bass",label:"Fretless Bass"},{number:36,group:"Bass",label:"Slap Bass 1"},{number:37,group:"Bass",label:"Slap Bass 2"},{number:38,group:"Bass",label:"Synth Bass 1"},{number:39,group:"Bass",label:"Synth Bass 2"},{number:40,group:"Strings",label:"Violin"},{number:41,group:"Strings",label:"Viola"},{number:42,group:"Strings",label:"Cello"},{number:43,group:"Strings",label:"Contrabass"},{number:44,group:"Strings",label:"Tremolo Strings"},{number:45,group:"Strings",label:"Pizzicato Strings"},{number:46,group:"Strings",label:"Orchestral Harp"},{number:47,group:"Strings",label:"Timpani"},{number:48,group:"Strings (continued)",label:"String Ensemble 1"},{number:49,group:"Strings (continued)",label:"String Ensemble 2"},{number:50,group:"Strings (continued)",label:"Synth Strings 1"},{number:51,group:"Strings (continued)",label:"Synth Strings 2"},{number:52,group:"Strings (continued)",label:"Choir Aahs"},{number:53,group:"Strings (continued)",label:"Voice Oohs"},{number:54,group:"Strings (continued)",label:"Synth Voice"},{number:55,group:"Strings (continued)",label:"Orchestra Hit"},{number:56,group:"Brass",label:"Trumpet"},{number:57,group:"Brass",label:"Trombone"},{number:58,group:"Brass",label:"Tuba"},{number:59,group:"Brass",label:"Muted Trumpet"},{number:60,group:"Brass",label:"French Horn"},{number:61,group:"Brass",label:"Brass Section"},{number:62,group:"Brass",label:"Synth Brass 1"},{number:63,group:"Brass",label:"Synth Brass 2"},{number:64,group:"Reed",label:"Soprano Sax"},{number:65,group:"Reed",label:"Alto Sax"},{number:66,group:"Reed",label:"Tenor Sax"},{number:67,group:"Reed",label:"Baritone Sax"},{number:68,group:"Reed",label:"Oboe"},{number:69,group:"Reed",label:"English Horn"},{number:70,group:"Reed",label:"Bassoon"},{number:71,group:"Reed",label:"Clarinet"},{number:72,group:"Pipe",label:"Piccolo"},{number:73,group:"Pipe",label:"Flute"},{number:74,group:"Pipe",label:"Recorder"},{number:75,group:"Pipe",label:"Pan Flute"},{number:76,group:"Pipe",label:"Blown Bottle"},{number:77,group:"Pipe",label:"Shakuhachi"},{number:78,group:"Pipe",label:"Whistle"},{number:79,group:"Pipe",label:"Ocarina"},{number:80,group:"Synth Lead",label:"Lead 1(square)"},{number:81,group:"Synth Lead",label:"Lead 2(sawtooth)"},{number:82,group:"Synth Lead",label:"Lead 3(calliope)"},{number:83,group:"Synth Lead",label:"Lead 4(chiff)"},{number:84,group:"Synth Lead",label:"Lead 5(charang)"},{number:85,group:"Synth Lead",label:"Lead 6(voice)"},{number:86,group:"Synth Lead",label:"Lead 7(fifths)"},{number:87,group:"Synth Lead",label:"Lead 8(bass + lead)"},{number:88,group:"Synth Pad",label:"Pad 1(new age)"},{number:89,group:"Synth Pad",label:"Pad 2(warm)"},{number:90,group:"Synth Pad",label:"Pad 3(polysynth)"},{number:91,group:"Synth Pad",label:"Pad 4(choir)"},{number:92,group:"Synth Pad",label:"Pad 5(bowed)"},{number:93,group:"Synth Pad",label:"Pad 6(metallic)"},{number:94,group:"Synth Pad",label:"Pad 7(halo)"},{number:95,group:"Synth Pad",label:"Pad 8(sweep)"},{number:96,group:"Synth Effects",label:"FX 1(rain)"},{number:97,group:"Synth Effects",label:"FX 2(soundtrack)"},{number:98,group:"Synth Effects",label:"FX 3(crystal)"},{number:99,group:"Synth Effects",label:"FX 4(atmosphere)"},{number:100,group:"Synth Effects",label:"FX 5(brightness)"},{number:101,group:"Synth Effects",label:"FX 6(goblins)"},{number:102,group:"Synth Effects",label:"FX 7(echoes)"},{number:103,group:"Synth Effects",label:"FX 8(sci-fi)"},{number:104,group:"Ethnic",label:"Sitar"},{number:105,group:"Ethnic",label:"Banjo"},{number:106,group:"Ethnic",label:"Shamisen"},{number:107,group:"Ethnic",label:"Koto"},{number:108,group:"Ethnic",label:"Kalimba"},{number:109,group:"Ethnic",label:"Bag pipe"},{number:110,group:"Ethnic",label:"Fiddle"},{number:111,group:"Ethnic",label:"Shanai"},{number:112,group:"Percussive",label:"Tinkle Bell"},{number:113,group:"Percussive",label:"Agogo"},{number:114,group:"Percussive",label:"Steel Drums"},{number:115,group:"Percussive",label:"Woodblock"},{number:116,group:"Percussive",label:"Taiko Drum"},{number:117,group:"Percussive",label:"Melodic Tom"},{number:118,group:"Percussive",label:"Synth Drum"},{number:119,group:"Sound Effects",label:"Reverse Cymbal"},{number:120,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,group:"Sound Effects",label:"Breath Noise"},{number:122,group:"Sound Effects",label:"Seashore"},{number:123,group:"Sound Effects",label:"Bird Tweet"},{number:124,group:"Sound Effects",label:"Telephone Ring"},{number:125,group:"Sound Effects",label:"Helicopter"},{number:126,group:"Sound Effects",label:"Applause"},{number:127,group:"Sound Effects",label:"Gunshot"}],I=[{number:1,subnumber:0,group:"Piano",label:"Acoustic Grand Piano"},{number:1,subnumber:1,group:"Piano",label:"Wide Acoustic Grand"},{number:1,subnumber:2,group:"Piano",label:"Dark Acoustic Grand"},{number:2,subnumber:0,group:"Piano",label:"Bright Acoustic Piano"},{number:2,subnumber:1,group:"Piano",label:"Wide Bright Acoustic"},{number:3,subnumber:0,group:"Piano",label:"Electric Grand Piano"},{number:3,subnumber:1,group:"Piano",label:"Wide Electric Grand"},{number:4,subnumber:0,group:"Piano",label:"Honky-tonk Piano"},{number:4,subnumber:1,group:"Piano",label:"Wide Honky-tonk"},{number:5,subnumber:0,group:"Piano",label:"Rhodes Piano"},{number:5,subnumber:1,group:"Piano",label:"Detuned Electric Piano 1"},{number:5,subnumber:2,group:"Piano",label:"Electric Piano 1 Variation"},{number:5,subnumber:3,group:"Piano",label:"60's Electric Piano"},{number:6,subnumber:0,group:"Piano",label:"Chorused Electric Piano"},{number:6,subnumber:1,group:"Piano",label:"Detuned Electric Piano 2"},{number:6,subnumber:2,group:"Piano",label:"Electric Piano 2 Variation"},{number:6,subnumber:3,group:"Piano",label:"Electric Piano Legend"},{number:6,subnumber:4,group:"Piano",label:"Electric Piano Phase"},{number:7,subnumber:0,group:"Piano",label:"Harpsichord"},{number:7,subnumber:1,group:"Piano",label:"Coupled Harpsichord"},{number:7,subnumber:2,group:"Piano",label:"Wide Harpsichord"},{number:7,subnumber:3,group:"Piano",label:"Open Harpsichord"},{number:8,subnumber:0,group:"Piano",label:"Clavinet"},{number:8,subnumber:1,group:"Piano",label:"Pulse Clavinet"},{number:9,subnumber:0,group:"Chromatic Percussion",label:"Celesta"},{number:10,subnumber:0,group:"Chromatic Percussion",label:"Glockenspiel"},{number:11,subnumber:0,group:"Chromatic Percussion",label:"Music Box"},{number:12,subnumber:0,group:"Chromatic Percussion",label:"Vibraphone"},{number:12,subnumber:1,group:"Chromatic Percussion",label:"Wet Vibraphone"},{number:13,subnumber:0,group:"Chromatic Percussion",label:"Marimba"},{number:13,subnumber:1,group:"Chromatic Percussion",label:"Wide Marimba"},{number:14,subnumber:0,group:"Chromatic Percussion",label:"Xylophone"},{number:15,subnumber:0,group:"Chromatic Percussion",label:"Tubular Bells"},{number:15,subnumber:1,group:"Chromatic Percussion",label:"Church Bells"},{number:15,subnumber:2,group:"Chromatic Percussion",label:"Carillon"},{number:16,subnumber:0,group:"Chromatic Percussion",label:"Dulcimer / Santur"},{number:17,subnumber:0,group:"Organ",label:"Hammond Organ"},{number:17,subnumber:1,group:"Organ",label:"Detuned Organ 1"},{number:17,subnumber:2,group:"Organ",label:"60's Organ 1"},{number:17,subnumber:3,group:"Organ",label:"Organ 4"},{number:18,subnumber:0,group:"Organ",label:"Percussive Organ"},{number:18,subnumber:1,group:"Organ",label:"Detuned Organ 2"},{number:18,subnumber:2,group:"Organ",label:"Organ 5"},{number:19,subnumber:0,group:"Organ",label:"Rock Organ"},{number:20,subnumber:0,group:"Organ",label:"Church Organ 1"},{number:20,subnumber:1,group:"Organ",label:"Church Organ 2"},{number:20,subnumber:2,group:"Organ",label:"Church Organ 3"},{number:21,subnumber:0,group:"Organ",label:"Reed Organ"},{number:21,subnumber:1,group:"Organ",label:"Puff Organ"},{number:22,subnumber:0,group:"Organ",label:"French Accordion"},{number:22,subnumber:1,group:"Organ",label:"Italian Accordion"},{number:23,subnumber:0,group:"Organ",label:"Harmonica"},{number:24,subnumber:0,group:"Organ",label:"Bandoneon"},{number:25,subnumber:0,group:"Guitar",label:"Nylon-String Guitar"},{number:25,subnumber:1,group:"Guitar",label:"Ukelele"},{number:25,subnumber:2,group:"Guitar",label:"Open Nylon Guitar"},{number:25,subnumber:3,group:"Guitar",label:"Nylon Guitar 2"},{number:26,subnumber:0,group:"Guitar",label:"Steel-String Guitar"},{number:26,subnumber:1,group:"Guitar",label:"12-String Guitar"},{number:26,subnumber:2,group:"Guitar",label:"Mandolin"},{number:26,subnumber:3,group:"Guitar",label:"Steel + Body"},{number:27,subnumber:0,group:"Guitar",label:"Jazz Guitar"},{number:27,subnumber:1,group:"Guitar",label:"Hawaiian Guitar"},{number:28,subnumber:0,group:"Guitar",label:"Clean Electric Guitar"},{number:28,subnumber:1,group:"Guitar",label:"Chorus Guitar"},{number:28,subnumber:2,group:"Guitar",label:"Mid Tone Guitar"},{number:29,subnumber:0,group:"Guitar",label:"Muted Electric Guitar"},{number:29,subnumber:1,group:"Guitar",label:"Funk Guitar"},{number:29,subnumber:2,group:"Guitar",label:"Funk Guitar 2"},{number:29,subnumber:3,group:"Guitar",label:"Jazz Man"},{number:30,subnumber:0,group:"Guitar",label:"Overdriven Guitar"},{number:30,subnumber:1,group:"Guitar",label:"Guitar Pinch"},{number:31,subnumber:0,group:"Guitar",label:"Distortion Guitar"},{number:31,subnumber:1,group:"Guitar",label:"Feedback Guitar"},{number:31,subnumber:2,group:"Guitar",label:"Distortion Rtm Guitar"},{number:32,subnumber:0,group:"Guitar",label:"Guitar Harmonics"},{number:32,subnumber:1,group:"Guitar",label:"Guitar Feedback"},{number:33,subnumber:0,group:"Bass",label:"Acoustic Bass"},{number:34,subnumber:0,group:"Bass",label:"Fingered Bass"},{number:34,subnumber:1,group:"Bass",label:"Finger Slap"},{number:35,subnumber:0,group:"Bass",label:"Picked Bass"},{number:36,subnumber:0,group:"Bass",label:"Fretless Bass"},{number:37,subnumber:0,group:"Bass",label:"Slap Bass 1"},{number:38,subnumber:0,group:"Bass",label:"Slap Bass 2"},{number:39,subnumber:0,group:"Bass",label:"Synth Bass 1"},{number:39,subnumber:1,group:"Bass",label:"Synth Bass 101"},{number:39,subnumber:2,group:"Bass",label:"Synth Bass 3"},{number:39,subnumber:3,group:"Bass",label:"Clavi Bass"},{number:39,subnumber:4,group:"Bass",label:"Hammer"},{number:40,subnumber:0,group:"Bass",label:"Synth Bass 2"},{number:40,subnumber:1,group:"Bass",label:"Synth Bass 4"},{number:40,subnumber:2,group:"Bass",label:"Rubber Bass"},{number:40,subnumber:3,group:"Bass",label:"Attack Pulse"},{number:41,subnumber:0,group:"Strings",label:"Violin"},{number:41,subnumber:1,group:"Strings",label:"Slow Violin"},{number:42,subnumber:0,group:"Strings",label:"Viola"},{number:43,subnumber:0,group:"Strings",label:"Cello"},{number:44,subnumber:0,group:"Strings",label:"Contrabass"},{number:45,subnumber:0,group:"Strings",label:"Tremolo Strings"},{number:46,subnumber:0,group:"Strings",label:"Pizzicato Strings"},{number:47,subnumber:0,group:"Strings",label:"Harp"},{number:47,subnumber:1,group:"Strings",label:"Yang Qin"},{number:48,subnumber:0,group:"Strings",label:"Timpani"},{number:49,subnumber:0,group:"Orchestral Ensemble",label:"String Ensemble"},{number:49,subnumber:1,group:"Orchestral Ensemble",label:"Orchestra Strings"},{number:49,subnumber:2,group:"Orchestral Ensemble",label:"60's Strings"},{number:50,subnumber:0,group:"Orchestral Ensemble",label:"Slow String Ensemble"},{number:51,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 1"},{number:51,subnumber:1,group:"Orchestral Ensemble",label:"Synth Strings 3"},{number:52,subnumber:0,group:"Orchestral Ensemble",label:"Synth Strings 2"},{number:53,subnumber:0,group:"Orchestral Ensemble",label:"Choir Aahs"},{number:53,subnumber:1,group:"Orchestral Ensemble",label:"Choir Aahs 2"},{number:54,subnumber:0,group:"Orchestral Ensemble",label:"Voice Oohs"},{number:54,subnumber:1,group:"Orchestral Ensemble",label:"Humming"},{number:55,subnumber:0,group:"Orchestral Ensemble",label:"Synth Voice"},{number:55,subnumber:1,group:"Orchestral Ensemble",label:"Analog Voice"},{number:56,subnumber:0,group:"Orchestral Ensemble",label:"Orchestra Hit"},{number:56,subnumber:1,group:"Orchestral Ensemble",label:"Bass Hit"},{number:56,subnumber:2,group:"Orchestral Ensemble",label:"6th Hit"},{number:56,subnumber:3,group:"Orchestral Ensemble",label:"Euro Hit"},{number:57,subnumber:0,group:"Brass",label:"Trumpet"},{number:57,subnumber:1,group:"Brass",label:"Dark Trumpet"},{number:58,subnumber:0,group:"Brass",label:"Trombone"},{number:58,subnumber:1,group:"Brass",label:"Trombone 2"},{number:58,subnumber:2,group:"Brass",label:"Bright Trombone"},{number:59,subnumber:0,group:"Brass",label:"Tuba"},{number:60,subnumber:0,group:"Brass",label:"Muted Trumpet"},{number:60,subnumber:1,group:"Brass",label:"Muted Trumpet 2"},{number:61,subnumber:0,group:"Brass",label:"French Horn"},{number:61,subnumber:1,group:"Brass",label:"French Horn 2"},{number:62,subnumber:0,group:"Brass",label:"Brass Section"},{number:62,subnumber:1,group:"Brass",label:"Brass Section"},{number:63,subnumber:0,group:"Brass",label:"Synth Brass 1"},{number:63,subnumber:1,group:"Brass",label:"Synth Brass 3"},{number:63,subnumber:2,group:"Brass",label:"Analog Brass 1"},{number:63,subnumber:3,group:"Brass",label:"Jump Brass"},{number:64,subnumber:0,group:"Brass",label:"Synth Brass 2"},{number:64,subnumber:1,group:"Brass",label:"Synth Brass 4"},{number:64,subnumber:2,group:"Brass",label:"Analog Brass 2"},{number:65,subnumber:0,group:"Reed",label:"Soprano Sax"},{number:66,subnumber:0,group:"Reed",label:"Alto Sax"},{number:67,subnumber:0,group:"Reed",label:"Tenor Sax"},{number:68,subnumber:0,group:"Reed",label:"Baritone Sax"},{number:69,subnumber:0,group:"Reed",label:"Oboe"},{number:70,subnumber:0,group:"Reed",label:"English Horn"},{number:71,subnumber:0,group:"Reed",label:"Bassoon"},{number:72,subnumber:0,group:"Reed",label:"Clarinet"},{number:73,subnumber:0,group:"Wind",label:"Piccolo"},{number:74,subnumber:0,group:"Wind",label:"Flute"},{number:75,subnumber:0,group:"Wind",label:"Recorder"},{number:76,subnumber:0,group:"Wind",label:"Pan Flute"},{number:77,subnumber:0,group:"Wind",label:"Blown Bottle"},{number:78,subnumber:0,group:"Wind",label:"Shakuhachi"},{number:79,subnumber:0,group:"Wind",label:"Whistle"},{number:80,subnumber:0,group:"Wind",label:"Ocarina"},{number:81,subnumber:0,group:"Lead",label:"Square Lead"},{number:81,subnumber:1,group:"Lead",label:"Square Wave"},{number:81,subnumber:2,group:"Lead",label:"Sine Wave"},{number:82,subnumber:0,group:"Lead",label:"Saw Lead"},{number:82,subnumber:1,group:"Lead",label:"Saw Wave"},{number:82,subnumber:2,group:"Lead",label:"Doctor Solo"},{number:82,subnumber:3,group:"Lead",label:"Natural Lead"},{number:82,subnumber:4,group:"Lead",label:"Sequenced Saw"},{number:83,subnumber:0,group:"Lead",label:"Synth Calliope"},{number:84,subnumber:0,group:"Lead",label:"Chiffer Lead"},{number:85,subnumber:0,group:"Lead",label:"Charang"},{number:85,subnumber:1,group:"Lead",label:"Wire Lead"},{number:86,subnumber:0,group:"Lead",label:"Solo Synth Vox"},{number:87,subnumber:0,group:"Lead",label:"5th Saw Wave"},{number:88,subnumber:0,group:"Lead",label:"Bass & Lead"},{number:88,subnumber:1,group:"Lead",label:"Delayed Lead"},{number:89,subnumber:0,group:"Synth Pad",label:"Fantasia Pad"},{number:90,subnumber:0,group:"Synth Pad",label:"Warm Pad"},{number:90,subnumber:1,group:"Synth Pad",label:"Sine Pad"},{number:91,subnumber:0,group:"Synth Pad",label:"Polysynth Pad"},{number:92,subnumber:0,group:"Synth Pad",label:"Space Voice Pad"},{number:92,subnumber:1,group:"Synth Pad",label:"Itopia"},{number:93,subnumber:0,group:"Synth Pad",label:"Bowed Glass Pad"},{number:94,subnumber:0,group:"Synth Pad",label:"Metal Pad"},{number:95,subnumber:0,group:"Synth Pad",label:"Halo Pad"},{number:96,subnumber:0,group:"Synth Pad",label:"Sweep Pad"},{number:97,subnumber:0,group:"Synth Effects",label:"Ice Rain"},{number:98,subnumber:0,group:"Synth Effects",label:"Soundtrack"},{number:99,subnumber:0,group:"Synth Effects",label:"Crystal"},{number:99,subnumber:1,group:"Synth Effects",label:"Synth Mallet"},{number:100,subnumber:0,group:"Synth Effects",label:"Atmosphere"},{number:101,subnumber:0,group:"Synth Effects",label:"Brightness"},{number:102,subnumber:0,group:"Synth Effects",label:"Goblin"},{number:103,subnumber:0,group:"Synth Effects",label:"Echo Drops"},{number:103,subnumber:1,group:"Synth Effects",label:"Echo Bell"},{number:103,subnumber:2,group:"Synth Effects",label:"Echo Pan"},{number:104,subnumber:0,group:"Synth Effects",label:"Star Theme"},{number:105,subnumber:0,group:"Ethnic",label:"Sitar"},{number:105,subnumber:1,group:"Ethnic",label:"Sitar 2"},{number:106,subnumber:0,group:"Ethnic",label:"Banjo"},{number:107,subnumber:0,group:"Ethnic",label:"Shamisen"},{number:108,subnumber:0,group:"Ethnic",label:"Koto"},{number:108,subnumber:1,group:"Ethnic",label:"Taisho Koto"},{number:109,subnumber:0,group:"Ethnic",label:"Kalimba"},{number:110,subnumber:0,group:"Ethnic",label:"Bagpipe"},{number:111,subnumber:0,group:"Ethnic",label:"Fiddle"},{number:112,subnumber:0,group:"Ethnic",label:"Shanai"},{number:113,subnumber:0,group:"Percussive",label:"Tinkle Bell"},{number:114,subnumber:0,group:"Percussive",label:"Agogo"},{number:115,subnumber:0,group:"Percussive",label:"Steel Drums"},{number:116,subnumber:0,group:"Percussive",label:"Woodblock"},{number:116,subnumber:1,group:"Percussive",label:"Castanets"},{number:117,subnumber:0,group:"Percussive",label:"Taiko Drum"},{number:117,subnumber:1,group:"Percussive",label:"Concert Bass Drum"},{number:118,subnumber:0,group:"Percussive",label:"Melodic Tom 1"},{number:118,subnumber:1,group:"Percussive",label:"Melodic Tom 2"},{number:119,subnumber:0,group:"Percussive",label:"Synth Drum"},{number:119,subnumber:1,group:"Percussive",label:"808 Tom"},{number:119,subnumber:2,group:"Percussive",label:"Electric Percussion"},{number:120,subnumber:0,group:"Percussive",label:"Reverse Cymbal"},{number:121,subnumber:0,group:"Sound Effects",label:"Guitar Fret Noise"},{number:121,subnumber:1,group:"Sound Effects",label:"Guitar Cut Noise"},{number:121,subnumber:2,group:"Sound Effects",label:"String Slap"},{number:122,subnumber:0,group:"Sound Effects",label:"Breath Noise"},{number:122,subnumber:1,group:"Sound Effects",label:"Flute Key Click"},{number:123,subnumber:0,group:"Sound Effects",label:"Seashore"},{number:123,subnumber:1,group:"Sound Effects",label:"Rain"},{number:123,subnumber:2,group:"Sound Effects",label:"Thunder"},{number:123,subnumber:3,group:"Sound Effects",label:"Wind"},{number:123,subnumber:4,group:"Sound Effects",label:"Stream"},{number:123,subnumber:5,group:"Sound Effects",label:"Bubble"},{number:124,subnumber:0,group:"Sound Effects",label:"Bird Tweet"},{number:124,subnumber:1,group:"Sound Effects",label:"Dog"},{number:124,subnumber:2,group:"Sound Effects",label:"Horse Gallop"},{number:124,subnumber:3,group:"Sound Effects",label:"Bird 2"},{number:125,subnumber:0,group:"Sound Effects",label:"Telephone 1"},{number:125,subnumber:1,group:"Sound Effects",label:"Telephone 2"},{number:125,subnumber:2,group:"Sound Effects",label:"Door Creaking"},{number:125,subnumber:3,group:"Sound Effects",label:"Door Closing"},{number:125,subnumber:4,group:"Sound Effects",label:"Scratch"},{number:125,subnumber:5,group:"Sound Effects",label:"Wind Chimes"},{number:126,subnumber:0,group:"Sound Effects",label:"Helicopter"},{number:126,subnumber:1,group:"Sound Effects",label:"Car Engine"},{number:126,subnumber:2,group:"Sound Effects",label:"Car Stop"},{number:126,subnumber:3,group:"Sound Effects",label:"Car Pass"},{number:126,subnumber:4,group:"Sound Effects",label:"Car Crash"},{number:126,subnumber:5,group:"Sound Effects",label:"Siren"},{number:126,subnumber:6,group:"Sound Effects",label:"Train"},{number:126,subnumber:7,group:"Sound Effects",label:"Jetplane"},{number:126,subnumber:8,group:"Sound Effects",label:"Starship"},{number:126,subnumber:9,group:"Sound Effects",label:"Burst Noise"},{number:127,subnumber:0,group:"Sound Effects",label:"Applause"},{number:127,subnumber:1,group:"Sound Effects",label:"Laughing"},{number:127,subnumber:2,group:"Sound Effects",label:"Screaming"},{number:127,subnumber:3,group:"Sound Effects",label:"Punch"},{number:127,subnumber:4,group:"Sound Effects",label:"Heart Beat"},{number:127,subnumber:5,group:"Sound Effects",label:"Footsteps"},{number:128,subnumber:0,group:"Sound Effects",label:"Gun Shot"},{number:128,subnumber:1,group:"Sound Effects",label:"Machine Gun"},{number:128,subnumber:2,group:"Sound Effects",label:"Lasergun"},{number:128,subnumber:3,group:"Sound Effects",label:"Explosion"}],O=new Map([[27,"High Q(GM2)"],[28,"Slap(GM2)"],[29,"Scratch Push(GM2)"],[30,"Scratch Pull(GM2)"],[31,"Sticks(GM2)"],[32,"Square Click(GM2)"],[33,"Metronome Click(GM2)"],[34,"Metronome Bell(GM2)"],[35,"Bass Drum 2"],[36,"Bass Drum 1"],[37,"Side Stick"],[38,"Snare Drum 1"],[39,"Hand Clap"],[40,"Snare Drum 2"],[41,"Low Tom 2"],[42,"Closed Hi-hat"],[43,"Low Tom 1"],[44,"Pedal Hi-hat"],[45,"Mid Tom 2"],[46,"Open Hi-hat"],[47,"Mid Tom 1"],[48,"High Tom 2"],[49,"Crash Cymbal 1"],[50,"High Tom 1"],[51,"Ride Cymbal 1"],[52,"Chinese Cymbal"],[53,"Ride Bell"],[54,"Tambourine"],[55,"Splash Cymbal"],[56,"Cowbell"],[57,"Crash Cymbal 2"],[58,"Vibra Slap"],[59,"Ride Cymbal 2"],[60,"High Bongo"],[61,"Low Bongo"],[62,"Mute High Conga"],[63,"Open High Conga"],[64,"Low Conga"],[65,"High Timbale"],[66,"Low Timbale"],[67,"High Agogo"],[68,"Low Agogo"],[69,"Cabasa"],[70,"Maracas"],[71,"Short Whistle"],[72,"Long Whistle"],[73,"Short Guiro"],[74,"Long Guiro"],[75,"Claves"],[76,"High Wood Block"],[77,"Low Wood Block"],[78,"Mute Cuica"],[79,"Open Cuica"],[80,"Mute Triangle"],[81,"Open Triangle"],[82,"Shaker(GM2)"],[83,"Jingle Bell(GM2)"],[84,"Belltree(GM2)"],[85,"Castanets(GM2)"],[86,"Mute Surdo(GM2)"],[87,"Open Surdo(GM2)"]]),F=[{instrNr:40,nrL2:-1,subNrL2:-1,label:"Violin",min:55,max:103},{instrNr:41,nrL2:-1,subNrL2:-1,label:"Viola",min:48,max:91},{instrNr:42,nrL2:-1,subNrL2:-1,label:"Cello",min:36,max:76},{instrNr:-1,nrL2:-1,subNrL2:-1,label:"Double Bass",min:28,max:67},{instrNr:-1,nrL2:-1,subNrL2:-1,label:"Bass Guitar",min:28,max:67},{instrNr:-1,nrL2:-1,subNrL2:-1,label:"Acoustic Guitar",min:40,max:88},{instrNr:58,nrL2:59,subNrL2:0,label:"Tuba",min:28,max:58},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Bass Trombone",min:34,max:67},{instrNr:0,nrL2:-1,subNrL2:-1,label:"French Horn",min:34,max:77},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Trombone",min:40,max:72},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Trumpet",min:55,max:82},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Piccolo",min:74,max:102},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Flute",min:60,max:96},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Oboe",min:58,max:91},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Alto Flute",min:55,max:91},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Cor Anglais (English Horn)",min:52,max:81},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Clarinet",min:50,max:94},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Bass Clarinet",min:38,max:77},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Bassoon",min:34,max:75},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Contrabassoon",min:22,max:53},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Soprano Recorder",min:72,max:98},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Alto Recorder",min:65,max:91},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Tenor Recorder",min:60,max:86},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Bass Recorder",min:53,max:79},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Baritone Sax",min:36,max:69},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Tenor Sax",min:44,max:76},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Alto Sax",min:49,max:81},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Soprano Sax",min:56,max:88},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Glockenspiel",min:79,max:108},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Xylophone",min:65,max:108},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Vibraphone",min:53,max:89},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Marimba",min:45,max:96},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Bass Marimba",min:33,max:81},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Celeste",min:60,max:108},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Tubular Bells",min:60,max:77},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Timpani",min:40,max:55},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Harpsichord",min:29,max:89},{instrNr:0,nrL2:-1,subNrL2:-1,label:"Harp",min:24,max:103}];for(let e of D)M.set(e.pitch,e),P.set(e.label,e);for(let e of L)w.set(e.number,e);for(let e of I){const t=`${e.number}-${e.subnumber}`;S.set(t,e)}class j{constructor(e=0,t=0,n=127,r=0,i=null){this.pitch=e,this.start=t,this.velocity=n,this.channel=r,this.end=i}static from(e){const{pitch:t=0,start:n=0,velocity:r=127,channel:i=0,end:a=null}=e;return new j(t,n,r,i,a)}clone(){return new j(this.pitch,this.start,this.velocity,this.channel,this.end)}getDuration(){return null===this.end?0:this.end-this.start}getName(){return A(this.pitch).label}getLetter(){return A(this.pitch).name}getOctave(){return A(this.pitch).octave}shiftTime(e){const t=this.clone();return t.start+=e,t.end=null===t.end?null:t.end+e,t}scaleTime(e){const t=this.clone();return t.start*=e,t.end=null===t.end?null:t.end*e,t}overlapsInTime(e){return this.start>=e.start&&this.start<=e.end||this.end>=e.start&&this.end<=e.end}equals(e){return e instanceof j&&this.pitch===e.pitch&&this.start===e.start&&this.velocity===e.velocity&&this.channel===e.channel&&this.end===e.end}}class $ extends j{constructor(e=0,t=0,n=127,r=0,i=null,a=null,o=null){super(e,t,n,r,i),this.string=a,this.fret=o}static from(e){const{pitch:t=0,start:n=0,velocity:r=127,channel:i=0,end:a=null,string:o=null,fret:s=null}=e;return new $(t,n,r,i,a,o,s)}static fromNote(e,t,n){return new $(e.pitch,e.start,e.velocity,e.channel,e.end,t,n)}toNote(){return new j(this.pitch,this.start,this.velocity,this.channel,this.end)}clone(){return new $(this.pitch,this.start,this.velocity,this.channel,this.end,this.string,this.fret)}equals(e){return e instanceof $&&this.pitch===e.pitch&&this.start===e.start&&this.velocity===e.velocity&&this.channel===e.channel&&this.end===e.end&&this.string===e.string&&this.fret===e.fret}}function R(e,t){let n,r;if(void 0===t)for(const t of e)null!=t&&(void 0===n?t>=t&&(n=r=t):(n>t&&(n=t),r<t&&(r=t)));else{let i=-1;for(let a of e)null!=(a=t(a,++i,e))&&(void 0===n?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)))}return[n,r]}function H(e){return e}function V(e,...t){return function(e,t,n,r){return function e(i,a){if(a>=r.length)return n(i);const o=new Map,s=r[a++];let u=-1;for(const e of i){const t=s(e,++u,i),n=o.get(t);n?n.push(e):o.set(t,[e])}for(const[t,n]of o)o.set(t,e(n,a));return t(o)}(e,0)}(e,H,H,t)}function W(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function z(e,t){let n=0,r=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++n,r+=t);else{let i=-1;for(let a of e)null!=(a=t(a,++i,e))&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}function X(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function U(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Y(e,t,n=0,r=e.length-1,i=U){for(;r>n;){if(r-n>600){const a=r-n+1,o=t-n+1,s=Math.log(a),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(a-u)/a)*(o-a/2<0?-1:1);Y(e,t,Math.max(n,Math.floor(t-o*u/a+l)),Math.min(r,Math.floor(t+(a-o)*u/a+l)),i)}const a=e[t];let o=n,s=r;for(J(e,n,t),i(e[r],a)>0&&J(e,n,r);o<s;){for(J(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}0===i(e[n],a)?J(e,n,s):(++s,J(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function J(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function K(e,t,n){if(r=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n))).length){if((t=+t)<=0||r<2)return X(e);if(t>=1)return W(e);var r,i=(r-1)*t,a=Math.floor(i),o=W(Y(e,a).subarray(0,a+1));return o+(X(e.subarray(a+1))-o)*(i-a)}}function Q(){}function Z(e){return null==e?Q:function(){return this.querySelector(e)}}function ee(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function te(){return[]}function ne(e){return null==e?te:function(){return this.querySelectorAll(e)}}function re(e){return function(){return this.matches(e)}}function ie(e){return function(t){return t.matches(e)}}var ae=Array.prototype.find;function oe(){return this.firstElementChild}var se=Array.prototype.filter;function ue(){return this.children}function le(e){return new Array(e.length)}function ce(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function he(e){return function(){return e}}function me(e,t,n,r,i,a){for(var o,s=0,u=t.length,l=a.length;s<l;++s)(o=t[s])?(o.__data__=a[s],r[s]=o):n[s]=new ce(e,a[s]);for(;s<u;++s)(o=t[s])&&(i[s]=o)}function fe(e,t,n,r,i,a,o){var s,u,l,c=new Map,h=t.length,m=a.length,f=new Array(h);for(s=0;s<h;++s)(u=t[s])&&(f[s]=l=o.call(u,u.__data__,s,t)+"",c.has(l)?i[s]=u:c.set(l,u));for(s=0;s<m;++s)l=o.call(e,a[s],s,a)+"",(u=c.get(l))?(r[s]=u,u.__data__=a[s],c.delete(l)):n[s]=new ce(e,a[s]);for(s=0;s<h;++s)(u=t[s])&&c.get(f[s])===u&&(i[s]=u)}function pe(e){return e.__data__}function be(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}ce.prototype={constructor:ce,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var de="http://www.w3.org/1999/xhtml";const ge={svg:"http://www.w3.org/2000/svg",xhtml:de,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ye(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),ge.hasOwnProperty(t)?{space:ge[t],local:e}:e}function ve(e){return function(){this.removeAttribute(e)}}function Me(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Pe(e,t){return function(){this.setAttribute(e,t)}}function we(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Se(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Ae(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function xe(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function _e(e){return function(){this.style.removeProperty(e)}}function Te(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ee(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Ne(e,t){return e.style.getPropertyValue(t)||xe(e).getComputedStyle(e,null).getPropertyValue(t)}function Ce(e){return function(){delete this[e]}}function ke(e,t){return function(){this[e]=t}}function Be(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function De(e){return e.trim().split(/^|\s+/)}function qe(e){return e.classList||new Ge(e)}function Ge(e){this._node=e,this._names=De(e.getAttribute("class")||"")}function Le(e,t){for(var n=qe(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Ie(e,t){for(var n=qe(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Oe(e){return function(){Le(this,e)}}function Fe(e){return function(){Ie(this,e)}}function je(e,t){return function(){(t.apply(this,arguments)?Le:Ie)(this,e)}}function $e(){this.textContent=""}function Re(e){return function(){this.textContent=e}}function He(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Ve(){this.innerHTML=""}function We(e){return function(){this.innerHTML=e}}function ze(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function Xe(){this.nextSibling&&this.parentNode.appendChild(this)}function Ue(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ye(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===de&&t.documentElement.namespaceURI===de?t.createElement(e):t.createElementNS(n,e)}}function Je(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ke(e){var t=ye(e);return(t.local?Je:Ye)(t)}function Qe(){return null}function Ze(){var e=this.parentNode;e&&e.removeChild(this)}function et(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function tt(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function nt(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function rt(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,a=t.length;r<a;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function it(e,t,n){return function(){var r,i=this.__on,a=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var o=0,s=i.length;o<s;++o)if((r=i[o]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=t);this.addEventListener(e.type,a,n),r={type:e.type,name:e.name,value:t,listener:a,options:n},i?i.push(r):this.__on=[r]}}function at(e,t,n){var r=xe(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function ot(e,t){return function(){return at(this,e,t)}}function st(e,t){return function(){return at(this,e,t.apply(this,arguments))}}Ge.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var ut=[null];function lt(e,t){this._groups=e,this._parents=t}function ct(){return new lt([[document.documentElement]],ut)}lt.prototype=ct.prototype={constructor:lt,select:function(e){"function"!=typeof e&&(e=Z(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=t[i],u=s.length,l=r[i]=new Array(u),c=0;c<u;++c)(a=s[c])&&(o=e.call(a,a.__data__,c,s))&&("__data__"in a&&(o.__data__=a.__data__),l[c]=o);return new lt(r,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);return null==t?[]:ee(t)}}(e):ne(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o,s=t[a],u=s.length,l=0;l<u;++l)(o=s[l])&&(r.push(e.call(o,o.__data__,l,s)),i.push(o));return new lt(r,i)},selectChild:function(e){return this.select(null==e?oe:function(e){return function(){return ae.call(this.children,e)}}("function"==typeof e?e:ie(e)))},selectChildren:function(e){return this.selectAll(null==e?ue:function(e){return function(){return se.call(this.children,e)}}("function"==typeof e?e:ie(e)))},filter:function(e){"function"!=typeof e&&(e=re(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,u=r[i]=[],l=0;l<s;++l)(a=o[l])&&e.call(a,a.__data__,l,o)&&u.push(a);return new lt(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,pe);var n=t?fe:me,r=this._parents,i=this._groups;"function"!=typeof e&&(e=he(e));for(var a=i.length,o=new Array(a),s=new Array(a),u=new Array(a),l=0;l<a;++l){var c=r[l],h=i[l],m=h.length,f=ee(e.call(c,c&&c.__data__,l,r)),p=f.length,b=s[l]=new Array(p),d=o[l]=new Array(p),g=u[l]=new Array(m);n(c,h,b,d,g,f,t);for(var y,v,M=0,P=0;M<p;++M)if(y=b[M]){for(M>=P&&(P=M+1);!(v=d[P])&&++P<p;);y._next=v||null}}return(o=new lt(o,r))._enter=s,o._exit=u,o},enter:function(){return new lt(this._enter||this._groups.map(le),this._parents)},exit:function(){return new lt(this._exit||this._groups.map(le),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,a=this.exit();return r="function"==typeof e?e(r):r.append(e+""),null!=t&&(i=t(i)),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(e){if(!(e instanceof lt))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u,l=t[s],c=n[s],h=l.length,m=o[s]=new Array(h),f=0;f<h;++f)(u=l[f]||c[f])&&(m[f]=u);for(;s<r;++s)o[s]=t[s];return new lt(o,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=be);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],u=s.length,l=i[a]=new Array(u),c=0;c<u;++c)(o=s[c])&&(l[c]=o);l.sort(t)}return new lt(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,a=t[n],o=0,s=a.length;o<s;++o)(i=a[o])&&e.call(i,i.__data__,o,a);return this},attr:function(e,t){var n=ye(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?Me:ve:"function"==typeof t?n.local?Ae:Se:n.local?we:Pe)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?_e:"function"==typeof t?Ee:Te)(e,t,null==n?"":n)):Ne(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Ce:"function"==typeof t?Be:ke)(e,t)):this.node()[e]},classed:function(e,t){var n=De(e+"");if(arguments.length<2){for(var r=qe(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?je:t?Oe:Fe)(n,t))},text:function(e){return arguments.length?this.each(null==e?$e:("function"==typeof e?He:Re)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Ve:("function"==typeof e?ze:We)(e)):this.node().innerHTML},raise:function(){return this.each(Xe)},lower:function(){return this.each(Ue)},append:function(e){var t="function"==typeof e?e:Ke(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:Ke(e),r=null==t?Qe:"function"==typeof t?t:Z(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Ze)},clone:function(e){return this.select(e?tt:et)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,a=nt(e+""),o=a.length;if(!(arguments.length<2)){for(s=t?it:rt,r=0;r<o;++r)this.each(s(a[r],t,n));return this}var s=this.node().__on;if(s)for(var u,l=0,c=s.length;l<c;++l)for(r=0,u=s[l];r<o;++r)if((i=a[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(e,t){return this.each(("function"==typeof t?st:ot)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],a=0,o=i.length;a<o;++a)(r=i[a])&&(yield r)}};const ht=ct;var mt={value:()=>{}};function ft(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new pt(r)}function pt(e){this._=e}function bt(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function dt(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function gt(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=mt,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}pt.prototype=ft.prototype={constructor:pt,on:function(e,t){var n,r=this._,i=bt(e+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++a<o;)if(n=(e=i[a]).type)r[n]=gt(r[n],e.name,t);else if(null==t)for(n in r)r[n]=gt(r[n],e.name,null);return this}for(;++a<o;)if((n=(e=i[a]).type)&&(n=dt(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new pt(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=0,n=(r=this._[e]).length;a<n;++a)r[a].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};const yt=ft;var vt,Mt,Pt=0,wt=0,St=0,At=0,xt=0,_t=0,Tt="object"==typeof performance&&performance.now?performance:Date,Et="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Nt(){return xt||(Et(Ct),xt=Tt.now()+_t)}function Ct(){xt=0}function kt(){this._call=this._time=this._next=null}function Bt(e,t,n){var r=new kt;return r.restart(e,t,n),r}function Dt(){xt=(At=Tt.now())+_t,Pt=wt=0;try{!function(){Nt(),++Pt;for(var e,t=vt;t;)(e=xt-t._time)>=0&&t._call.call(null,e),t=t._next;--Pt}()}finally{Pt=0,function(){for(var e,t,n=vt,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:vt=t);Mt=e,Gt(r)}(),xt=0}}function qt(){var e=Tt.now(),t=e-At;t>1e3&&(_t-=t,At=e)}function Gt(e){Pt||(wt&&(wt=clearTimeout(wt)),e-xt>24?(e<1/0&&(wt=setTimeout(Dt,e-Tt.now()-_t)),St&&(St=clearInterval(St))):(St||(At=Tt.now(),St=setInterval(qt,1e3)),Pt=1,Et(Dt)))}function Lt(e,t,n){var r=new kt;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}kt.prototype=Bt.prototype={constructor:kt,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?Nt():+n)+(null==t?0:+t),this._next||Mt===this||(Mt?Mt._next=this:vt=this,Mt=this),this._call=e,this._time=n,Gt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Gt())}};var It=yt("start","end","cancel","interrupt"),Ot=[];function Ft(e,t,n,r,i,a){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function a(u){var l,c,h,m;if(1!==n.state)return s();for(l in i)if((m=i[l]).name===n.name){if(3===m.state)return Lt(a);4===m.state?(m.state=6,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete i[l]):+l<t&&(m.state=6,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete i[l])}if(Lt((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(u))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),l=0,c=-1;l<h;++l)(m=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(r[++c]=m);r.length=c+1}}function o(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=Bt((function(e){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=e&&a(e-n.delay)}),0,n.time)}(e,n,{name:t,index:r,group:i,on:It,tween:Ot,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function jt(e,t){var n=Rt(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function $t(e,t){var n=Rt(e,t);if(n.state>3)throw new Error("too late; already running");return n}function Rt(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Ht(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Vt,Wt=180/Math.PI,zt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Xt(e,t,n,r,i,a){var o,s,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Wt,skewX:Math.atan(u)*Wt,scaleX:o,scaleY:s}}function Ut(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(a,o){var s=[],u=[];return a=e(a),o=e(o),function(e,r,i,a,o,s){if(e!==i||r!==a){var u=o.push("translate(",null,t,null,n);s.push({i:u-4,x:Ht(e,i)},{i:u-2,x:Ht(r,a)})}else(i||a)&&o.push("translate("+i+t+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,u),function(e,t,n,a){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Ht(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(a.rotate,o.rotate,s,u),function(e,t,n,a){e!==t?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Ht(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(a.skewX,o.skewX,s,u),function(e,t,n,r,a,o){if(e!==n||t!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:Ht(e,n)},{i:s-2,x:Ht(t,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,u),a=o=null,function(e){for(var t,n=-1,r=u.length;++n<r;)s[(t=u[n]).i]=t.x(e);return s.join("")}}}var Yt=Ut((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?zt:Xt(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Jt=Ut((function(e){return null==e?zt:(Vt||(Vt=document.createElementNS("http://www.w3.org/2000/svg","g")),Vt.setAttribute("transform",e),(e=Vt.transform.baseVal.consolidate())?Xt((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):zt)}),", ",")",")");function Kt(e,t){var n,r;return function(){var i=$t(this,e),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===t){(r=r.slice()).splice(o,1);break}i.tween=r}}function Qt(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=$t(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===t){i[u]=s;break}u===l&&i.push(s)}a.tween=i}}function Zt(e,t,n){var r=e._id;return e.each((function(){var e=$t(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return Rt(e,r).value[t]}}function en(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function tn(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function nn(){}var rn=.7,an=1/rn,on="\\s*([+-]?\\d+)\\s*",sn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",un="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ln=/^#([0-9a-f]{3,8})$/,cn=new RegExp("^rgb\\("+[on,on,on]+"\\)$"),hn=new RegExp("^rgb\\("+[un,un,un]+"\\)$"),mn=new RegExp("^rgba\\("+[on,on,on,sn]+"\\)$"),fn=new RegExp("^rgba\\("+[un,un,un,sn]+"\\)$"),pn=new RegExp("^hsl\\("+[sn,un,un]+"\\)$"),bn=new RegExp("^hsla\\("+[sn,un,un,sn]+"\\)$"),dn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function gn(){return this.rgb().formatHex()}function yn(){return this.rgb().formatRgb()}function vn(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ln.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Mn(t):3===n?new An(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Pn(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Pn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=cn.exec(e))?new An(t[1],t[2],t[3],1):(t=hn.exec(e))?new An(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=mn.exec(e))?Pn(t[1],t[2],t[3],t[4]):(t=fn.exec(e))?Pn(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=pn.exec(e))?En(t[1],t[2]/100,t[3]/100,1):(t=bn.exec(e))?En(t[1],t[2]/100,t[3]/100,t[4]):dn.hasOwnProperty(e)?Mn(dn[e]):"transparent"===e?new An(NaN,NaN,NaN,0):null}function Mn(e){return new An(e>>16&255,e>>8&255,255&e,1)}function Pn(e,t,n,r){return r<=0&&(e=t=n=NaN),new An(e,t,n,r)}function wn(e){return e instanceof nn||(e=vn(e)),e?new An((e=e.rgb()).r,e.g,e.b,e.opacity):new An}function Sn(e,t,n,r){return 1===arguments.length?wn(e):new An(e,t,n,null==r?1:r)}function An(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function xn(){return"#"+Tn(this.r)+Tn(this.g)+Tn(this.b)}function _n(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function Tn(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function En(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new kn(e,t,n,r)}function Nn(e){if(e instanceof kn)return new kn(e.h,e.s,e.l,e.opacity);if(e instanceof nn||(e=vn(e)),!e)return new kn;if(e instanceof kn)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new kn(o,s,u,e.opacity)}function Cn(e,t,n,r){return 1===arguments.length?Nn(e):new kn(e,t,n,null==r?1:r)}function kn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Bn(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Dn(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}en(nn,vn,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:gn,formatHex:gn,formatHsl:function(){return Nn(this).formatHsl()},formatRgb:yn,toString:yn}),en(An,Sn,tn(nn,{brighter:function(e){return e=null==e?an:Math.pow(an,e),new An(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?rn:Math.pow(rn,e),new An(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xn,formatHex:xn,formatRgb:_n,toString:_n})),en(kn,Cn,tn(nn,{brighter:function(e){return e=null==e?an:Math.pow(an,e),new kn(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?rn:Math.pow(rn,e),new kn(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new An(Bn(e>=240?e-240:e+120,i,r),Bn(e,i,r),Bn(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const qn=e=>()=>e;function Gn(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):qn(isNaN(e)?t:e)}const Ln=function e(t){var n=function(e){return 1==(e=+e)?Gn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):qn(isNaN(t)?n:t)}}(t);function r(e,t){var r=n((e=Sn(e)).r,(t=Sn(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=Gn(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function In(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=Sn(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}In((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return Dn((n-r/t)*t,o,i,a,s)}})),In((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return Dn((n-r/t)*t,i,a,o,s)}}));var On=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fn=new RegExp(On.source,"g");function jn(e,t){var n,r,i,a=On.lastIndex=Fn.lastIndex=0,o=-1,s=[],u=[];for(e+="",t+="";(n=On.exec(e))&&(r=Fn.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:Ht(n,r)})),a=Fn.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})}function $n(e,t){var n;return("number"==typeof t?Ht:t instanceof vn?Ln:(n=vn(t))?(t=n,Ln):jn)(e,t)}function Rn(e){return function(){this.removeAttribute(e)}}function Hn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Vn(e,t,n){var r,i,a=n+"";return function(){var o=this.getAttribute(e);return o===a?null:o===r?i:i=t(r=o,n)}}function Wn(e,t,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===a?null:o===r?i:i=t(r=o,n)}}function zn(e,t,n){var r,i,a;return function(){var o,s,u=n(this);if(null!=u)return(o=this.getAttribute(e))===(s=u+"")?null:o===r&&s===i?a:(i=s,a=t(r=o,u));this.removeAttribute(e)}}function Xn(e,t,n){var r,i,a;return function(){var o,s,u=n(this);if(null!=u)return(o=this.getAttributeNS(e.space,e.local))===(s=u+"")?null:o===r&&s===i?a:(i=s,a=t(r=o,u));this.removeAttributeNS(e.space,e.local)}}function Un(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Yn(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Jn(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Yn(e,i)),n}return i._value=t,i}function Kn(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Un(e,i)),n}return i._value=t,i}function Qn(e,t){return function(){jt(this,e).delay=+t.apply(this,arguments)}}function Zn(e,t){return t=+t,function(){jt(this,e).delay=t}}function er(e,t){return function(){$t(this,e).duration=+t.apply(this,arguments)}}function tr(e,t){return t=+t,function(){$t(this,e).duration=t}}function nr(e,t){if("function"!=typeof t)throw new Error;return function(){$t(this,e).ease=t}}function rr(e,t,n){var r,i,a=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?jt:$t;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}var ir=ht.prototype.constructor;function ar(e){return function(){this.style.removeProperty(e)}}function or(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function sr(e,t,n){var r,i;function a(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&or(e,a,n)),r}return a._value=t,a}function ur(e){return function(t){this.textContent=e.call(this,t)}}function lr(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&ur(r)),t}return r._value=e,r}var cr=0;function hr(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function mr(){return++cr}var fr=ht.prototype;hr.prototype=function(e){return ht().transition(e)}.prototype={constructor:hr,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Z(e));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,u,l=r[o],c=l.length,h=a[o]=new Array(c),m=0;m<c;++m)(s=l[m])&&(u=e.call(s,s.__data__,m,l))&&("__data__"in s&&(u.__data__=s.__data__),h[m]=u,Ft(h[m],t,n,m,h,Rt(s,n)));return new hr(a,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=ne(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var u,l=r[s],c=l.length,h=0;h<c;++h)if(u=l[h]){for(var m,f=e.call(u,u.__data__,h,l),p=Rt(u,n),b=0,d=f.length;b<d;++b)(m=f[b])&&Ft(m,t,n,b,f,p);a.push(f),o.push(u)}return new hr(a,o,t,n)},filter:function(e){"function"!=typeof e&&(e=re(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,u=r[i]=[],l=0;l<s;++l)(a=o[l])&&e.call(a,a.__data__,l,o)&&u.push(a);return new hr(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u,l=t[s],c=n[s],h=l.length,m=o[s]=new Array(h),f=0;f<h;++f)(u=l[f]||c[f])&&(m[f]=u);for(;s<r;++s)o[s]=t[s];return new hr(o,this._parents,this._name,this._id)},selection:function(){return new ir(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=mr(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],u=s.length,l=0;l<u;++l)if(o=s[l]){var c=Rt(o,t);Ft(o,e,n,l,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new hr(r,this._parents,e,n)},call:fr.call,nodes:fr.nodes,node:fr.node,size:fr.size,empty:fr.empty,each:fr.each,on:function(e,t){var n=this._id;return arguments.length<2?Rt(this.node(),n).on.on(e):this.each(rr(n,e,t))},attr:function(e,t){var n=ye(e),r="transform"===n?Jt:$n;return this.attrTween(e,"function"==typeof t?(n.local?Xn:zn)(n,r,Zt(this,"attr."+e,t)):null==t?(n.local?Hn:Rn)(n):(n.local?Wn:Vn)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=ye(e);return this.tween(n,(r.local?Jn:Kn)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?Yt:$n;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var a=Ne(this,e),o=(this.style.removeProperty(e),Ne(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}(e,r)).on("end.style."+e,ar(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,i,a;return function(){var o=Ne(this,e),s=n(this),u=s+"";return null==s&&(this.style.removeProperty(e),u=s=Ne(this,e)),o===u?null:o===r&&u===i?a:(i=u,a=t(r=o,s))}}(e,r,Zt(this,"style."+e,t))).each(function(e,t){var n,r,i,a,o="style."+t,s="end."+o;return function(){var u=$t(this,e),l=u.on,c=null==u.value[o]?a||(a=ar(t)):void 0;l===n&&i===c||(r=(n=l).copy()).on(s,i=c),u.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,a=n+"";return function(){var o=Ne(this,e);return o===a?null:o===r?i:i=t(r=o,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,sr(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Zt(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,lr(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=Rt(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===e)return r.value;return null}return this.each((null==t?Kt:Qt)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Qn:Zn)(t,e)):Rt(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?er:tr)(t,e)):Rt(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(nr(t,e)):Rt(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;$t(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(a,o){var s={value:o},u={value:function(){0==--i&&a()}};n.each((function(){var n=$t(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(u)),n.on=t})),0===i&&a()}))},[Symbol.iterator]:fr[Symbol.iterator]};var pr={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function br(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}ht.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,r,i,a=e.__transition,o=!0;if(a){for(i in t=null==t?null:t+"",a)(n=a[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete e.__transition}}(this,e)}))},ht.prototype.transition=function(e){var t,n;e instanceof hr?(t=e._id,e=e._name):(t=mr(),(n=pr).time=Nt(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],u=s.length,l=0;l<u;++l)(o=s[l])&&Ft(o,e,t,l,s,n||br(o,t));return new hr(r,this._parents,e,t)};const{abs:dr,max:gr,min:yr}=Math;function vr(e){return{type:e}}["w","e"].map(vr),["n","s"].map(vr),["n","w","e","s","nw","ne","sw","se"].map(vr);const Mr=Math.random,Pr=function e(t){function n(e,n){return e=null==e?0:+e,n=null==n?1:+n,1===arguments.length?(n=e,e=0):n-=e,function(){return t()*n+e}}return n.source=e,n}(Mr),wr=function e(t){function n(e,n){return arguments.length<2&&(n=e,e=0),e=Math.floor(e),n=Math.floor(n)-e,function(){return Math.floor(t()*n+e)}}return n.source=e,n}(Mr),Sr=function e(t){function n(e,n){var r,i;return e=null==e?0:+e,n=null==n?1:+n,function(){var a;if(null!=r)a=r,r=null;else do{r=2*t()-1,a=2*t()-1,i=r*r+a*a}while(!i||i>1);return e+n*a*Math.sqrt(-2*Math.log(i)/i)}}return n.source=e,n}(Mr),Ar=1/4294967296;function xr(e=Math.random()){let t=0|(0<=e&&e<1?e/Ar:Math.abs(e));return()=>(t=1664525*t+1013904223|0,Ar*(t>>>0))}var _r=Math.sqrt(50),Tr=Math.sqrt(10),Er=Math.sqrt(2);function Nr(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=_r?10:a>=Tr?5:a>=Er?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=_r?10:a>=Tr?5:a>=Er?2:1)}function Cr(e){let t=e,n=e;function r(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const a=r+i>>>1;n(e[a],t)<0?r=a+1:i=a}return r}return 1===e.length&&(t=(t,n)=>e(t)-n,n=function(e){return(t,n)=>U(e(t),n)}(e)),{left:r,center:function(e,n,i,a){null==i&&(i=0),null==a&&(a=e.length);const o=r(e,n,i,a-1);return o>i&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const a=r+i>>>1;n(e[a],t)>0?i=a:r=a+1}return r}}}const kr=Cr(U),Br=kr.right,Dr=(kr.left,Cr((function(e){return null===e?NaN:+e})).center,Br);function qr(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Or(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=a[n](e);return o}}function Gr(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Lr(e,t){var n,r={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Or(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}function Ir(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(n=0;n<r;++n)i[n]=e[n]*(1-a)+t[n]*a;return i}}function Or(e,t){var n,r,i=typeof t;return null==t||"boolean"===i?qn(t):("number"===i?Ht:"string"===i?(n=vn(t))?(t=n,Ln):jn:t instanceof vn?Ln:t instanceof Date?Gr:(r=t,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(t)?qr:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?Lr:Ht:Ir))(e,t)}function Fr(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function jr(e){return+e}var $r=[0,1];function Rr(e){return e}function Hr(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function Vr(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=Hr(i,r),a=n(o,a)):(r=Hr(r,i),a=n(a,o)),function(e){return a(r(e))}}function Wr(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=Hr(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(t){var n=Dr(e,t,1,r)-1;return a[n](i[n](t))}}function zr(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Xr(){return function(){var e,t,n,r,i,a,o=$r,s=$r,u=Or,l=Rr;function c(){var e,t,n,u=Math.min(o.length,s.length);return l!==Rr&&(e=o[0],t=o[u-1],e>t&&(n=e,e=t,t=n),l=function(n){return Math.max(e,Math.min(t,n))}),r=u>2?Wr:Vr,i=a=null,h}function h(t){return isNaN(t=+t)?n:(i||(i=r(o.map(e),s,u)))(e(l(t)))}return h.invert=function(n){return l(t((a||(a=r(s,o.map(e),Ht)))(n)))},h.domain=function(e){return arguments.length?(o=Array.from(e,jr),c()):o.slice()},h.range=function(e){return arguments.length?(s=Array.from(e),c()):s.slice()},h.rangeRound=function(e){return s=Array.from(e),u=Fr,c()},h.clamp=function(e){return arguments.length?(l=!!e||Rr,c()):l!==Rr},h.interpolate=function(e){return arguments.length?(u=e,c()):u},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,c()}}()(Rr,Rr)}function Ur(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var Yr,Jr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Kr(e){if(!(t=Jr.exec(e)))throw new Error("invalid format: "+e);var t;return new Qr({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Qr(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Zr(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function ei(e){return(e=Zr(Math.abs(e)))?e[1]:NaN}function ti(e,t){var n=Zr(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Kr.prototype=Qr.prototype,Qr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const ni={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>ti(100*e,t),r:ti,s:function(e,t){var n=Zr(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Yr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Zr(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function ri(e){return e}var ii,ai,oi,si=Array.prototype.map,ui=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function li(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){var r,i,a,o,s=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(o=Nr(e,t,n))||!isFinite(o))return[];if(o>0)for(e=Math.ceil(e/o),t=Math.floor(t/o),a=new Array(i=Math.ceil(t-e+1));++s<i;)a[s]=(e+s)*o;else for(o=-o,e=Math.ceil(e*o),t=Math.floor(t*o),a=new Array(i=Math.ceil(t-e+1));++s<i;)a[s]=(e+s)/o;return r&&a.reverse(),a}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return function(e,t,n,r){var i,a=function(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=_r?i*=10:a>=Tr?i*=5:a>=Er&&(i*=2),t<e?-i:i}(e,t,n);switch((r=Kr(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ei(t)/3)))-ei(Math.abs(e)))}(a,o))||(r.precision=i),oi(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ei(t)-ei(e))+1}(a,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-ei(Math.abs(e)))}(a))||(r.precision=i-2*("%"===r.type))}return ai(r)}(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,a=t(),o=0,s=a.length-1,u=a[o],l=a[s],c=10;for(l<u&&(i=u,u=l,l=i,i=o,o=s,s=i);c-- >0;){if((i=Nr(u,l,n))===r)return a[o]=u,a[s]=l,t(a);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}r=i}return e},e}function ci(){var e=Xr();return e.copy=function(){return zr(e,ci())},Ur.apply(e,arguments),li(e)}function hi(e,t,n){this.k=e,this.x=t,this.y=n}function mi(e=0,t=1){return Math.random()*(t-e)+e}function fi(e){return e[wr(0,e.length)()]}function pi(e,t,n){return Math.max(t,Math.min(n,e))}function bi(e,t){return e<=t?[e,t]:[t,e]}function di(e){if(e.length<=1)return[];if(2===e.length)return e[0]>e[1]?[0]:e[1]>e[0]?[1]:[];const t=[];e[0]>e[1]&&t.push(0);let n=e[0],r=e[1];for(let i=1;i<e.length-1;i++){let a=e[i+1];r>n&&r>a&&t.push(i),n=r,r=a}const i=e.length-1;return e[i]>e[i-1]&&t.push(e.length-1),t}function gi(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function yi(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}ii=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?ri:(t=si.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,a=[],o=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(e.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?ri:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(si.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",l=void 0===e.minus?"−":e.minus+"",c=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Kr(e)).fill,n=e.align,h=e.sign,m=e.symbol,f=e.zero,p=e.width,b=e.comma,d=e.precision,g=e.trim,y=e.type;"n"===y?(b=!0,y="g"):ni[y]||(void 0===d&&(d=12),g=!0,y="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var v="$"===m?i:"#"===m&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",M="$"===m?a:/[%p]/.test(y)?u:"",P=ni[y],w=/[defgprs%]/.test(y);function S(e){var i,a,u,m=v,S=M;if("c"===y)S=P(e)+S,e="";else{var A=(e=+e)<0||1/e<0;if(e=isNaN(e)?c:P(Math.abs(e),d),g&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),A&&0==+e&&"+"!==h&&(A=!1),m=(A?"("===h?h:l:"-"===h||"("===h?"":h)+m,S=("s"===y?ui[8+Yr/3]:"")+S+(A&&"("===h?")":""),w)for(i=-1,a=e.length;++i<a;)if(48>(u=e.charCodeAt(i))||u>57){S=(46===u?o+e.slice(i+1):e.slice(i))+S,e=e.slice(0,i);break}}b&&!f&&(e=r(e,1/0));var x=m.length+e.length+S.length,_=x<p?new Array(p-x+1).join(t):"";switch(b&&f&&(e=r(_+e,_.length?p-S.length:1/0),_=""),n){case"<":e=m+e+S+_;break;case"=":e=m+_+e+S;break;case"^":e=_.slice(0,x=_.length>>1)+m+e+S+_.slice(x);break;default:e=_+m+e+S}return s(e)}return d=void 0===d?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),S.toString=function(){return e+""},S}return{format:h,formatPrefix:function(e,t){var n=h(((e=Kr(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(ei(t)/3))),i=Math.pow(10,-r),a=ui[8+r/3];return function(e){return n(i*e)+a}}}}({thousands:",",grouping:[3],currency:["$",""]}),ai=ii.format,oi=ii.formatPrefix,hi.prototype={constructor:hi,scale:function(e){return 1===e?this:new hi(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new hi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new hi(1,0,0),hi.prototype;var vi=new WeakMap;class Mi{constructor(e=[]){vi.set(this,{writable:!0,value:void 0}),yi(this,vi,e.map((e=>void 0!==e.string&&void 0!==e.fret?$.from(e):j.from(e))))}getNotes(){return gi(this,vi)}addNotes(e,t=!0){return yi(this,vi,gi(this,vi).concat(e)),t&&this.sortByTime(),this}concat(e){return yi(this,vi,gi(this,vi).concat(gi(e,vi))),this}append(e,t=0){const n=this.getDuration(),r=e.clone();return r.shiftTime(n+t),yi(this,vi,gi(this,vi).concat(gi(r,vi))),this.sortByTime(),this}repeat(e){const t=this.clone(),n=this.clone(),r=this.getDuration();if(e<2)return t;for(let i=1;i<e;i++)n.shiftTime(r),t.concat(n);return t}length(){return gi(this,vi).length}getStartTime(){return X(gi(this,vi),(e=>e.start))}getDuration(){let e=0;for(let t of gi(this,vi)){const n=null===t.end?t.start:t.end;n>e&&(e=n)}return e}scaleTime(e){return yi(this,vi,gi(this,vi).map((t=>t.scaleTime(e)))),this}shiftTime(e){return yi(this,vi,gi(this,vi).map((t=>t.shiftTime(e)))),this}shiftToStartAt(e){this.sortByTime();const t=gi(this,vi)[0].start-e;return gi(this,vi).forEach((e=>{e.start-=t,null!==e.end&&(e.end-=t)})),this}forEach(e){return gi(this,vi).forEach(e),this}sort(e){return yi(this,vi,gi(this,vi).sort(e)),this}sortByTime(){return yi(this,vi,gi(this,vi).sort(((e,t)=>e.start-t.start))),this}map(e){return yi(this,vi,gi(this,vi).map(e)),this}slice(e,t){return yi(this,vi,gi(this,vi).slice(e,t)),this}sliceTime(e,t,n="contained"){const r=e,i=t;return"start"===n&&yi(this,vi,gi(this,vi).filter((e=>e.start>=r&&e.start<i))),"end"===n&&yi(this,vi,gi(this,vi).filter((e=>e.end>=r&&e.end<i))),"contained"===n&&yi(this,vi,gi(this,vi).filter((e=>null===e.end?e=>e.start>=r&&e.start<i:e=>e.start>=r&&e.end<i))),this}filter(e){return yi(this,vi,gi(this,vi).filter(e)),this}filterPitches(e){return yi(this,vi,gi(this,vi).filter((t=>e.includes(t.pitch)))),this}transpose(e){for(let t of gi(this,vi))t.pitch=pi(t.pitch+e,0,127);return this}reverse(){const e=this.getDuration();for(let t of gi(this,vi))t.start=e-t.end,t.end=e-t.start;return this.sortByTime(),this}equals(e){if(!(e instanceof Mi))return!1;const t=e.getNotes();if(gi(this,vi).length!==t.length)return!1;for(let e=0;e<t.length;e++)if(!gi(this,vi)[e].equals(t[e]))return!1;return!0}clone(){return new Mi(gi(this,vi))}}function Pi(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function wi(e,t,n=!0){if(n&&e.length!==t.length)return!1;const r=new Set(e),i=new Set(t);for(let e of r)if(!i.has(e))return!1;for(let e of i)if(!r.has(e))return!1;return!0}function Si(e){return Array.from(new Set(e))}function Ai(e,t){if(e.length<t.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0}function xi(e){return[].concat(...e)}function _i(e){let t=-1/0;for(let n of e)for(let e of n)isNaN(+e)||e>t&&(t=e);return t}function Ti(e,t=", ",n="\n",r){return e&&e.length?(r&&(e=e.map((e=>e.map((e=>r(e)))))),e.map((e=>e.join(t))).join(n)):""}function Ei(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}var Ni=new WeakMap;class Ci extends Mi{constructor(e,t,n,r=1,i=0,a=null){super(n),Ni.set(this,{writable:!0,value:[]}),this.name=e,this.date=t,this.dateString=t.toISOString().substring(0,19).replace("T"," "),this.speed=+r,this.selectedTrack=+i,this.timeSelection=a,this.sortByTime()}clone(){return new Ci(this.name,this.date,this.getNotes().map((e=>e.clone())),this.speed,this.selectedTrack,null===this.timeSelection?null:[...this.timeSelection])}equals(e){if(!(e instanceof Ci))return!1;if(this.name!==e.name)return!1;if(this.date.getTime()!==e.date.getTime())return!1;if(this.speed!==e.speed)return!1;if(this.selectedTrack!==e.selectedTrack)return!1;if(this.timeSelection!==e.timeSelection)return null!==this.timeSelection&&null!==e.timeSelection&&Pi(this.timeSelection,e.timeSelection);const t=e.getNotes();if(Ei(this,Ni).length!==t.length)return!1;for(let e=0;e<t.length;e++)if(!Ei(this,Ni)[e].equals(t[e]))return!1;return!0}toSimpleObject(){return{name:this.name,date:this.date,notes:this.getNotes(),speed:this.speed,selectedTrack:this.selectedTrack,timeSelection:this.timeSelection}}static from(e){let{name:t,date:n,notes:r}=e;const i=[t,n,r],a=["name","date","notes"];for(let e=0;e<i.length;e++)if(null==i[e])return console.error(`Cannot create Recording with undefined ${a[e]}`),null;return"string"==typeof n&&(n=new Date(Date.parse(n))),new Ci(t,n,r,e.speed,e.selectedTrack,e.timeSelection)}}function ki(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}function Bi(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}var Di=new WeakMap,qi=new WeakMap,Gi=new WeakMap,Li=new WeakMap,Ii=new WeakMap,Oi=new WeakMap,Fi=new WeakMap,ji=new WeakMap;class $i{constructor(){Di.set(this,{writable:!0,value:!1}),qi.set(this,{writable:!0,value:null}),Gi.set(this,{writable:!0,value:null}),Li.set(this,{writable:!0,value:4}),Ii.set(this,{writable:!0,value:4}),Oi.set(this,{writable:!0,value:null}),Fi.set(this,{writable:!0,value:null}),ji.set(this,{writable:!0,value:new AudioContext}),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_scheduler",(()=>{const e=Bi(this,Li),t=60/Bi(this,Gi);let n=Bi(this,Oi)+Bi(this,Fi)*t;for(;n<Bi(this,ji).currentTime+.1;){n+=t;const r=Bi(this,Fi)%e==0?440:220;this._playSound(n,r,.1),ki(this,Fi,+Bi(this,Fi)+1)}ki(this,qi,setTimeout(this._scheduler,50))}))}get bpm(){return Bi(this,Gi)}get beatCount(){return Bi(this,Fi)}start(e,t="4/4"){if(!e||isNaN(+e))return void console.error(`[Metronome] Invalid bpm ${e}`);const n=t.split("/");2!==n.length||isNaN(+n[0]||isNaN(+n[1]))?(console.error(`[Metronome] Invalid beatType ${t}, using 4/4 instead`),ki(this,Li,4),ki(this,Ii,4)):(ki(this,Li,+n[0]),ki(this,Ii,+n[1])),console.log(`Metronome @ ${e}bpm, ${Bi(this,Li)}/${Bi(this,Ii)}`),"suspended"===Bi(this,ji).state&&Bi(this,ji).resume(),ki(this,Gi,e),ki(this,Di,!0),ki(this,Fi,0),ki(this,Oi,Bi(this,ji).currentTime),this._scheduler()}stop(){console.log("Metronome stopped"),clearTimeout(Bi(this,qi)),ki(this,Di,!1)}toggle(e,t="4/4"){Bi(this,Di)?this.stop():(void 0===e&&(e=Bi(this,Gi)),this.start(e,t))}peep(){"suspended"===Bi(this,ji).state&&Bi(this,ji).resume();const e=Bi(this,ji).createOscillator();e.connect(Bi(this,ji).destination),e.frequency.value=440,e.start(Bi(this,ji).currentTime),e.stop(Bi(this,ji).currentTime+.1)}_playSound(e,t,n){const r=Bi(this,ji).createOscillator();r.connect(Bi(this,ji).destination),r.frequency.value=t,r.start(e),r.stop(e+n)}}var Ri=n(346),Hi=n.n(Ri);function Vi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wi(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function zi(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}var Xi=new WeakMap,Ui=new WeakMap,Yi=new WeakMap,Ji=new WeakMap,Ki=new WeakMap,Qi=new WeakMap,Zi=new WeakMap,ea=new WeakMap,ta=new WeakMap,na=new WeakMap,ra=new WeakMap,ia=new WeakMap,aa=new WeakMap,oa=new WeakMap,sa=new WeakMap,ua=new WeakMap,la=new WeakMap,ca=new WeakMap,ha=new WeakMap,ma=new WeakMap;class fa{constructor(e){Xi.set(this,{writable:!0,value:null}),Ui.set(this,{writable:!0,value:null}),Yi.set(this,{writable:!0,value:null}),Ji.set(this,{writable:!0,value:null}),Ki.set(this,{writable:!0,value:1}),Qi.set(this,{writable:!0,value:null}),Zi.set(this,{writable:!0,value:!1}),Vi(this,"currentPlayTime",null),ea.set(this,{writable:!0,value:null}),ta.set(this,{writable:!0,value:new AudioContext}),na.set(this,{writable:!0,value:null}),ra.set(this,{writable:!0,value:null}),ia.set(this,{writable:!0,value:0}),aa.set(this,{writable:!0,value:-1}),oa.set(this,{writable:!0,value:[]}),sa.set(this,{writable:!0,value:[]}),ua.set(this,{writable:!0,value:null}),la.set(this,{writable:!0,value:!1}),ca.set(this,{writable:!0,value:!1}),ha.set(this,{writable:!0,value:null}),ma.set(this,{writable:!0,value:new Map([["acoustic_grand_piano",{name:"acoustic_grand_piano",desciption:"Acoustic grand piano"}],["acoustic_guitar_nylon",{name:"acoustic_guitar_nylon",desciption:"Acoustic guitar nylon"}],["acoustic_guitar_steel",{name:"acoustic_guitar_steel",desciption:"Acoustic guitar steel"}],["distortion_guitar",{name:"distortion_guitar",desciption:"Distortion guitar"}],["electric_bass_finger",{name:"electric_bass_finger",desciption:"Electric bass finger"}],["electric_bass_pick",{name:"electric_bass_pick",desciption:"Electric bass pick"}],["electric_guitar_clean",{name:"electric_guitar_clean",desciption:"Electric guitar clean"}],["electric_guitar_muted",{name:"electric_guitar_muted",desciption:"Electric guitar muted"}],["overdriven_guitar",{name:"overdriven_guitar",desciption:"Overdriven guitar"}],["percussion",{name:"percussion",desciption:"Percussion",font:"FluidR3_GM"}]])}),Vi(this,"onTimeChange",(e=>(zi(this,Ui,e),this))),Vi(this,"onStop",(e=>(zi(this,Yi,e),this))),Vi(this,"getAvailableInstruments",(()=>Array.from(Wi(this,ma).values()))),Vi(this,"setVolume",(e=>(zi(this,Ki,e),this))),Vi(this,"setLogging",(e=>(zi(this,Zi,e),this))),Vi(this,"isPlaying",(()=>Wi(this,la))),Vi(this,"isPaused",(()=>Wi(this,ca))),Vi(this,"playNotes",((e,t="piano",n=0,r=-1,i=1)=>{Wi(this,la)&&!Wi(this,ca)&&this.stop(),e&&0!==e.length?Wi(this,ma).has(t)?(zi(this,oa,e.slice()),e=new Mi(e).sortByTime(),zi(this,ua,e.getDuration()),n>0&&(e=e.filter((e=>e.start>=n)).shiftTime(-n),console.log(`[Player] Will start at ${n.toFixed(2)} seconds with ${e.length()} notes left`)),1!==i&&i>0&&(e=e.scaleTime(1/i),zi(this,ua,Wi(this,ua)/i)),e=e.getNotes(),console.log(`[Player] Playing ${e.length} notes with '${t}', speed ${i}, and volume ${Wi(this,Ki)}`),"suspended"===Wi(this,ta).state&&Wi(this,ta).resume(),zi(this,Ji,t),zi(this,ia,n),zi(this,aa,r),zi(this,Qi,i),zi(this,sa,e.slice()),t===Wi(this,ha)?this._start():this.preloadInstrument(t).then(this._start)):console.error(`[Player] Sound ${t} is not supported!`):console.warn("[PLAYER] Was called with no data")})),Vi(this,"_start",(()=>{console.log("[Player] Starting"),zi(this,la,!0),zi(this,ca,!1),zi(this,ra,Wi(this,ta).currentTime),this._scheduler()})),Vi(this,"_updateTime",(e=>{const t=(e-Wi(this,ra))*Wi(this,Qi)+Wi(this,ia);this.currentPlayTime=t,Wi(this,Ui)&&Wi(this,Ui).call(this,t)})),Vi(this,"_playNote",((e,t)=>{const n=e.getDuration();Wi(this,Zi)&&console.log(`[Player] Playing ${e.getName()} for ${n}s`);try{Wi(this,ea).play(e.pitch,t,{duration:n})}catch(t){console.error("[Player] Error for note",e,t)}})),Vi(this,"_scheduler",(()=>{const e=Wi(this,ta).currentTime;for(this._updateTime(e);Wi(this,sa).length>0;){const t=Wi(this,ra)+Wi(this,sa)[0].start;if(t>e+.1)break;const n=Wi(this,sa).shift();this._playNote(n,t)}const t=e-Wi(this,ra)+Wi(this,ia),n=(Wi(this,aa)-Wi(this,ia))/Wi(this,Qi)+Wi(this,ia);-1!==Wi(this,aa)&&t>=n||t>=Wi(this,ua)?this.stop():zi(this,na,setTimeout(this._scheduler,33))})),Vi(this,"stop",((e=!0)=>{if(Wi(this,la))return console.log("[Player] Stopping player"),clearTimeout(Wi(this,na)),this.currentPlayTime=null,zi(this,la,!1),zi(this,ca,!1),zi(this,oa,[]),zi(this,sa,[]),Wi(this,Ui)&&Wi(this,Ui).call(this,null),e&&Wi(this,Yi)&&Wi(this,Yi).call(this),this})),Vi(this,"pause",(()=>(console.log("[Player] Pausing player"),clearTimeout(Wi(this,na)),zi(this,ca,!0),this))),Vi(this,"resume",(()=>{if(console.log("[Player] Resuming player"),Wi(this,sa)&&0!==Wi(this,sa).length)return this.playNotes(Wi(this,oa),Wi(this,Ji),this.currentPlayTime,Wi(this,aa),Wi(this,Qi)),this;console.warn("[Player] Cannot resume player since it has not been started!")})),Vi(this,"pauseOrResume",(()=>{if(Wi(this,la))return Wi(this,ca)?this.resume():this.pause(),this;console.warn("[Player] Cannot pause / resume when player is not playing!")})),zi(this,Xi,e)}async preloadInstrument(e){Wi(this,ma).has(e)||console.warn(`[Player] Invalid sound ${e}`),console.log(`[Player] Loading soundfont ${e}`);const t={soundfont:Wi(this,ma).get(e).font||"FluidR3_GM",gain:Wi(this,Ki)},n=await Hi().instrument(Wi(this,ta),e,t);zi(this,ha,e),zi(this,ea,n),console.log(`[Player] Finished loading soundfont ${e}`)}}function pa(e){return 1/(e/60)}function ba(e){const t=new Map;return e.forEach(((e,n)=>{t.set(n,{...e})})),t}function da(e){return V(xi(e),(e=>e.pitch))}function ga(e){return e.sort(((e,t)=>e.start===t.start?e.pitch-t.pitch:e.start-t.start)).map((e=>e.pitch))}function ya(e){const t=ga(e);return String.fromCharCode(...t)}function va(e){return e.split("").reverse().join("")}function Ma(e){const t=new Array(e.length-1);for(let n=1;n<e.length;n++)t[n-1]=e[n]-e[n-1];return t}function Pa(e,t=!0){if(null==e)return void console.warn("[MidiParser] MIDI data is null");if(!e.track)return void console.error("[MidiParser] MIDI data has no track");console.groupCollapsed("[MidiParser] Preprocessing MIDI file data");let n=[];const r=[],{tempoChanges:i,beatTypeChanges:a}=function(e){const t=[],n=[];let r=0;for(let i of e)for(let e of i.event){if(r+=e.deltaTime,255===e.type&&81===e.metaType){const n=e.data/1e3,i=Math.round(1/(n/6e4));t.push({tick:r,tempo:i})}if(255===e.type&&88===e.metaType){const t=e.data,i=t[0],a=Math.pow(2,t[1]);n.push({tick:r,beats:i,beatType:a})}}return 0===t.length&&t.push({tempo:120,time:0}),0===n.length&&n.push({beats:4,beatType:4,time:0}),{tempoChanges:t,beatTypeChanges:n}}(e.track);for(let t=0;t<e.track.length;t++){const o=e.track[t],s=wa(o,e.timeDivision,i,a);if(null!==s){n.push(s);let e=Sa(o.event);r.push(e||`Track ${t}`)}}0===e.formatType&&t&&n.length>0&&(n=function(e){e.length>1&&console.warn("Splitting a format 0 file with more than 1 track will result in all but the first beeing lost!"),console.log("Splitting format 0 file into tracks based on channel");const t=V(e[0].noteObjs,(e=>e.channel)),n=[];return t.forEach(((t,r)=>{n[r]={...e[0],noteObjs:t}})),n}(n));const o={parts:n,partNames:r,instruments:null,totalTime:W(n,(e=>e.totalTime)),bpm:n[0].bpm,beats:n[0].beats,beatType:n[0].beatType};return console.log(`Got ${n.length} MIDI tracks`,o),console.groupEnd(),o}function wa(e,t,n,r){const i=[];let a,o=n.length>0?n[0].tempo:120,s=0,u=Aa(o,t),l=0,c=0;for(let h of e.event){let e;s+=h.deltaTime;for(let e of r)void 0===e.time&&e.tick<=s&&(e.time=(e.tick-l)*u/1e3+c);n.length>0&&s>n[n.length-1].tick&&(e=n[n.length-1]);for(let t=1;t<n.length;t++)if(n[t].tick>s){e=n[t-1];break}if(e&&e.tempo!==o){const n=e.tick;c=(n-l)*u/1e3+c,l=n,e.time=c,o=e.tempo,u=Aa(o,t)}a=(s-l)*u/1e3+c;const m=h.type;if(8!==m&&9!==m)continue;const[f,p]=h.data,b=h.channel;if(a=+a.toFixed(10),8===h.type||0===p){if(0===i.length)continue;let e=i.length-1;for(;i[e].pitch!==f||i[e].channel!==b||-1!==i[e].end;)if(e--,e<0){console.warn("Did not find note-on event for note-off event!");break}e>=0&&(i[e].end=a)}else i.push(new j(f,a,p,b,-1))}for(let e of i)-1===e.end&&(e.end=a);const h=function(e,t,n){const r=[];let i=120,a=4,o=pa(i),s=0,u=0,l=0,c=0;for(;s<n;){let n;for(const t of e)t.time<=s&&(n=t.tempo);n&&n!==i&&(l=s,c=0,i=n,o=pa(i));for(const e of t)e.time<=s&&(a=e.beats);u++,c+=o,s=l+c,u>=a&&(u=0,r.push(s))}return r}(n,r,a);if(i.length>0){var m,f,p;const e={noteObjs:i,totalTime:a,tempoChanges:n,beatTypeChanges:r,measureLinePositions:h,bpm:(null===(m=n[0])||void 0===m?void 0:m.tempo)||120,beats:(null===(f=r[0])||void 0===f?void 0:f.beats)||4,beatType:(null===(p=r[0])||void 0===p?void 0:p.beatType)||4};return console.log(`Got part with ${i.length} notes,\n`,e),e}return null}function Sa(e){for(let t of e)if(255===t.type&&3===t.metaType)return t.data;return null}function Aa(e,t){return 1/e*6e4/t}function xa(e){console.groupCollapsed("[MusicXmlParser] Parsing MusicXML"),console.log(e);const t=e.getElementsByTagName("part-name"),n=e.getElementsByTagName("score-instrument"),r=[],i=[];for(let e of t)r.push(e.innerHTML);for(let e of n)i.push(e.children[0].innerHTML);const a=e.getElementsByTagName("part");let o=[];for(let e=0;e<a.length;e++){const t=a[e].children;o.push(_a(t))}return console.groupEnd(),{parts:o,partNames:r,instruments:i,totalTime:W(o,(e=>e.totalTime)),bpm:o[0].bpm,beats:o[0].beats,beatType:o[0].beatType}}function _a(e){var t;e=function(e){let t=[],n=[];for(let r=0;r<e.length;r++){const i=e[r],a=i.getElementsByTagName("repeat");if(2===a.length){const e=a[1].getAttribute("times")||2,r=new Array(+e).fill(i);0===n.length?t=t.concat(r):n=n.concat(r)}else if(1===a.length){const e=a[0].getAttribute("direction");if("forward"===e)n.push(i);else if("backward"===e){const e=a[0].getAttribute("times")||2;if(n.length>0){n.push(i);for(let r=0;r<e;r++)t=t.concat(n);n=[]}else t=t.concat(t)}}else 0===n.length?t.push(i):n.push(i)}return t}(e);let n,r=0,i=120,a=4,o=4;const s=[],u=[],l=[],c=[];for(let t of e){try{const e=t.getElementsByTagName("sound");for(let t of e){const e=t.getAttribute("tempo");null!==e&&(i=+e,s.push({time:r,tempo:i}));break}}catch(e){}try{n=+t.getElementsByTagName("divisions")[0].innerHTML}catch(e){}try{a=+t.getElementsByTagName("beats")[0].innerHTML,o=+t.getElementsByTagName("beat-type")[0].innerHTML,u.push({time:r,beats:a,beatType:o})}catch(e){}const e=1/(i/60),h=t.getElementsByTagName("note");let m=0;for(let t of h)try{const i=+t.getElementsByTagName("duration")[0].innerHTML/n*e;if(0!==t.getElementsByTagName("rest").length){r+=i;continue}const a=_(t.getElementsByTagName("step")[0].innerHTML,+t.getElementsByTagName("octave")[0].innerHTML).pitch;t.getElementsByTagName("chord").length>0&&(r-=m);const o=t.getElementsByTagName("tie")[0];if(o&&"stop"===o.getAttribute("type")){let e=r+i;for(let t=l.length-1;t>0;t--){const n=l[t];if(n.pitch===a){n.end=e;break}}}else{let e=null,n=null;try{n=+t.getElementsByTagName("fret")[0].innerHTML,e=+t.getElementsByTagName("string")[0].innerHTML}catch(e){}null!==e&&null!==n?l.push(new $(a,r,127,e,r+i,e,n)):l.push(new j(a,r,127,e,r+i))}m=i,r+=i}catch(e){console.warn("[MusicXmlParser] Cannot parse MusicXML note"),console.warn(e),console.log(t)}c.push(r)}0===s.length&&s.push({tempo:120,time:0}),0===u.length&&u.push({beats:4,beatType:4,time:0});const h={noteObjs:l,totalTime:r,measureLinePositions:c,tempoChanges:s,beatTypeChanges:u,bpm:(null===(t=s[0])||void 0===t?void 0:t.tempo)||120,beats:u[0].beats,beatType:u[0].beatType,tuning:Ta(e)};return console.log("[MusicXmlParser] Parsed part: ",h),h}function Ta(e){for(let t of e)try{let e=[];const n=t.getElementsByTagName("staff-tuning");for(let t of n){let n=t.getElementsByTagName("tuning-step")[0].innerHTML,r=+t.getElementsByTagName("tuning-octave")[0].innerHTML;e.push(_(n,r).pitch)}return e}catch(e){}return[]}function Ea(e){const t=window.devicePixelRatio||1,n=e.getBoundingClientRect();e.width=n.width*t,e.height=n.height*t;const r=e.getContext("2d");return r.scale(t,t),r}function Na(e,t,n,r){e.beginPath(),e.arc(t,n,r,0,2*Math.PI),e.stroke()}function Ca(e,t,n,r){r<0&&console.error(`Cannot draw circle with negative radius of ${r}`),e.beginPath(),e.arc(t,n,r,0,2*Math.PI),e.fill()}function ka(e,t,n,r){e.beginPath(),e.moveTo(t-r,n+r),e.lineTo(t+r,n+r),e.lineTo(t,n-r),e.closePath(),e.fill()}function Ba(e,t,n,r){e.beginPath(),e.moveTo(t-r,n),e.lineTo(t,n-r),e.lineTo(t+r,n),e.lineTo(t,n+r),e.closePath(),e.fill()}function Da(e,t,n,r){e.lineWidth=2,e.beginPath(),e.moveTo(t-r,n-r),e.lineTo(t+r,n+r),e.moveTo(t-r,n+r),e.lineTo(t+r,n-r),e.stroke(),e.lineWidth=1}function qa(e,t,n,r,i,a){e.beginPath(),e.moveTo(t,n),e.lineTo(t,n+i),e.lineTo(t+r,n+(i/2+a/2)),e.lineTo(t+r,n+(i/2-a/2)),e.closePath(),e.fill()}function Ga(e,t,n,r,i,a){e.beginPath(),e.lineTo(t,n+i),e.lineTo(t+r,n+i),e.lineTo(t+(r/2+a/2),n),e.lineTo(t+(r/2-a/2),n),e.closePath(),e.fill()}function La(e,t,n,r,i,a,o=null){r<0||(e.beginPath(),e.moveTo(t+a,n),e.lineTo(t+r-a,n),e.quadraticCurveTo(t+r,n,t+r,n+a),e.lineTo(t+r,n+i-a),e.quadraticCurveTo(t+r,n+i,t+r-a,n+i),e.lineTo(t+a,n+i),e.quadraticCurveTo(t,n+i,t,n+i-a),e.lineTo(t,n+a),e.quadraticCurveTo(t,n,t+a,n),e.closePath(),o&&(e.fillStyle=o,e.fill()),e.stroke())}var Ia=n(90);const Oa=()=>new Promise((async e=>{let t;try{t=await navigator.mediaDevices.getUserMedia({audio:!0})}catch(e){return void console.warn("[AudioInput] Cannot access audio",e)}const n=new MediaRecorder(t,{audioBitsPerSecond:256e3});let r=[];n.addEventListener("dataavailable",(e=>{r.push(e.data)})),e({start:()=>{n?"recording"!==n.state&&(console.log(`[AudioInput] Recording @ ${n.audioBitsPerSecond} b/s`),r=[],n.start()):console.warn("[AudioInput] Cannot record audio, no microphone?")},stop:()=>new Promise((e=>{n&&(console.log("[AudioInput] Stopping audio recording"),n.addEventListener("stop",(()=>{const t={type:n.mimeType},i=new Blob(r,t);e(i)})),n.stop())}))})})),Fa=()=>new Promise((async e=>{let t;try{t=await navigator.requestMIDIAccess()}catch(e){return void console.warn("[MidiInput] Cannot access MIDI",e)}let n=[];const r=e=>n.push(e);e({start:()=>{if(t){for(let e of t.inputs.values())e.onmidimessage=r;console.log("[MidiInput] Starting recording"),n=[]}else console.warn("[MidiInput] Cannot record MIDI")},stop:()=>{if(t)return console.log("[MidiInput] Stopping recording"),function(e){const t=new Map,n=[];for(let r of e){const e=r.target.name,i=r.timeStamp,a=r.data[0],o=a%16,s=a-o,u=r.data[1],l=r.data.length>2?r.data[2]:0;switch(s){case 128:$a(n,t,e,i,u,o);break;case 144:l>0?ja(t,e,i,u,o,l):$a(n,t,e,i,u,o)}}return t.size>0&&console.warn(`[MidiInput] Got ${t.size} unfinished notes`),n.sort(((e,t)=>e.start-t.start)),n}(n)}})}));function ja(e,t,n,r,i,a){const o=new j(r,n/1e3,a,i),s=`${t}-${i}-${r}`;e.set(s,o)}function $a(e,t,n,r,i,a){const o=`${n}-${a}-${i}`;if(!t.has(o))return void console.warn(`[MidiInput] Missing note-on for note-off with key ${o}`);const s=t.get(o);s.end=r/1e3,e.push(s),t.delete(o)}function Ra(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ha(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function Va(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}var Wa=new WeakMap,za=new WeakMap,Xa=new WeakMap,Ua=new WeakMap;class Ya{constructor(e,t,n=(()=>{}),r=(()=>{})){Wa.set(this,{writable:!0,value:void 0}),za.set(this,{writable:!0,value:void 0}),Xa.set(this,{writable:!0,value:void 0}),Ua.set(this,{writable:!0,value:void 0}),Ra(this,"_onMIDISuccess",(e=>{console.groupCollapsed(`[MidiInput] ${e.inputs.size} input devices`);for(let t of e.inputs.values())console.log(` - ${t.name}`),t.onmidimessage=this._handleMIDIMessage;console.groupEnd()})),Ra(this,"_handleMIDIMessage",(e=>{const t=e.target.name,n=e.data[0],r=n%16,i=n-r,a=e.timeStamp,o=e.data[1],s=e.data.length>2?e.data[2]:0;switch(i){case 128:this._noteOff(t,a,o,r);break;case 144:s>0?this._noteOn(t,a,o,r,s):this._noteOff(t,a,o,r)}})),Va(this,Wa,e),Va(this,za,t),Va(this,Xa,n),Va(this,Ua,r),navigator.requestMIDIAccess?navigator.requestMIDIAccess().then(this._onMIDISuccess,this._onMIDIFailure):(console.error("[MidiInput] WebMIDI is not supported in this browser."),alert("You browser does not support WebMIDI"))}_onMIDIFailure(e){console.error("[MidiInput] Cannot access MIDI devices.",e)}_noteOn(e,t,n,r,i){const a=new j(n,t/1e3,i,r);Ha(this,Xa).call(this,a);let o=Ha(this,Wa).call(this);o=o.concat([a]),Ha(this,za).call(this,o)}_noteOff(e,t,n,r){const i=Ha(this,Wa).call(this);0===i.length&&setTimeout((()=>this._noteOff(t,n)),10);let a=i.length-1;for(;i[a].pitch!==n||i[a].channel!==r;)if(a--,a<0){console.warn("[MidiInput] Did not find note-on event for note-off event!");break}a>=0&&(i[a].end=t/1e3,Ha(this,za).call(this,i),Ha(this,Ua).call(this,n))}}const Ja=new Map([[49,{repPitch:49,zone:1,order:10,line:-1,shape:"o",label:"CC1",name:"Crash Cymbal 1"}],[55,{repPitch:49,zone:2,order:11,line:-1,shape:"o",label:"CC1",name:"Crash Cymbal 1"}],[52,{repPitch:57,zone:1,order:20,line:0,shape:"o",label:"CC2",name:"Crash Cymbal 2"}],[57,{repPitch:57,zone:2,order:21,line:0,shape:"o",label:"CC2",name:"Crash Cymbal 2"}],[22,{repPitch:46,zone:1,order:30,line:0,shape:"<>",label:"HHS",name:"Hi-Hat"}],[26,{repPitch:46,zone:2,order:31,line:0,shape:"<>",label:"HHS",name:"Hi-Hat"}],[42,{repPitch:46,zone:3,order:32,line:0,shape:"<>",label:"HHS",name:"Hi-Hat"}],[46,{repPitch:46,zone:4,order:33,line:0,shape:"<>",label:"HHS",name:"Hi-Hat"}],[44,{repPitch:44,zone:1,order:40,line:9,shape:"o",label:"HHP",name:"Hi-Hat Pedal"}],[51,{repPitch:51,zone:1,order:50,line:1,shape:"x",label:"Rd",name:"Ride Cymbal"}],[53,{repPitch:51,zone:2,order:51,line:1,shape:"x",label:"Rd",name:"Ride Cymbal"}],[59,{repPitch:51,zone:3,order:52,line:1,shape:"x",label:"Rd",name:"Ride Cymbal"}],[38,{repPitch:38,zone:1,order:60,line:4,shape:"o",label:"SN",name:"Snare"}],[40,{repPitch:38,zone:2,order:61,line:4,shape:"o",label:"SN",name:"Snare"}],[48,{repPitch:48,zone:1,order:90,line:2,shape:"o",label:"T1",name:"Tom 1"}],[50,{repPitch:48,zone:2,order:91,line:2,shape:"o",label:"T1",name:"Tom 1"}],[45,{repPitch:45,zone:1,order:100,line:3,shape:"o",label:"T2",name:"Tom 2"}],[47,{repPitch:45,zone:2,order:101,line:3,shape:"o",label:"T2",name:"Tom 2"}],[43,{repPitch:43,zone:1,order:70,line:5,shape:"o",label:"ST1",name:"Stand Tom 1"}],[58,{repPitch:43,zone:2,order:71,line:5,shape:"o",label:"ST1",name:"Stand Tom 1"}],[39,{repPitch:41,zone:1,order:80,line:6,shape:"o",label:"ST2",name:"Stand Tom 2"}],[41,{repPitch:41,zone:2,order:81,line:6,shape:"o",label:"ST2",name:"Stand Tom 2"}],[35,{repPitch:36,zone:1,order:110,line:8,shape:"o",label:"BD",name:"Bass Drum"}],[36,{repPitch:36,zone:2,order:111,line:8,shape:"o",label:"BD",name:"Bass Drum"}]]);function Ka(e,t=1,n=.1,r=.1){const i=new Set;for(let t of e)i.add(t.pitch);const a=Array.from(i),o=wr(15,128),s=Sr(0,t),u=[];for(let t of e){if(mi(0,1)<n){const e=t.start+mi(0,1),n=e+mi(0,1),r=o(),i=fi(a);u.push(new j(i,e,r,0,n))}if(mi(0,1)<r);else{const e=t.start+s(),n=t.end+s(),r=j.from(t);r.start=Math.min(e,n),r.end=Math.max(e,n),u.push(r)}}return u.sort(((e,t)=>e.start-t.start)),u}function Qa(e,t){if(!t)throw"No replacement map given!";const n=new Set,r=e.map((e=>{const r=e.pitch;let i=r;t.has(r)?i=t.get(r).repPitch:n.add(r);const a=j.from(e);return a.pitch=i,a}));return n.size>0&&(console.warn("Cannot replace all pitches, replacementMap misses entry for these pitches:"),console.log(Array.from(n))),r}function Za(e){const t=new Map,n=Array.from(V(Array.from(e),(e=>e[1].repPitch)));return n.sort(((e,t)=>e[1][0][1].order-t[1][0][1].order)),n.forEach(((e,n)=>t.set(e[0],n))),t}class eo{constructor(e,t){this.name=e,this.notes=t,this.short=t.join(" "),this.pitches=t.map((e=>x(e).pitch)),this.stringCount=t.length}}const to=new Map([["Guitar",new Map([[6,[new eo("E stand.",["E2","A2","D3","G3","B3","E4"]),new eo("Drop D",["D2","A2","D3","G3","B3","E4"]),new eo("Drop C",["C2","G2","C3","F3","A3","D4"]),new eo("1/2 down",["D#2","G#2","C#3","F#3","A#3","D#4"]),new eo("1 down",["D2","G2","C3","F3","A3","D4"]),new eo("2 down",["C2","F2","A#2","D#3","G3","C4"]),new eo("DADGAG",["D2","A2","D3","G3","A3","D4"])]],[7,[new eo("B stand.",["B1","E2","A2","D3","G3","B3","E4"]),new eo("Drop A",["A1","E2","A2","D3","G3","B3","E4"]),new eo("1/2 down",["A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new eo("1 down",["A1","D2","G2","C3","F3","A3","D4"]),new eo("2 down",["G1","C2","F2","A#2","D#3","G3","C4"])]],[8,[new eo("F# stand.",["F#1","B1","E2","A2","D3","G3","B3","E4"]),new eo("Drop E",["E1","B1","E2","A2","D3","G3","B3","E4"]),new eo("1/2 down",["F1","A#1","D#2","G#2","C#3","F#3","A#3","D#4"]),new eo("1 down",["E1","A1","D2","G2","C3","F3","A3","D4"]),new eo("2 down",["D1","G1","C2","F2","A#2","D#3","G3","C4"])]]])],["Bass",new Map([[4,[new eo("E stand.",["E1","A1","D2","G2"]),new eo("Drop D",["D1","A1","D2","G2"]),new eo("1/2 down",["D#1","G#1","C#2","F#2"]),new eo("1 down",["D1","G1","C2","F2"]),new eo("2 down",["C1","F1","A#1","D#2"])]],[5,[new eo("B stand.",["B0","E1","A1","D2","G2"]),new eo("Drop A",["A0","D1","A1","D2","G2"]),new eo("1/2 down",["A#0","D#1","G#1","C#2","F#2"]),new eo("1 down",["A0","D1","G1","C2","F2"]),new eo("2 down",["G0","C1","F1","A#1","D#2"])]],[6,[new eo("F# stand.",["F#0","B0","E1","A1","D2","G2"]),new eo("Drop E",["E0","A0","D1","A1","D2","G2"]),new eo("1/2 down",["F0","A#0","D#1","G#1","C#2","F#2"]),new eo("1 down",["E1","A0","D1","G1","C2","F2"]),new eo("2 down",["D0","G0","C1","F1","A#1","D#2"])]]])],["Ukulele",new Map([[4,[new eo("Hawaii",["G4","C4","E4","A4"]),new eo("Low G",["G3","C4","E4","A4"]),new eo("D-tuning",["A4","D4","F#4","B4"]),new eo("Canadian",["A3","D4","F#4","B4"]),new eo("Bariton",["D3","G3","B3","E4"])]]])]]);function no(e,t){const n=e.channel,r=t.stringCount-n-1,i=e.pitch-t.pitches[r];return $.fromNote(e,n,i)}function ro(e){const t=e.length;for(let n of to.values())if(n.has(t)){const r=n.get(t);for(let t of r)if(Pi(t.pitches,e))return t}return null}function io(e,t=24){const n=e.pitches[e.stringCount-1];return[e.pitches[0],n+t]}const ao=["#888","#d122e9","#31eb1c","#f37c14","#10edfc","#ffeb09","#ff210d","silver","gold"];function oo(e,t,n){const r=n.stringCount-e+1;return n.pitches[r-1]+t}function so(e,t,n){return A(oo(e,t,n))}function uo(e,t,n){const r=[],i=t.stringCount;for(let a=0;a<i;a++){const o=t.pitches[a];e<o||e>o+n||r.push({string:i-a,fret:e-o})}return r}function lo(e,t,n=24){const r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];if(!r.includes(e))return null;const i=[],a=r.indexOf(e),o=t.stringCount;for(let e=0;e<o;e++){let r=a-t.pitches[e]%12;for(r<0&&(r+=12);r<=n;)i.push({string:o-e,fret:r}),r+=12}return i}function co(e=0,t=50,n){let r=e;return new Array(t).fill(0).map(((e,t)=>{const i=r+mi(0,1);r=i+mi(0,1);const a=wr(1,7),o=wr(0,25),s=oo(a,o,n),u=wr(15,127);return new $(s,i,u,a,r,a,o)}))}function ho(e,t,n=24){if(!e||0===e.length)return[];if(!t||!t.pitches)return console.warn("Invalid tuning parameter!"),[];const[r,i]=io(t,n),a=[],o=[];for(let t of e)t.pitch<r||t.pitch>i?o.push(t.pitch):a.push(t);const s=[];for(let e of a){const n=uo(e.pitch,t,24);let r=n[0];for(let e of n)e.fret<r.fret&&(r=e);const{string:i,fret:a}=r;s.push($.fromNote(e,i,a))}if(o.length>0){const[t,n]=R(e,(e=>e.pitch));let a="";t<r&&(a+=`Transpose by ${r-t} semitones`),i<n&&(a+=`Transpose by ${i-n} semitones`),console.warn(`Cannot find a fretboard position for ${o.length} pitches, try another tuning instead:\n`,o,`\nCurrent tuning's pitch range is ${r} - ${i}`,`\ndata pitch range is ${t} - ${n}\n`,a)}return s}const mo=new Map([[72,{minPitch:24,maxPitch:95}],[88,{minPitch:21,maxPitch:108}],[128,{minPitch:0,maxPitch:127}]]);class fo{constructor(e,t){this.string=e,this.fret=t}moveBy(e,t){this.string+=e,this.fret+=t}isValid(e,t){return this.string<=e&&this.fret<=t}equals(e){return this.string===e.string&&this.fret===e.fret}toString(){return`(${this.string}, ${this.fret})`}clone(){return new fo(this.string,this.fret)}difference(e){return{string:e.string-this.string,fret:e.fret-this.fret}}}class po{constructor(e=new Array(10).fill(null)){10!==e.length&&(console.error("fingerPositions must have length 10!"),e=new Array(10).fill(null)),this.fingerPositions=e}moveFingerTo(e,t){this.fingerPositions[e]=t}liftFinger(e){this.fingerPositions[e]=null}moveFingerBy(e,t,n){const r=this.fingerPositions[e];r&&r.moveBy(t,n)}moveHandBy(e,t){for(const n of this.fingerPositions)null!==n&&n.moveBy(e,t)}isValid(e,t){for(const n of this.fingerPositions)if(null!==n&&!n.isValid(e,t))return!1;return!0}euqals(e){const t=this.fingerPositions,n=e.fingerPositions;for(let e=0;e<10;e++)if(t[e]!==n[e]){if(null===t[e]||null===n[e])return!1;if(!t[e].equals(n[e]))return!1}return!0}toString(){let e="HandPose ";const t=["T",1,2,3,4,"RT",6,7,8,9];for(let n=0;n<10;n++){const r=this.fingerPositions[n];null!==r&&(e=`${e} ${t[n]} ${r.toString()}`)}}clone(){return new po(this.fingerPositions.map((e=>e.clone())))}difference(e){const t=[],n=this.fingerPositions,r=e.fingerPositions;for(let e=0;e<10;e++)null===n[e]?t[e]=r[e]:null===r[e]?t[e]=null:t[e]=n[e].difference(r[e]);return t}costOfMovement(e){if(this.equals(e))return 0;const t=this.difference(e),n=this.fingerPositions,r=e.fingerPositions;if(t.every((e=>null===e)))return 1;let i=!0;for(let e=0;e<10;e++)if(null!==r[e]&&!n[e].equals(r[e])){i=!1;break}if(i)return 2;if(t.every((e=>null!==e&&0===e.string))){const e=t[0].fret;if(t.every((t=>t.fret===e)))return 1+.1*Math.abs(e)}i=!0;for(let e=0;e<10;e++)if(null!==n[e]&&!n[e].equals(r[e])){i=!1;break}return i?2:(console.log("unknown pose change cost",this,e,t),5)}}function bo(e){e.sort(((e,t)=>e.string!==t.string?t.string-e.string:e.fret-t.fret)),console.log(e.map((e=>e.toString())));const t=new Array(10).fill(null);return 0===e.length?new po:1===notes.length||1===notes.length?(t[1]=new fo(string,fret),new po(t)):void 0}function go(e,t,n){}function yo(e,t=!0){if(null==e)return t?"--:--.---":"--:--";const n=Math.floor(e);let r=Math.floor(n/60).toString(),i=(n%60).toString();if(r=r.length<2?`0${r}`:r,i=i.length<2?`0${i}`:i,!t)return`${r}:${i}`;let a=Math.floor(1e3*(e-n)).toString();return a.length<2?a=`00${a}`:a.length<3&&(a=`0${a}`),`${r}:${i}.${a}`}function vo(e,t=!1,n=!0){let r=e.toISOString().split(":").join("-");return n||(r=r.slice(0,r.indexOf("."))),t&&(r=r.replace("T"," ")),r}function Mo(e,t=30){return e?(-1!==e.lastIndexOf(".")&&(e=e.slice(0,e.lastIndexOf("."))),e.length>t&&(e=`${e.slice(0,t-3)}...`),e):"[No Song]"}function Po(e,t){const n=JSON.stringify(t);localStorage.setItem(e,n)}function wo(e){const t=localStorage.getItem(e);if(null===t)return null;try{return JSON.parse(t)}catch(e){return null}}const So=["#ff0000","#ff4e00","#db7b00","#ffcc00","#e4ed00","#81d700","#00ffb4","#00ffea","#00baff","#3c00ff","#a800ff","#ff00fd"].map((e=>{const t=Cn(e);return t.s=.5,t.toString()})),Ao=["#6699ff","#66ffff","#000000","#647878","#993366","#ff0000","#ffcc99","#ffff01","#ff9900","#009900","#66ff99","#0000cc"],xo=Ln("black","steelblue"),_o=new Array(12).fill(0).map(((e,t)=>xo(t/11)));function To(e,t="default"){switch(t){case"accessible":return Ao[e%12];case"gradient":return _o[e%12];default:return So[e%12]}}function Eo(e){const t=e.length,n=z(e),r=function(e,t){const n=function(e,t){let n,r=0,i=0,a=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(n=t-i,i+=n/++r,a+=n*(t-i));else{let o=-1;for(let s of e)null!=(s=t(s,++o,e))&&(s=+s)>=s&&(n=s-i,i+=n/++r,a+=n*(s-i))}if(r>1)return a/(r-1)}(e,void 0);return n?Math.sqrt(n):n}(e)/Math.sqrt(t)*1.96;return{mean:n,low:n-r,high:n+r}}function No(e){e.sort(((e,t)=>e-t));const t=e[0],n=e[e.length-1],r=K(e,.25),i=K(e,.5),a=K(e,.75),o=a-r;return{q1:r,q2:i,q3:a,r0:Math.max(t,r-1.5*o),r1:Math.min(n,a+1.5*o)}}function Co(e,t){return n=>t.map((t=>[t,z(n,(n=>e(t-n)))]))}function ko(e){return t=>Math.abs(t/=e)<=1?.75*(1-t*t)/e:0}function Bo(e){return t=>Math.abs(t/e)<=1?1/Math.sqrt(2*Math.PI)*Math.pow(Math.E,-.5*t*t):0}function Do(e,t=127,n=0){const r=e.clone().filter((e=>!(e.velocity<t||e.getDuration()<n)));return console.log(`Filtered recording, ${r.length()} of ${e.length()} notes left`),r}function qo(e,t){const n=new Map;for(let e=0;e<t.length;e++){const r=R(t[e],(e=>e.pitch));n.set(e,r)}return e.map((e=>{const t=e.selectedTrack,[r,i]=n.get(t);return e.clone().filter((e=>e.pitch>=r&&e.pitch<=i))}))}function Go(e,t,n=10,r="pitch"){let i;"pitch"===r?i=V(e,(e=>e.pitch)):"channel"===r?i=V(e,(e=>e.channel)):console.warn(`Invalid attribute parameter '${r}'`);const a=new Map;for(const[e,r]of i.entries()){const i=W(r,(e=>e.end)),o=Math.ceil(1e3*i/n),s=new Array(o).fill(0);for(let e of r){const t=Math.round(1e3*e.start/n),r=Math.round(1e3*e.end/n);for(let e=t;e<=r;e++)s[e]+=1}for(let e=0;e<s.length;e++)s[e]/=t;a.set(e,s)}return a}function Lo(e,t,n=.8){const r=[];for(const[i,a]of e.entries()){for(let e=0;e<a.length;e++)a[e]=a[e]>n;let e=null;for(let n=0;n<a.length;n++)if(!e&&a[n]&&(e=new j(i,n*t/1e3,127,0)),e&&(!a[n]||n===a.length-1)){const i=n*t/1e3;e.end=i,r.push(e),e=null}}return r.sort(((e,t)=>e.start-t.start)),r}function Io(e,t=.01,n,r){const i=V(e,(e=>e.pitch)),a=[];for(const[e,o]of i.entries()){const i=o.map((e=>e.start)),s=o.map((e=>e.end)),u=W(s),l=Math.ceil(n*u),c=ci().domain([0,u]).range([0,u]),h=Co(ko(t),c.ticks(l)),m=h(i),f=h(s),p=di(m.map((e=>e[1]))),b=di(f.map((e=>e[1]))),d=p.filter((e=>m[e][1]>r)).map((e=>m[e][0])),g=b.filter((e=>f[e][1]>r)).map((e=>f[e][0]));for(;d.length>0;){const t=d.shift();for(;g.length>0&&g[0]<t;)g.shift();const n=g.shift();for(;d.length>0&&d[0]<n;)d.shift();a.push(new j(e,t,127,0,n))}}return a.sort(((e,t)=>e.start-t.start)),a}function Oo(e,t,n){const r=Go(t,1,n),i=Go(e,1,n),a=Array.from(new Set(Array.from(r.keys()).concat(Array.from(i.keys())))),o=new Map;for(const e of a){let t;if(r.has(e))if(i.has(e)){const n=r.get(e),a=i.get(e),o=Math.max(n.length,a.length);t=new Array(o).fill(0);for(let e=0;e<t.length;e++){const r=a[e]||0,i=n[e]||0;0===r&&0===i&&(t[e]=0),0!==r&&0===i&&(t[e]=1),0===r&&0!==i&&(t[e]=2),0!==r&&0!==i&&(t[e]=3)}}else t=r.get(e).map((e=>0!==e?2:0));else t=i.get(e).map((e=>0!==e?1:0));o.set(e,t)}return o}function Fo(e){let t=0,n=0,r=0;for(const i of e.values())for(const e of i)1===e?t++:2===e?n++:3===e&&r++;const i=W(Array.from(e),(e=>e[1].length)),a=e.size*i;return{missing:t/a,additional:n/a,correct:r/a}}function jo(e,t,n=16){const r=pa(t)/n;return e.map((e=>{const t=e.clone();return t.start=Math.round(t.start/r)*r,t.end=Math.round(t.end/r)*r,t}))}function $o(e,t=1){if(navigator.requestMIDIAccess){let n,r=0,i=0;navigator.requestMIDIAccess().then((a=>{const o=()=>{const t=new Date-n;i+=t;const a=i/r;console.log(`Received MIDI from ${e} after ${t} ms (avg: ${a})`)};for(let t of a.inputs.values())e===t.name&&(t.onmidimessage=o);let s=null;for(let t of a.outputs.values())e===t.name&&(s=t);s||console.error(`Cannot ping output device ${e} because it is not there`);const u=()=>{r<t&&(r++,console.log(`Ping ${r}/${t} Sending MIDI ping to ${e}`),n=new Date,s.send([144,69,127]),setTimeout(u,1e3))};setTimeout(u,1e3)}),(()=>console.error("Cannot get MIDI access")))}else console.error("MIDI: WebMIDI is not supported in this browser.")}function Ro(e,t){const n=V(t,(e=>e.pitch)),r=V(e,(e=>e.pitch)),i=new Map;return n.forEach(((e,t)=>{const n=new Map,a=[],o=[];for(let t of e)n.set(t.start,null);if(!r.has(t))return void i.set(t,{gtRecMap:new Map,additionalNotes:[],missingNotes:e,gtNotes:e});const s=r.get(t);for(let t of s){const r=Uo(e,t),i=n.get(r.start);null===i?n.set(r.start,t):Math.abs(r.start-t.start)<Math.abs(i.start-t.start)?(n.set(r.start,t),a.push(i)):a.push(t)}for(let t of e)null===n.get(t.start)&&o.push(t);i.set(t,{gtRecMap:n,additionalNotes:a,missingNotes:o,gtNotes:e})})),r.forEach(((e,t)=>{n.has(t)||i.set(t,{gtRecMap:new Map,additionalNotes:e,missingNotes:[],gtNotes:[]})})),i}function Ho(e,t){const n=xi(e.map((e=>e.notes))),r=V(t,(e=>e.pitch)),i=V(n,(e=>e.pitch)),a=new Map;return r.forEach(((e,t)=>{const n=new Map;for(let t of e)n.set(t.start,[]);if(!i.has(t))return void a.set(t,new Map);const r=i.get(t);for(let t of r){const r=Uo(e,t),i=n.get(r.start);i.push(t),n.set(r.start,i)}a.set(t,n)})),a}function Vo(e,t=3){const n=new Map;return e.forEach(((e,r)=>{const i=new Map;let a=0;e.forEach(((e,n)=>{let r=0;if(e.length>0){for(let i of e){const e=Math.abs(i.start-n);e<=t&&(r+=e)}r/=e.length,r>a&&(a=r)}i.set(n,r)})),n.set(r,{gtErrorMap:i,maxError:a})})),n}function Wo(e,t,n,r,i=0){const a={total:0,totalAdd:0,totalMiss:0,totalCorrect:0,totalTime:0,totalNumberOfGtNotes:0,perPitch:new Map};return e.forEach(((e,o)=>{const{gtRecMap:s,additionalNotes:u,missingNotes:l,gtNotes:c}=e,h=u.length*t,m=l.length*n;let f=0,p=0;s.forEach(((e,t)=>{if(null!==e){f++;const n=Math.abs(e.start-t);n>i&&(p+=n)}}));const b=h+m+p*r;a.perPitch.set(o,{total:b,addError:h,missError:m,correct:f,timeError:p,numberOfGtNotes:c.length}),a.totalAdd+=h,a.totalMiss+=m,a.totalCorrect+=f,a.totalTime+=p,a.total+=b,a.totalNumberOfGtNotes+=c.length})),a}function zo(e,t,n){const r=new Map;return e.forEach(((e,i)=>{const{gtRecMap:a,additionalNotes:o,missingNotes:s,gtNotes:u}=e,l=new Map;a.forEach(((e,r)=>{null!==e&&r>=t&&r<n&&l.set(r,e)})),r.set(i,{gtRecMap:l,additionalNotes:o.filter((e=>e.start>=t&&e.start<n)),missingNotes:s.filter((e=>e.start>=t&&e.start<n)),gtNotes:u})})),r}function Xo(e,t,n,r,i,a){return Wo(zo(e,t,n),r,i,a)}function Uo(e,t){let n=null,r=1/0;const i=t.start;for(let t of e){const e=Math.abs(t.start-i);e<r&&(r=e,n=t)}return n}function Yo(e,t){t=t.clone();let n=function(e,t){let n=0,r=0;for(let i of e){let e=1/0,a=1/0;for(let n of t)if(i.pitch===n.pitch){const t=Math.abs(i.start-n.start);t<e&&(e=t,a=i.start-n.start)}e<1/0&&(n+=a,r++)}return n/r}(e.getNotes(),t.getNotes());return{aligned:t=t.shiftTime(n),timeDifference:n}}function Jo(e,t){let n=0,r=0;for(t=t.clone();r<25;){const i=Ro(t.getNotes(),e.getNotes());let a=0,o=0;for(let e of i.values()){const{gtRecMap:t}=e;for(let[e,n]of t.entries())null!==n&&(o++,a+=e-n.start)}if(a/=o,t.shiftTime(a),n+=a,Math.abs(a)<5e-4)break;r++}return{aligned:t,timeDifference:n}}function Ko(e,t){let n=0,r=0;for(t=t.clone();r<25;){const i=Ro(t.getNotes(),e.getNotes());let a=[];for(let e of i.values())for(let[t,n]of e.gtRecMap.entries())null!==n&&a.push(t-n.start);const o=K(a,.5,void 0);if(t.shiftTime(o),n+=o,Math.abs(o)<1e-4)break;r++}return{aligned:t,timeDifference:n}}function Qo(){function e(e,t,n){console.log(n),console.log(t.getNotes().map((e=>e.start)));const r=Yo(e,t);console.log(r.getNotes().map((e=>e.start)))}const t=new Mi([new j(69,0,127,0,1),new j(70,1,127,0,2),new j(71,2,127,0,3)]);let n;console.log(t.getNotes().map((e=>e.start))),n=t.clone().shiftTime(2),e(t,n,"shifted by 2"),n=t.clone().shiftTime(-2),e(t,n,"shifted by -2"),n=t.clone().shiftTime(3).addNotes([new j(72,2,127,0,3)]),e(t,n,"shifted by 3, added note"),n=t.clone().repeat(2),e(t,n,"repeated"),n=t.clone().repeat(2).shiftTime(3),e(t,n,"repeated, shifted by 3")}function Zo(){const e=.44871573888282423,t=wr.source(xr(e))(0,127),n=Pr.source(xr(e))(0,500),r=Pr.source(xr(e))(1/64,2),i=new Array(200).fill(0).map((()=>{const e=n();return new j(t(),e,127,0,e+r())})),a=new Mi(i).sortByTime();console.log("true notes",a.getNotes());const o=a.clone().shiftTime(3);console.log("shifted",o);let s=Ka(o.getNotes(),.1,.1,.1);s=new Mi(s),console.log("variation",s);const u=[Yo,Jo,Ko];console.log("True time shift: 3 seconds"),console.log("Only shifted");for(let e of u){const{timeDifference:t}=e(a,o),n=Math.abs(t- -3);console.log(`${e.name}\nshift: ${t.toFixed(3)} \nError ${n.toFixed(3)}`)}console.log("Shifted & variation");for(let e of u){const{timeDifference:t}=e(a,s),n=Math.abs(t- -3);console.log(`${e.name}\nshift: ${t.toFixed(3)} \nError ${n.toFixed(3)}`)}}class es{constructor(e,t,n){this.ser1=e,this.ser2=t,this.distFunc=n,this.distance=null,this.matrix=null,this.path=null}getDistance(){if(null!==this.distance)return this.distance;this.matrix=[];for(var e=0;e<this.ser1.length;e++){this.matrix[e]=[];for(var t=0;t<this.ser2.length;t++){var n=1/0;e>0?(n=Math.min(n,this.matrix[e-1][t]),t>0&&(n=Math.min(n,this.matrix[e-1][t-1]),n=Math.min(n,this.matrix[e][t-1]))):n=t>0?Math.min(n,this.matrix[e][t-1]):0,this.matrix[e][t]=n+this.distFunc(this.ser1[e],this.ser2[t])}}return this.distance=this.matrix[this.ser1.length-1][this.ser2.length-1],this.distance}getPath(){if(null!==this.path)return this.path;null===this.matrix&&this.getDistance();var e=this.ser1.length-1,t=this.ser2.length-1;for(this.path=[[e,t]];e>0||t>0;)e>0?t>0?this.matrix[e-1][t]<this.matrix[e-1][t-1]?this.matrix[e-1][t]<this.matrix[e][t-1]?(this.path.push([e-1,t]),e--):(this.path.push([e,t-1]),t--):this.matrix[e-1][t-1]<this.matrix[e][t-1]?(this.path.push([e-1,t-1]),e--,t--):(this.path.push([e,t-1]),t--):(this.path.push([e-1,t]),e--):(this.path.push([e,t-1]),t--);return this.path=this.path.reverse(),this.path}}function ts(e,t,n,r,i=1/16,a="euclidean"){if(console.log(`Searching for similar parts based on selection, using ${a}`),void 0===e||0===e.length)return void console.warn("No or empty track given");const o=X(e,(e=>e.start)),s=W(e,(e=>e.end)),u=Math.ceil((s-o)/i),l=rs(e,i),c=Math.floor((t[0]-o)/i),h=Math.ceil((t[1]-o)/i),m=as(l,c,h),f=h-c,p=[];for(let e=0;e<u-f;e+=n){const t=e+f;if(!(e>=c&&e<=h||t>=c&&t<=h)){const n=ns(m,as(l,e,t),a);n<=r&&p.push({startBin:e,endBin:t,startTime:o+e*i,endTime:o+t*i,dist:n})}}return{selection:{startBin:c,endBin:h,startTime:o+c*i,endTime:o+h*i},similarParts:p}}function ns(e,t,n){const r=[];for(let n of e.keys())t.has(n)&&r.push(n);let i=0;for(let a of r){const r=e.get(a),o=t.get(a);let s;"dtw"===n?s=new es(r,o,((e,t)=>Math.abs(e-t))).getDistance():"euclidean"===n?s=os(r,o):"nearest"===n&&(s=ss(r,o)),i+=1*s}let a=0;for(let n of[e,t])for(let e of n.keys())r.includes(e)||(a+=is(n.get(e)));return i+a}function rs(e,t){const n=X(e,(e=>e.start)),r=W(e,(e=>e.end)),i=Math.ceil((r-n)/t),a=new Map;for(let r of e){const e=Math.round((r.start-n)/t),o=Math.round((r.end-n)/t),s=r.pitch;let u;u=a.has(s)?a.get(s):new Array(i).fill(0);for(let t=e;t<=o;t++)u[t]=1;a.set(s,u)}return a}function is(e){let t=0;for(let n of e)1===n&&t++;return t}function as(e,t,n){const r=new Map;return e.forEach(((e,i)=>{r.set(i,e.slice(t,n))})),r}function os(e,t){const n=Math.max(e.length,t.length);let r=0;for(let i=0;i<n;i++){const n=(e[i]||0)-(t[i]||0);r+=n*n}return r}function ss(e,t){const n=Math.max(e.length,t.length),r=Math.round(n/4);let i=0;for(let a=0;a<n;a++){let n=0;const o=e[a]||0,s=t[a]||0;if(o===s);else if(0===o&&1===s)for(;n<=r&&(n++,1!==o[a-n]&&!o[a+n===1]););else if(1===o&&0===s)for(;n<=r&&(n++,1!==s[a-n]&&!s[a+n===1]););i+=n}return i}function us(e){if(void 0===e)return console.log("[Similarity] Undefined notes"),[];if(e.length<5)return console.log("[Similarity] Not enough notes to calculate similar parts"),[];let t=[];for(let n=0;n<e.length-3;n++){let r=n,i=e[r],a=[];for(let t=0;t<e.length;t++)e[t].pitch===i.pitch&&a.push({startIndex:t,length:1});for(r++;r<e.length&&a.length>1;){let n=e[r].pitch;a=a.filter((i=>{const a=i.startIndex+r;return a<e.length&&e[a].pitch===n?(i.length++,!0):(t.push(i),!1)})),r++}}t=t.filter((e=>e.length>4)).sort(((e,t)=>e.length-t.length));for(const n of t){const{startIndex:t,length:r}=n,i=t+r;console.log(`Sequence ${t} - ${i} length ${r}`);const a=e.slice(t,i);console.log(a.map((e=>e.pitch)).join(", "))}}const ls=(e,t)=>Array(Math.abs(t)+1).join(e);function cs(e,t,n){return function(...r){return console.warn(`${e} is deprecated. Use ${t}.`),n.apply(this,r)}}function hs(e){return null!==e&&"object"==typeof e&&"string"==typeof e.name}function ms(e){return null!==e&&"object"==typeof e&&"number"==typeof e.step&&"number"==typeof e.alt}const fs=[0,2,4,-1,1,3,5],ps=fs.map((e=>Math.floor(7*e/12)));function bs(e){const{step:t,alt:n,oct:r,dir:i=1}=e,a=fs[t]+7*n;return void 0===r?[i*a]:[i*a,i*(r-ps[t]-4*n)]}const ds=[3,0,4,1,5,2,6];function gs(e){const[t,n,r]=e,i=ds[function(e){const t=(e+1)%7;return t<0?7+t:t}(t)],a=Math.floor((t+1)/7);return void 0===n?{step:i,alt:a,dir:r}:{step:i,alt:a,oct:n+4*a+ps[i],dir:r}}const ys={empty:!0,name:"",pc:"",acc:""},vs=new Map,Ms=e=>e<0?ls("b",-e):ls("#",e),Ps=e=>"b"===e[0]?-e.length:e.length;function ws(e){const t=vs.get(e);if(t)return t;const n="string"==typeof e?function(e){const t=As(e);if(""===t[0]||""!==t[3])return ys;const n=t[0],r=t[1],i=t[2],a=(n.charCodeAt(0)+3)%7,o=Ps(r),s=i.length?+i:void 0,u=bs({step:a,alt:o,oct:s}),l=n+r+i,c=n+r,h=(xs[a]+o+120)%12,m=void 0===s?(12,((xs[a]+o)%12+12)%12-1188):xs[a]+o+12*(s+1),f=m>=0&&m<=127?m:null;return{empty:!1,acc:r,alt:o,chroma:h,coord:u,freq:void 0===s?null:440*Math.pow(2,(m-69)/12),height:m,letter:n,midi:f,name:l,oct:s,pc:c,step:a}}(e):ms(e)?ws(function(e){const{step:t,alt:n,oct:r}=e,i=(e=>"CDEFGAB".charAt(e))(t);if(!i)return"";const a=i+Ms(n);return r||0===r?a+r:a}(e)):hs(e)?ws(e.name):ys;return vs.set(e,n),n}const Ss=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function As(e){const t=Ss.exec(e);return[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]}const xs=[0,2,4,5,7,9,11],_s={empty:!0,name:"",acc:""},Ts=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$"),Es={};function Ns(e){return"string"==typeof e?Es[e]||(Es[e]=function(e){const t=function(e){const t=Ts.exec(`${e}`);return null===t?["",""]:t[1]?[t[1],t[2]]:[t[4],t[3]]}(e);if(""===t[0])return _s;const n=+t[0],r=t[1],i=(Math.abs(n)-1)%7,a=ks[i];if("M"===a&&"P"===r)return _s;const o="M"===a?"majorable":"perfectable",s=""+n+r,u=n<0?-1:1,l=8===n||-8===n?n:u*(i+1),c=function(e,t){return"M"===t&&"majorable"===e||"P"===t&&"perfectable"===e?0:"m"===t&&"majorable"===e?-1:/^A+$/.test(t)?t.length:/^d+$/.test(t)?-1*("perfectable"===e?t.length:t.length+1):0}(o,r),h=Math.floor((Math.abs(n)-1)/7);return{empty:!1,name:s,num:n,q:r,step:i,alt:c,dir:u,type:o,simple:l,semitones:u*(Cs[i]+c+12*h),chroma:(u*(Cs[i]+c)%12+12)%12,coord:bs({step:i,alt:c,oct:h,dir:u}),oct:h}}(e)):ms(e)?Ns(function(e){const{step:t,alt:n,oct:r=0,dir:i}=e;return i?(i<0?"-":"")+(t+1+7*r)+function(e,t){return 0===t?"majorable"===e?"M":"P":-1===t&&"majorable"===e?"m":t>0?ls("A",t):ls("d","perfectable"===e?t:t+1)}("M"===ks[t]?"majorable":"perfectable",n):""}(e)):hs(e)?Ns(e.name):_s}const Cs=[0,2,4,5,7,9,11],ks="PMMPPMM";function Bs(e){const[t,n=0]=e;return Ns(gs(7*t+12*n<0?[-t,-n,-1]:[t,n,1]))}function Ds(e,t){const n=ws(e),r=Ns(t);if(n.empty||r.empty)return"";const i=n.coord,a=r.coord;return function(e){return ws(gs(e))}(1===i.length?[i[0]+a[0]]:[i[0]+a[0],i[1]+a[1]]).name}function qs(e,t){const n=t.length,r=(e%n+n)%n;return t.slice(r,n).concat(t.slice(0,r))}const Gs={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},Ls=e=>Number(e).toString(2),Is=e=>parseInt(e,2),Os=/^[01]{12}$/;function Fs(e){return Os.test(e)}const js={[Gs.chroma]:Gs};function $s(e){const t=Fs(e)?e:(e=>"number"==typeof e&&e>=0&&e<=4095)(e)?Ls(e):Array.isArray(e)?function(e){if(0===e.length)return Gs.chroma;let t;const n=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<e.length;r++)t=ws(e[r]),t.empty&&(t=Ns(e[r])),t.empty||(n[t.chroma]=1);return n.join("")}(e):(e=>e&&Fs(e.chroma))(e)?e.chroma:Gs.chroma;return js[t]=js[t]||function(e){const t=Is(e),n=function(e){const t=e.split("");return t.map(((e,n)=>qs(n,t).join("")))}(e).map(Is).filter((e=>e>=2048)).sort()[0];return{empty:!1,name:"",setNum:t,chroma:e,normalized:Ls(n),intervals:Hs(e)}}(t)}cs("Pcset.pcset","Pcset.get",$s);const Rs=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function Hs(e){const t=[];for(let n=0;n<12;n++)"1"===e.charAt(n)&&t.push(Rs[n]);return t}function Vs(e){const t=$s(e).setNum;return e=>{const n=$s(e).setNum;return t&&t!==n&&(n|t)===n}}const Ws={...Gs,name:"",quality:"Unknown",intervals:[],aliases:[]};let zs=[],Xs={};function Us(e){return Xs[e]||Ws}function Ys(){return zs.slice()}cs("ChordType.chordType","ChordType.get",Us),cs("ChordType.entries","ChordType.all",Ys),[["1P 3M 5P","major","M ^ "],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth/ninth","6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 Δ#4 Δ#11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ -^7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]].forEach((([e,t,n])=>function(e,t,n){const r=function(e){const t=t=>-1!==e.indexOf(t);return t("5A")?"Augmented":t("3M")?"Major":t("5d")?"Diminished":t("3m")?"Minor":"Unknown"}(e),i={...$s(e),name:n||"",quality:r,intervals:e,aliases:t};zs.push(i),i.name&&(Xs[i.name]=i),Xs[i.setNum]=i,Xs[i.chroma]=i,i.aliases.forEach((e=>function(e,t){Xs[t]=e}(i,e)))}(e.split(" "),n.split(" "),t))),zs.sort(((e,t)=>e.setNum-t.setNum));const Js={...Gs,intervals:[],aliases:[]};let Ks=[],Qs={};function Zs(e){return Qs[e]||Js}function eu(){return Ks.slice()}cs("ScaleDictionary.scaleType","ScaleType.get",Zs),cs("ScaleDictionary.entries","ScaleType.all",eu),[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 7m","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2m 3m 4d 5d 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","·superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 5d 5P 6M 7m","romanian minor"],["1P 2M 3m 4A 5P 6M 7m","dorian #4"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3m 4P 5P 6m 7m","aeolian","minor"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]].forEach((([e,t,...n])=>function(e,t,n=[]){const r={...$s(e),name:t,intervals:e,aliases:n};return Ks.push(r),Qs[r.name]=r,Qs[r.setNum]=r,Qs[r.chroma]=r,r.aliases.forEach((e=>function(e,t){Qs[t]=e}(r,e))),r}(e.split(" "),t,n)));const tu={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]},nu=/^(6|64|7|9|11|13)$/;function ru(e){const[t,n,r,i]=As(e);return""===t?["",e]:"A"===t&&"ug"===i?["","aug"]:i||"4"!==r&&"5"!==r?nu.test(r)?[t+n,r+i]:[t+n+r,i]:[t+n,r]}function iu(e){if(""===e)return tu;if(Array.isArray(e)&&2===e.length)return au(e[1],e[0]);{const[t,n]=ru(e),r=au(n,t);return r.empty?au(e):r}}function au(e,t,n){const r=Us(e),i=ws(t||""),a=ws(n||"");if(r.empty||t&&i.empty||n&&a.empty)return tu;const o=function(e,t){const n=ws(e),r=ws(t);if(n.empty||r.empty)return"";const i=n.coord,a=r.coord,o=a[0]-i[0];return Bs([o,2===i.length&&2===a.length?a[1]-i[1]:-Math.floor(7*o/12)]).name}(i.pc,a.pc),s=r.intervals.indexOf(o)+1;if(!a.empty&&!s)return tu;const u=Array.from(r.intervals);for(let e=1;e<s;e++){const e=u[0][0],t=u[0][1],n=parseInt(e,10)+7;u.push(`${n}${t}`),u.shift()}const l=i.empty?[]:u.map((e=>Ds(i,e)));e=-1!==r.aliases.indexOf(e)?e:r.aliases[0];const c=`${i.empty?"":i.pc}${e}${a.empty||s<=1?"":"/"+a.pc}`,h=`${t?i.pc+" ":""}${r.name}${s>1&&n?" over "+a.pc:""}`;return{...r,name:h,symbol:c,type:r.name,root:a.name,intervals:u,rootDegree:s,tonic:i.name,notes:l}}const ou={getChord:au,get:iu,detect:function(e){const t=e.map((e=>ws(e).pc)).filter((e=>e));return 0===ws.length?[]:function(e,t){const n=e[0],r=ws(n).chroma,i=(e=>{const t=e.reduce(((e,t)=>{const n=ws(t).chroma;return void 0!==n&&(e[n]=e[n]||ws(t).name),e}),{});return e=>t[e]})(e),a=function(e,t=!0){const n=$s(e).chroma.split("");return n.map(((e,r)=>{const i=qs(r,n);return t&&"0"===i[0]?null:i.join("")})).filter((e=>0===e||e))}(e,!1),o=[];return a.forEach(((e,t)=>{Ys().filter((t=>t.chroma===e)).forEach((e=>{const a=e.aliases[0],s=i(t);t!==r?o.push({weight:.5,name:`${s}${a}/${n}`}):o.push({weight:1,name:`${s}${a}`})}))})),o}(t).filter((e=>e.weight)).sort(((e,t)=>t.weight-e.weight)).map((e=>e.name))},chordScales:function(e){const t=Vs(iu(e).chroma);return eu().filter((e=>t(e.chroma))).map((e=>e.name))},extended:function(e){const t=iu(e),n=Vs(t.chroma);return Ys().filter((e=>n(e.chroma))).map((e=>t.tonic+e.aliases[0]))},reduced:function(e){const t=iu(e),n=function(e){const t=$s(e).setNum;return e=>{const n=$s(e).setNum;return t&&t!==n&&(n&t)===n}}(t.chroma);return Ys().filter((e=>n(e.chroma))).map((e=>t.tonic+e.aliases[0]))},tokenize:ru,transpose:function(e,t){const[n,r]=ru(e);return n?Ds(n,t)+r:e},chord:cs("Chord.chord","Chord.get",iu)},su=[];[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]].forEach((([e,t,n])=>function(e,t,n){su.push({empty:!1,dots:"",name:"",value:1/e,fraction:e<1?[1/e,1]:[1,e],shorthand:t,names:n})}(e,t,n)));function uu(e){return(t,n)=>{const r=Ns(t).coord,i=Ns(n).coord;if(r&&i)return Bs(e(r,i)).name}}"P m M m M P d P m M m M".split(" "),uu(((e,t)=>[e[0]+t[0],e[1]+t[1]])),uu(((e,t)=>[e[0]-t[0],e[1]-t[1]])),Math.log(2),Math.log(440),"C C# D D# E F F# G G# A A# B".split(" "),"C Db D Eb E F Gb G Ab A Bb B".split(" ");const lu={empty:!0,name:"",chordType:""},cu={};function hu(e){return"string"==typeof e?cu[e]||(cu[e]=function(e){const[t,n,r,i]=(a=e,mu.exec(a)||["","","",""]);var a;if(!r)return lu;const o=r.toUpperCase(),s=pu.indexOf(o),u=Ps(n);return{empty:!1,name:t,roman:r,interval:Ns({step:s,alt:u,dir:1}).name,acc:n,chordType:i,alt:u,step:s,major:r===o,oct:0,dir:1}}(e)):"number"==typeof e?hu(pu[e]||""):ms(e)?hu(Ms((t=e).alt)+pu[t.step]):hs(e)?hu(e.name):lu;var t}cs("RomanNumeral.romanNumeral","RomanNumeral.get",hu);const mu=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/,fu="I II III IV V VI VII",pu=fu.split(" ");fu.toLowerCase().split(" ");Object.freeze([]);const bu=(e,t,n="")=>t.map(((t,r)=>`${e[r]}${n}${t}`));function du(e,t,n,r){return i=>{const a=e.map((e=>hu(e).interval||"")),o=a.map((e=>Ds(i,e)));return{tonic:i,grades:e,intervals:a,scale:o,chords:bu(o,t),chordsHarmonicFunction:n.slice(),chordScales:bu(o,r," ")}}}du("I II III IV V VI VII".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),du("I II bIII IV V bVI bVII".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),du("I II bIII IV V bVI VII".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),du("I II bIII IV V VI VII".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D  ".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));const gu=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],yu={...Gs,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},vu=gu.map((function(e){const[t,n,r,i,a,o,s]=e,u=s?[s]:[],l=Number(n).toString(2);return{empty:!1,intervals:Hs(l),modeNum:t,chroma:l,normalized:l,name:i,setNum:n,alt:r,triad:a,seventh:o,aliases:u}})),Mu={};function Pu(e){return"string"==typeof e?Mu[e.toLowerCase()]||yu:e&&e.name?Pu(e.name):yu}vu.forEach((e=>{Mu[e.name]=e,e.aliases.forEach((t=>{Mu[t]=e}))}));cs("Mode.mode","Mode.get",Pu);cs("Mode.mode","Mode.all",(function(){return vu.slice()}));function wu(e){return(t,n)=>{const r=Pu(t);if(r.empty)return[];const i=qs(r.modeNum,e),a=r.intervals.map((e=>Ds(n,e)));return i.map(((e,t)=>a[t]+e))}}wu(gu.map((e=>e[4]))),wu(gu.map((e=>e[5])));const Su={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function Au(e,t=!0){if(e.length<2)return[];const n=[];let r=[];for(let i=1;i<e.length;i++){const a=e[i],o=e[i-1];a.start<o.end?(0===r.length&&r.push(o),r.push(a)):r.length>0&&(t&&(r=r.sort(((e,t)=>e.pitch-t.pitch))),n.push(r),r=[])}return n}function xu(e){const t=V(e,(e=>e.start));return Array.from(t).map((e=>e[1])).filter((e=>e.length>1)).sort(((e,t)=>e[0].start-t[0].start)).map((e=>e.sort(((e,t)=>e.pitch-t.pitch))))}cs("Scale.scale","Scale.get",(function(e){const t=Array.isArray(e)?e:function(e){if("string"!=typeof e)return["",""];const t=e.indexOf(" "),n=ws(e.substring(0,t));if(n.empty){const t=ws(e);return t.empty?["",e]:[t.name,""]}const r=e.substring(n.name.length+1);return[n.name,r.length?r:""]}(e),n=ws(t[0]).name,r=Zs(t[1]);if(r.empty)return Su;const i=r.name,a=n?r.intervals.map((e=>Ds(n,e))):[],o=n?n+" "+i:i;return{...r,name:o,type:i,tonic:n,notes:a}})),new Map;const _u=new Map([[1,[{steps:[5],name:"Inverted power chord",suffix:"?"},{steps:[7],name:"Power chord",suffix:"5"}]],[2,[{steps:[2,7],name:"Suspended second",suffix:"sus2"},{steps:[3,6],name:"Diminished",suffix:"dim"},{steps:[3,7],name:"Minor",suffix:"min"},{steps:[4,10],name:"Seventh",suffix:"7"},{steps:[4,7],name:"Major",suffix:""},{steps:[4,8],name:"Augmented",suffix:"aug"},{steps:[4,9],name:"Sixth",suffix:"6"},{steps:[5,7],name:"Suspended fourth",suffix:"sus4"}]],[3,[{steps:[2,3,7],name:"Minor, added ninth",suffix:"m(add9)"},{steps:[2,4,7],name:"Added ninth",suffix:"add9"},{steps:[3,6,10],name:"Minor seventh, flat fifth",suffix:"m7b5"},{steps:[3,7,10],name:"Minor seventh",suffix:"m7"},{steps:[3,7,11],name:"Minor, major seventh",suffix:"m(Maj7)"},{steps:[3,7,8],name:"Minor, flat sixth",suffix:"mb6"},{steps:[3,7,9],name:"Minor sixth",suffix:"m6"},{steps:[4,5,11],name:"Major eleventh (no fifth, no ninth)",suffix:"Maj11"},{steps:[4,5,7],name:"Added fourth",suffix:"add4"},{steps:[4,7,10],name:"Dominant seventh",suffix:"7"},{steps:[4,7,11],name:"Major seventh",suffix:"Maj7"},{steps:[4,7,9],name:"Major Sixth",suffix:"Maj6"}]],[4,[{steps:[2,3,6,10],name:"Minor ninth flat fifth",suffix:"m9b5"},{steps:[2,3,7,10],name:"Minor ninth",suffix:"m9"},{steps:[2,3,7,11],name:"Minor ninth, major seventh",suffix:"m9(Maj7)"},{steps:[2,3,7,9],name:"Minor sixth, added ninth",suffix:"m6/9"},{steps:[2,4,7,11],name:"Major ninth",suffix:"Maj9"},{steps:[2,4,7,9],name:"Sixth, added ninth",suffix:"6/9"},{steps:[4,5,7,11],name:"Major eleventh (no ninth)",suffix:"Maj11"},{steps:[4,6,7,10],name:"Seventh, sharp eleventh",suffix:"7#11"},{steps:[4,6,7,11],name:"Major seventh, sharp eleventh",suffix:"Maj7#11"}]],[5,[{steps:[2,4,5,7,11],name:"Major eleventh",suffix:"Maj11"},{steps:[2,4,7,9,11],name:"Major thirteen",suffix:"Maj13"}]],[6,[{steps:[2,3,4,6,7,10],name:"Minor thirteen",suffix:"m13"}]]]);function Tu(e){if(0===e.length)return{name:"No note"};if(1===e.length)return{name:"Single note"};let t=[];const n=e[0].pitch;for(let r=1;r<e.length;r++)t.push(e[r].pitch-n);if(t=t.map((e=>e%12)),t=t.filter((e=>0!==e)),t=Array.from(new Set(t)),0===t.length)return{name:"Octave"};t.sort(((e,t)=>e-t));const r=_u.get(t.length);for(const e of r)if(Pi(t,e.steps))return e;return{name:"Unknown chord type"}}function Eu(e){const t=e.map((e=>e.getLetter));return ou.detect(t)}function Nu(){const e=[{notes:[{pitch:0},{pitch:7}],result:"Power chord"},{notes:[{pitch:10},{pitch:17}],result:"Power chord"},{notes:[{pitch:0},{pitch:2},{pitch:3},{pitch:7}],result:"Minor, added ninth"},{notes:[{pitch:0},{pitch:7},{pitch:12}],result:"Power chord"}];for(const t of e){const e=Tu(t.notes);e!==t.result&&console.warn(`Invalid chord result, expected ${t.result}, got ${e}`)}}function Cu(e,t){if(0===e.length)return t.length;if(0===t.length)return e.length;let n,r,i,a,o,s;for(e.length>t.length&&(n=e,e=t,t=n),s=Array(e.length+1),r=0;r<=e.length;r++)s[r]=r;for(r=1;r<=t.length;r++){for(a=r,i=1;i<=e.length;i++)o=t[r-1]===e[i-1]?s[i-1]:Math.min(s[i-1]+1,Math.min(a+1,s[i]+1)),s[i-1]=a,a=o;s[e.length]=a}return s[e.length]}function ku(e,t){const n=Math.max(e.length,t.length);return 0===n?0:Cu(e,t)/n}function Bu(e,t){const n=e.length,r=t.length;if(0===e.length)return e;if(0===t.length)return t;let i,a,o,s,u,l=[],c=[],h=[];for(a=0;a<r;c[a++]=0);for(i=0;i<n;i++)for(h[i]=c=c.slice(),s=0,a=0;a<r;a++,s=u)u=c[a],e[i]===t[a]?c[a]=s+1:(o=c[a-1]||0,o>c[a]&&(c[a]=o));for(i--,a--;i>-1&&a>-1;)switch(h[i][a]){default:a--,l.unshift(e[i]);case i&&h[i-1][a]:i--;continue;case a&&h[i][a-1]:a--}return e instanceof Array||t instanceof Array?l:l.join("")}function Du(e,t){const n=e.length,r=t.length;if(0===e.length)return 0;if(0===t.length)return 0;let i,a,o,s,u,l=[],c=[];for(a=0;a<r;l[a++]=0);for(i=0;i<n;i++)for(c[i]=l=l.slice(),s=0,a=0;a<r;a++,s=u)u=l[a],e[i]===t[a]?l[a]=s+1:(o=l[a-1]||0,o>l[a]&&(l[a]=o));return i--,a--,l[a]}function qu(e,t){const n=Math.max(e.length,t.length);return 0===n?0:Du(e,t)/n}function Gu(e,t,n=Iu,r=-1,i=-.1){if(0===e.length&&0===t.length)return 0;const a=e=>r+(e-1)*i,o=(e,t,n)=>Math.max(Math.max(e,t),n),s=e.length,u=t.length,l=new Array(s+1).fill(0).map((()=>new Array(u+1))),c=new Array(s+1).fill(0).map((()=>new Array(u+1))),h=new Array(s+1).fill(0).map((()=>new Array(u+1)));l[0][0]=0,c[0][0]=0,h[0][0]=0;for(let e=1;e<=s;e++)l[e][0]=h[e][0]=-1/0,c[e][0]=a(e);for(let e=1;e<=u;e++)l[0][e]=c[0][e]=-1/0,h[0][e]=a(e);for(let a=1;a<=s;a++)for(let s=1;s<=u;s++){const u=n(e[a-1],t[s-1]);l[a][s]=o(l[a-1][s-1],c[a-1][s-1],h[a-1][s-1])+u,c[a][s]=o(l[a-1][s]+r,c[a-1][s]+i,h[a-1][s]+r),h[a][s]=o(l[a][s-1]+r,c[a][s-1]+r,h[a][s-1]+i)}return o(l[s][u],c[s][u],h[s][u])}function Lu(e,t,n=Iu,r=-1,i=-.1){const a=Gu(e,t,n,r,i),o=e.length>=t.length?e:t,s=Gu(o,o,n,r,i);return 0===s?a:a/s}const Iu=(e,t)=>e===t?1:-1,Ou=(e,t)=>-Math.abs(e-t);class Fu{constructor(e){if(this.string=e,this.node=new ju,e&&e.length)for(let t=0;t<e.length;t++)this.node.addSuffix(e.slice(t))}toString(){return this.node.toString()}toJson(){return JSON.stringify(this.node)}}class ju{constructor(){this.value="",this.leaves=[],this.nodes=[]}checkNodes(e){let t;for(let n=0;n<this.nodes.length;n++)if(t=this.nodes[n],t.value===e[0])return t.addSuffix(e.slice(1)),!0;return!1}checkLeaves(e){let t,n;for(let r=0;r<this.leaves.length;r++)if(n=this.leaves[r],n[0]===e[0])return t=new ju,t.value=n[0],t.addSuffix(e.slice(1)),t.addSuffix(n.slice(1)),this.nodes.push(t),void this.leaves.splice(r,1);this.leaves.push(e)}addSuffix(e){e.length&&(this.checkNodes(e)||this.checkLeaves(e))}getLongestRepeatedSubString(){let e="",t="";for(let n=0;n<this.nodes.length;n++)t=this.nodes[n].getLongestRepeatedSubString(),t.length>e.length&&(e=t);return this.value+e}toHTML(){let e="<div class=node>";if(this.value.length&&(e+="<h3>"+this.value+"</h3>"),this.nodes.length){e+="<h4>nodes</h4><ul>";for(let t=0;t<this.nodes.length;t++)e+="<li>"+this.nodes[t].toHTML()+"</li>";e+="</ul>"}if(this.leaves.length){e+="<h4>leaves</h4><ul>";for(let t=0;t<this.leaves.length;t++)e+="<li>"+this.leaves[t]+"</li>";e+="</ul>"}return e}toString(e=1){const t=" |".repeat(e);let n="";if(this.value.length?n+=`-N '${this.value}'`:n+="root",this.nodes.length)for(let r=0;r<this.nodes.length;r++)n+=`\n${t}`+this.nodes[r].toString(e+1);if(this.leaves.length)for(let e=0;e<this.leaves.length;e++)n+=`\n${t}-L `+this.leaves[e];return n}}class $u{constructor(e){if(this.string=e,this.node=new Ru,e&&e.length)for(let t=0;t<e.length;t++)this.node.addSuffix(e.slice(t))}toString(){return this.node.toString()}toJson(){return JSON.stringify(this.node)}}class Ru{constructor(){this.value=[],this.leaves=[],this.nodes=[]}checkNodes(e){let t;for(let n=0;n<this.nodes.length;n++)if(t=this.nodes[n],Pi(t.value,[e[0]]))return t.addSuffix(e.slice(1)),!0;return!1}checkLeaves(e){let t,n;for(let r=0;r<this.leaves.length;r++)if(n=this.leaves[r],n[0]===e[0])return t=new Ru,t.value=[n[0]],t.addSuffix(e.slice(1)),t.addSuffix(n.slice(1)),this.nodes.push(t),void this.leaves.splice(r,1);this.leaves.push(e)}addSuffix(e){e.length&&(this.checkNodes(e)||this.checkLeaves(e))}getLongestRepeatedSubString(){let e=[],t=[];for(let n=0;n<this.nodes.length;n++)t=this.nodes[n].getLongestRepeatedSubString(),t.length>e.length&&(e=t);return this.value.concat(e)}toString(e=1){const t=" |".repeat(e);let n="";if(this.value.length?n+=`-N '${this.value}'`:n+="root",this.nodes.length)for(let r=0;r<this.nodes.length;r++)n+=`\n${t}`+this.nodes[r].toString(e+1);if(this.leaves.length)for(let e=0;e<this.leaves.length;e++)n+=`\n${t}-L `+this.leaves[e];return n}}class Hu{constructor(e,t,n=1,r=-1,i=-1){this.seq1=e,this.seq2=t,this.match_score=n,this.mismatch_penalty=r,this.gap_penalty=i,this.I=[],this.S=[],this.T=[],this.final_alignments=[],this.calcScoresAndTracebacks()}calcScoresAndTracebacks(){this.S.push([0]),this.I.push([[null,null,null]]),this.T.push([[!1,!1,!1]]);for(let e=1;e<this.seq2.length+1;e++)this.S[0].push(this.S[0][this.S[0].length-1]+this.gap_penalty),this.I[0].push([null,null,null]),this.T[0].push([!0,!1,!1]);for(let e=1;e<this.seq1.length+1;e++){this.S.push([this.S[e-1][0]+this.gap_penalty]),this.I.push([[null,null,null]]),this.T.push([[!1,!1,!0]]);for(let t=1;t<this.seq2.length+1;t++){const n=this.S[e][t-1]+this.gap_penalty,r=this.S[e-1][t]+this.gap_penalty;let i;i=this.seq1[e-1]===this.seq2[t-1]?this.match_score:this.mismatch_penalty;const a=[n,this.S[e-1][t-1]+i,r],o=Math.max(...a),s=a.map((e=>e===o));this.S[e].push(o),this.I[e].push(a),this.T[e].push(s)}}const e=this.S[this.S.length-1];this.score=e[e.length-1]}alignmentChildren(e){const[t,n]=e,r=[],i=this.T[t][n];return i[0]&&r.push({pos:[t,n-1],tracebackType:0}),i[1]&&r.push({pos:[t-1,n-1],tracebackType:1}),i[2]&&r.push({pos:[t-1,n],tracebackType:2}),r}alignmentTraceback(){let e,t,n,r,i,a,o,s=[];for(e={next:null,pos:[this.seq1.length,this.seq2.length],alignment:{seq1:"",seq2:""}};e;)for(a=e.pos,i=e.alignment,n=this.alignmentChildren(e.pos),n.length||s.push(i),e=e.next,o=0,r=n.length;o<r;o++)t=n[o],t.alignment={seq1:i.seq1.concat(0===t.tracebackType?"-":this.seq1[a[0]-1]),seq2:i.seq2.concat(2===t.tracebackType?"-":this.seq2[a[1]-1])},t.next=e,e=t;return s}}},346:(e,t,n)=>{"use strict";var r=n(194),i=n(782);function a(e){return/\.js(\?.*)?$/i.test(e)}function o(e,t,n){return"https://gleitz.github.io/midi-js-soundfonts/"+(t="FluidR3_GM"===t?t:"MusyngKite")+"/"+e+"-"+(n="ogg"===n?n:"mp3")+".js"}var s=n(975);s.instrument=function e(t,n,s){if(1===arguments.length)return function(n,r){return e(t,n,r)};var u=s||{},l=u.isSoundfontURL||a,c=u.nameToUrl||o,h=l(n)?n:c(n,u.soundfont,u.format);return r(t,h,{only:u.only||u.notes}).then((function(e){var r=i(t,e,u).connect(u.destination?u.destination:t.destination);return r.url=h,r.name=n,r}))},s.nameToUrl=o,e.exports&&(e.exports=s),"undefined"!=typeof window&&(window.Soundfont=s)},975:(e,t,n)=>{"use strict";var r=n(289);function i(e,t){if(console.warn("new Soundfont() is deprected"),console.log("Please use Soundfont.instrument() instead of new Soundfont().instrument()"),!(this instanceof i))return new i(e);this.nameToUrl=t||i.nameToUrl,this.ctx=e,this.instruments={},this.promises=[]}function a(e,t){return t=t||{},function(n,i,a,o){console.warn("The oscillator player is deprecated."),console.log("Starting with version 0.9.0 you will have to wait until the soundfont is loaded to play sounds.");var s=n>0&&n<129?+n:r.midi(n),u=s?r.midiToFreq(s,440):null;if(u){a=a||.2;var l=(o=o||{}).destination||t.destination||e.destination,c=o.vcoType||t.vcoType||"sine",h=o.gain||t.gain||.4,m=e.createOscillator();m.type=c,m.frequency.value=u;var f=e.createGain();return f.gain.value=h,m.connect(f),f.connect(l),m.start(i),a>0&&m.stop(i+a),m}}}i.prototype.onready=function(e){console.warn("deprecated API"),console.log("Please use Promise.all(Soundfont.instrument(), Soundfont.instrument()).then() instead of new Soundfont().onready()"),Promise.all(this.promises).then(e)},i.prototype.instrument=function(e,t){console.warn("new Soundfont().instrument() is deprecated."),console.log("Please use Soundfont.instrument() instead.");var n=this.ctx;if((e=e||"default")in this.instruments)return this.instruments[e];var r={name:e,play:a(n,t)};if(this.instruments[e]=r,"default"!==e){var o=i.instrument(n,e,t).then((function(e){return r.play=e.play,r}));this.promises.push(o),r.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),o.then(e)}}else r.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),e()};return r},i.loadBuffers=function(e,t,n){return console.warn("Soundfont.loadBuffers is deprecate."),console.log("Use Soundfont.instrument(..) and get buffers properties from the result."),i.instrument(e,t,n).then((function(e){return e.buffers}))},i.noteToMidi=r.midi,e.exports=i},653:e=>{e.exports=function(e){var i=e.createGain(),a=i._voltage=function(e){var t=e.createBufferSource(),r=e.createBuffer(1,2,e.sampleRate);return r.getChannelData(0).set(n),t.buffer=r,t.loop=!0,t}(e),o=r(a),s=r(a),u=r(a);return i._startAmount=r(s),i._endAmount=r(u),i._multiplier=r(o),i._multiplier.connect(i),i._startAmount.connect(i),i._endAmount.connect(i),i.value=o.gain,i.startValue=s.gain,i.endValue=u.gain,i.startValue.value=0,i.endValue.value=0,Object.defineProperties(i,t),i};var t={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(e){var t=this._multiplier.gain,n=this._startAmount.gain,r=this._endAmount.gain;this._voltage.start(e),this._decayFrom=this._decayFrom=e+this.attack,this._startedAt=e;var a=this.sustain;t.cancelScheduledValues(e),n.cancelScheduledValues(e),r.cancelScheduledValues(e),r.setValueAtTime(0,e),this.attack?(t.setValueAtTime(0,e),t.linearRampToValueAtTime(1,e+this.attack),n.setValueAtTime(1,e),n.linearRampToValueAtTime(0,e+this.attack)):(t.setValueAtTime(1,e),n.setValueAtTime(0,e)),this.decay&&t.setTargetAtTime(a,this._decayFrom,i(this.decay))}},stop:{value:function(e,t){t&&(e-=this.release);var n=e+this.release;if(this.release){var r=this._multiplier.gain,a=this._startAmount.gain,o=this._endAmount.gain;r.cancelScheduledValues(e),a.cancelScheduledValues(e),o.cancelScheduledValues(e);var s=i(this.release);if(this.attack&&e<this._decayFrom){var u=function(e,t,n,r,i){var a=0+(i-n)/(r-n)*1;return a<=0&&(a=0),a>=1&&(a=1),a}(0,0,this._startedAt,this._decayFrom,e);r.linearRampToValueAtTime(u,e),a.linearRampToValueAtTime(1-u,e),a.setTargetAtTime(0,e,s)}o.setTargetAtTime(1,e,s),r.setTargetAtTime(0,e,s)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(e){this._voltage.onended=e}}},n=new Float32Array([1,1]);function r(e){var t=e.context.createGain();return e.connect(t),t}function i(e){return Math.log(e+1)/Math.log(100)}},364:e=>{"use strict";e.exports={decode:function(e,t){for(var n,r,i,a=e.replace(/[^A-Za-z0-9\+\/]/g,""),o=a.length,s=t?Math.ceil((3*o+1>>2)/t)*t:3*o+1>>2,u=new Uint8Array(s),l=0,c=0,h=0;h<o;h++)if(r=3&h,l|=((i=a.charCodeAt(h))>64&&i<91?i-65:i>96&&i<123?i-71:i>47&&i<58?i+4:43===i?62:47===i?63:0)<<18-6*r,3===r||o-h==1){for(n=0;n<3&&c<s;n++,c++)u[c]=l>>>(16>>>n&24)&255;l=0}return u}}},234:e=>{"use strict";e.exports=function(e,t){return new Promise((function(n,r){var i=new XMLHttpRequest;t&&(i.responseType=t),i.open("GET",e),i.onload=function(){200===i.status?n(i.response):r(Error(i.statusText))},i.onerror=function(){r(Error("Network Error"))},i.send()}))}},194:(e,t,n)=>{"use strict";var r=n(364),i=n(234);function a(e){return function(t){return"string"==typeof t&&e.test(t)}}function o(e,t){return"string"==typeof e?e+t:"function"==typeof e?e(t):t}function s(e,t,n,r){var i,a=t instanceof ArrayBuffer?u:l(t)?c:(i=t)&&"function"==typeof i.then?h:m(t)?f:function(e){return e&&"object"==typeof e}(t)?p:b(t)?d:g(t)?y:v(t)?M:null;return a?a(e,t,n||{}):r?Promise.resolve(r):Promise.reject("Source not valid ("+t+")")}function u(e,t,n){return new Promise((function(n,r){e.decodeAudioData(t,(function(e){n(e)}),(function(){r("Can't decode audio data ("+t.slice(0,30)+"...)")}))}))}s.fetch=i;var l=a(/\.(mp3|wav|ogg)(\?.*)?$/i);function c(e,t,n){var r=o(n.from,t);return s(e,s.fetch(r,"arraybuffer"),n)}function h(e,t,n){return t.then((function(t){return s(e,t,n)}))}var m=Array.isArray;function f(e,t,n){return Promise.all(t.map((function(t){return s(e,t,n,t)})))}function p(e,t,n){var r={},i=Object.keys(t).map((function(i){if(n.only&&-1===n.only.indexOf(i))return null;var a=t[i];return s(e,a,n,a).then((function(e){r[i]=e}))}));return Promise.all(i).then((function(){return r}))}var b=a(/\.json(\?.*)?$/i);function d(e,t,n){var r=o(n.from,t);return s(e,s.fetch(r,"text").then(JSON.parse),n)}var g=a(/^data:audio/);function y(e,t,n){var i=t.indexOf(",");return s(e,r.decode(t.slice(i+1)).buffer,n)}var v=a(/\.js(\?.*)?$/i);function M(e,t,n){var r=o(n.from,t);return s(e,s.fetch(r,"text").then(P),n)}function P(e){var t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");t=e.indexOf("=",t)+2;var n=e.lastIndexOf(",");return JSON.parse(e.slice(t,n)+"}")}e.exports&&(e.exports=s),"undefined"!=typeof window&&(window.loadAudio=s)},803:e=>{e.exports=function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){return i(t[o][1][e]||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var a=void 0,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return new function(e){if(this._event=e,this._data=e.data,this.receivedTime=e.receivedTime,this._data&&this._data.length<2)console.warn("Illegal MIDI message of length",this._data.length);else switch(this._messageCode=240&e.data[0],this.channel=15&e.data[0],this._messageCode){case 128:this.messageType="noteoff",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 144:this.messageType="noteon",this.key=127&e.data[1],this.velocity=127&e.data[2];break;case 160:this.messageType="keypressure",this.key=127&e.data[1],this.pressure=127&e.data[2];break;case 176:this.messageType="controlchange",this.controllerNumber=127&e.data[1],this.controllerValue=127&e.data[2],120===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allsoundoff":121===this.controllerNumber?this.channelModeMessage="resetallcontrollers":122===this.controllerNumber?0===this.controllerValue?this.channelModeMessage="localcontroloff":this.channelModeMessage="localcontrolon":123===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allnotesoff":124===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeoff":125===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeon":126===this.controllerNumber?this.channelModeMessage="monomodeon":127===this.controllerNumber&&(this.channelModeMessage="polymodeon");break;case 192:this.messageType="programchange",this.program=e.data[1];break;case 208:this.messageType="channelpressure",this.pressure=127&e.data[1];break;case 224:this.messageType="pitchbendchange";var t=127&e.data[2],n=127&e.data[1];this.pitchBend=(t<<8)+n}}(e)},t.exports=n.default},{}]},{},[1])(1)},289:(e,t,n)=>{"use strict";function r(e,t){return Array(t+1).join(e)}function i(e){return"number"==typeof e}function a(e,t){return Math.pow(2,(e-69)/12)*(t||440)}n.r(t),n.d(t,{regex:()=>s,parse:()=>l,build:()=>c,midi:()=>h,freq:()=>m,letter:()=>f,acc:()=>p,pc:()=>b,step:()=>d,alt:()=>g,chroma:()=>y,oct:()=>v});var o=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;function s(){return o}var u=[0,2,4,5,7,9,11];function l(e,t,n){if("string"!=typeof e)return null;var r=o.exec(e);if(!r||!t&&r[4])return null;var i={letter:r[1].toUpperCase(),acc:r[2].replace(/x/g,"##")};i.pc=i.letter+i.acc,i.step=(i.letter.charCodeAt(0)+3)%7,i.alt="b"===i.acc[0]?-i.acc.length:i.acc.length;var s=u[i.step]+i.alt;return i.chroma=s<0?12+s:s%12,r[3]&&(i.oct=+r[3],i.midi=s+12*(i.oct+1),i.freq=a(i.midi,n)),t&&(i.tonicOf=r[4]),i}function c(e,t,n){return null==e?null:e.step?c(e.step,e.alt,e.oct):e<0||e>6?null:"CDEFGAB".charAt(e)+(i(a=t)?a<0?r("b",-a):r("#",a):"")+function(e){return i(e)?""+e:""}(n);var a}function h(e){if((i(e)||"string"==typeof e)&&e>=0&&e<128)return+e;var t=l(e);return t&&void 0!==t.midi?t.midi:null}function m(e,t){var n=h(e);return null===n?null:a(n,t)}function f(e){return(l(e)||{}).letter}function p(e){return(l(e)||{}).acc}function b(e){return(l(e)||{}).pc}function d(e){return(l(e)||{}).step}function g(e){return(l(e)||{}).alt}function y(e){return(l(e)||{}).chroma}function v(e){return(l(e)||{}).oct}},952:e=>{function t(e,t){return function(n,r,i,a){e(n,r,i,a),t(n,r,i,a)}}e.exports=function(e){return e.on=function(n,r){if(1===arguments.length&&"function"==typeof n)return e.on("event",n);var i="on"+n,a=e[i];return e[i]=a?t(a,r):r,e},e}},782:(e,t,n)=>{"use strict";var r=n(722),i=n(952),a=n(28),o=n(490),s=n(751);function u(e,t,n){return s(o(a(i(r(e,t,n)))))}e.exports&&(e.exports=u),"undefined"!=typeof window&&(window.SamplePlayer=u)},751:(e,t,n)=>{var r=n(803);e.exports=function(e){return e.listenToMidi=function(t,n){var i={},a=n||{},o=a.gain||function(e){return e/127};return t.onmidimessage=function(t){var n=t.messageType?t:r(t);if("noteon"===n.messageType&&0===n.velocity&&(n.messageType="noteoff"),!a.channel||n.channel===a.channel)switch(n.messageType){case"noteon":i[n.key]=e.play(n.key,0,{gain:o(n.velocity)});break;case"noteoff":i[n.key]&&(i[n.key].stop(),delete i[n.key])}},e},e}},28:(e,t,n)=>{"use strict";var r=n(161),i=function(e){return function(e){return null!==e&&e!==[]&&e>=0&&e<129}(e)?+e:r.midi(e)};e.exports=function(e){if(e.buffers){var t=e.opts.map,n="function"==typeof t?t:i,r=function(e){return e?n(e)||e:null};e.buffers=function(e,t){return Object.keys(e).reduce((function(n,r){return n[t(r)]=e[r],n}),{})}(e.buffers,r);var a=e.start;e.start=function(e,t,n){var i=r(e),o=i%1;return o&&(i=Math.floor(i),n=Object.assign(n||{},{cents:Math.floor(100*o)})),a(i,t,n)}}return e}},722:(e,t,n)=>{"use strict";var r=n(653),i={},a={gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0};function o(e){return"number"==typeof e}var s=["attack","decay","sustain","release"];e.exports=function(e,t,n){var u=!1,l=0,c={},h=e.createGain();h.gain.value=1;var m=Object.assign({},a,n),f={context:e,out:h,opts:m};return t instanceof AudioBuffer?f.buffer=t:f.buffers=t,f.start=function(t,n,r){if(f.buffer&&null!==t)return f.start(null,t,n);var a=t?f.buffers[t]:f.buffer;if(a){if(u){var o=r||i;n=Math.max(e.currentTime,n||0),f.emit("start",n,t,o);var s=p(t,a,o);return s.id=function(t,n){return n.id=l++,c[n.id]=n,n.source.onended=function(){var t=e.currentTime;n.source.disconnect(),n.env.disconnect(),n.disconnect(),f.emit("ended",t,n.id,n)},n.id}(0,s),s.env.start(n),s.source.start(n),f.emit("started",n,s.id,s),o.duration&&s.stop(n+o.duration),s}console.warn("SamplePlayer not connected to any node.")}else console.warn("Buffer "+t+" not found.")},f.play=function(e,t,n){return f.start(e,t,n)},f.stop=function(e,t){var n;return(t=t||Object.keys(c)).map((function(t){return(n=c[t])?(n.stop(e),n.id):null}))},f.connect=function(e){return u=!0,h.connect(e),f},f.emit=function(e,t,n,r){f.onevent&&f.onevent(e,t,n,r);var i=f["on"+e];i&&i(t,n,r)},f;function p(t,n,i){var a,u=e.createGain();return u.gain.value=0,u.connect(h),u.env=function(e,t,n){var i=r(e),a=t.adsr||n.adsr;return s.forEach((function(e,r){i[e]=a?a[r]:t[e]||n[e]})),i.value.value=o(t.gain)?t.gain:o(n.gain)?n.gain:1,i}(e,i,m),u.env.connect(u.gain),u.source=e.createBufferSource(),u.source.buffer=n,u.source.connect(u),u.source.loop=i.loop||m.loop,u.source.playbackRate.value=(a=i.cents||m.cents)?Math.pow(2,a/1200):1,u.source.loopStart=i.loopStart||m.loopStart,u.source.loopEnd=i.loopEnd||m.loopEnd,u.stop=function(n){var r=n||e.currentTime;f.emit("stop",r,t);var i=u.env.stop(r);u.source.stop(i)},u}}},490:e=>{"use strict";var t=Array.isArray,n={};e.exports=function(e){return e.schedule=function(r,i){var a,o,s,u,l=e.context.currentTime,c=r<l?l:r;return e.emit("schedule",c,i),i.map((function(r){return r?(t(r)?(a=r[0],o=r[1]):(a=r.time,o=r),function(e){return e&&"object"==typeof e}(o)?(s=o.name||o.key||o.note||o.midi||null,u=o):(s=o,u=n),e.start(s,c+(a||0),u)):null}))},e}},161:e=>{"use strict";var t=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/,n=[0,2,4,5,7,9,11];function r(e,r,a){if("string"!=typeof e)return null;var o=t.exec(e);if(!o||!r&&o[4])return null;var s={letter:o[1].toUpperCase(),acc:o[2].replace(/x/g,"##")};return s.pc=s.letter+s.acc,s.step=(s.letter.charCodeAt(0)+3)%7,s.alt="b"===s.acc[0]?-s.acc.length:s.acc.length,s.chroma=n[s.step]+s.alt,o[3]&&(s.oct=+o[3],s.midi=s.chroma+12*(s.oct+1),s.freq=i(s.midi,a)),r&&(s.tonicOf=o[4]),s}function i(e,t){return Math.pow(2,(e-69)/12)*(t||440)}var a={parse:r,regex:function(){return t},midiToFreq:i};["letter","acc","pc","step","alt","chroma","oct","midi","freq"].forEach((function(e){a[e]=function(t){var n=r(t);return n&&void 0!==n[e]?n[e]:null}})),e.exports=a}},t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}return n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(101)})()}));